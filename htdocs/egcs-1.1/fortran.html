<html>
<head>
<title>egcs-1.1 Fortran News</title>
</head>
<body>

<h1 align="center">egcs-1.1 Fortran</h1>
<UL>
<LI><A NAME="TOC1" HREF="fortran.html#SEC1">News</A>
<LI><A NAME="TOC2" HREF="fortran.html#SEC2">Known Bugs</A>
</UL>
<P><HR><P>

<H2><A NAME="SEC1" HREF="fortran.html#TOC1">News</A></H2>
<P>
The changes are generally listed in order:

</P>

<OL>
<LI>

Code-generation and run-time-library bug-fixes

<LI>

Compiler and run-time-library crashes involving valid code
that have been fixed

<LI>

New features

<LI>

Fixes and enhancements to existing features

<LI>

New diagnostics

<LI>

Internal improvements

<LI>

Miscellany
</OL>

<P>
This order is not strict--for example, some items
involve a combination of these elements.

</P>

<H3>In <CODE>egcs</CODE> 1.1.2:</H3>

<UL>
<LI>

Fix the <SAMP>`Date_and_Time'</SAMP> intrinsic (in <CODE>libg2c</CODE>)
to return the milliseconds value properly
in <VAR>Values</VAR>(8).

<LI>

Fix the <SAMP>`LStat'</SAMP> intrinsic (in <CODE>libg2c</CODE>)
to return device-ID information properly
in <VAR>SArray</VAR>(7).

<LI>

Improve documentation.
</UL>


<H3>In <CODE>egcs</CODE> 1.1.1:</H3>

<UL>
<LI>

Fix <CODE>libg2c</CODE> so it performs an implicit <CODE>ENDFILE</CODE> operation
(as appropriate)
whenever a <CODE>REWIND</CODE> is done.

(This bug was introduced in <CODE>egcs</CODE> 1.1 in
<CODE>g77</CODE>'s version of <CODE>libf2c</CODE>.)

<LI>

Fix <CODE>libg2c</CODE> so it no longer crashes with a spurious diagnostic
upon doing any I/O following a direct formatted write.

(This bug was introduced in <CODE>egcs</CODE> 1.1 in
<CODE>g77</CODE>'s version of <CODE>libf2c</CODE>.)

<LI>

Fix <CODE>g77</CODE> so it no longer crashes compiling references
to the <SAMP>`Rand'</SAMP> intrinsic on some systems.

<LI>

Fix <CODE>g77</CODE> portion of installation process so it works
better on some systems
(those with shells requiring <SAMP>`else true'</SAMP> clauses
on <SAMP>`if'</SAMP> constructs
for the completion code to be set properly).
</UL>


<H3>In <CODE>egcs</CODE> 1.1:</H3>

<UL>
<LI>

Fix bugs in the <CODE>libU77</CODE> intrinsic <SAMP>`HostNm'</SAMP>
that wrote one byte beyond the end of its <SAMP>`CHARACTER'</SAMP>
argument,
and in the <CODE>libU77</CODE> intrinsics
<SAMP>`GMTime'</SAMP> and <SAMP>`LTime'</SAMP>
that overwrote their arguments.

<LI>

Assumed arrays with negative bounds
(such as <SAMP>`REAL A(-1:*)'</SAMP>)
no longer elicit spurious diagnostics from <CODE>g77</CODE>,
even on systems with pointers having
different sizes than integers.

This bug is not known to have existed in any
recent version of <CODE>gcc</CODE>.
It was introduced in an early release of <CODE>egcs</CODE>.

<LI>

Valid combinations of <CODE>EXTERNAL</CODE>,
passing that external as a dummy argument
without explicitly giving it a type,
and, in a subsequent program unit,
referencing that external as
an external function with a different type
no longer crash <CODE>g77</CODE>.

<LI>

<CODE>CASE DEFAULT</CODE> no longer crashes <CODE>g77</CODE>.

<LI>

The <SAMP>`-Wunused'</SAMP> option no longer issues a spurious
warning about the "master" procedure generated by
<CODE>g77</CODE> for procedures containing <CODE>ENTRY</CODE> statements.

<LI>

Support <SAMP>`FORMAT(I&#60;<VAR>expr</VAR>&#62;)'</SAMP> when <VAR>expr</VAR> is a
compile-time constant <CODE>INTEGER</CODE> expression.

<LI>

Fix <CODE>g77</CODE> <SAMP>`-g'</SAMP> option so procedures that
use <SAMP>`ENTRY'</SAMP> can be stepped through, line by line,
in <CODE>gdb</CODE>.

<LI>

Allow any <CODE>REAL</CODE> argument to intrinsics
<CODE>Second</CODE> and <CODE>CPU_Time</CODE>.

<LI>

Use <CODE>tempnam</CODE>, if available, to open scratch files
(as in <SAMP>`OPEN(STATUS='SCRATCH')'</SAMP>)
so that the <CODE>TMPDIR</CODE> environment variable,
if present, is used.

<LI>

<CODE>g77</CODE>'s version of <CODE>libf2c</CODE> separates out
the setting of global state
(such as command-line arguments and signal handling)
from <TT>`main.o'</TT> into distinct, new library
archive members.

This should make it easier to write portable applications
that have their own (non-Fortran) <CODE>main()</CODE> routine
properly set up the <CODE>libf2c</CODE> environment, even
when <CODE>libf2c</CODE> (now <CODE>libg2c</CODE>) is a shared library.

<LI>

<CODE>g77</CODE> no longer installs the <TT>`f77'</TT> command
and <TT>`f77.1'</TT> man page
in the <TT>`/usr'</TT> or <TT>`/usr/local'</TT> heirarchy,
even if the <TT>`f77-install-ok'</TT> file exists
in the source or build directory.
See the installation documentation for more information.

<LI>

<CODE>g77</CODE> no longer installs the <TT>`libf2c.a'</TT> library
and <TT>`f2c.h'</TT> include file
in the <TT>`/usr'</TT> or <TT>`/usr/local'</TT> heirarchy,
even if the <TT>`f2c-install-ok'</TT> or <TT>`f2c-exists-ok'</TT> files exist
in the source or build directory.
See the installation documentation for more information.

<LI>

The <TT>`libf2c.a'</TT> library produced by <CODE>g77</CODE> has been
renamed to <TT>`libg2c.a'</TT>.
It is installed only in the <CODE>gcc</CODE> "private"
directory heirarchy, <TT>`gcc-lib'</TT>.
This allows system administrators and users to choose which
version of the <CODE>libf2c</CODE> library from <CODE>netlib</CODE> they
wish to use on a case-by-case basis.
See the installation documentation for more information.

<LI>

The <TT>`f2c.h'</TT> include (header) file produced by <CODE>g77</CODE>
has been renamed to <TT>`g2c.h'</TT>.
It is installed only in the <CODE>gcc</CODE> "private"
directory heirarchy, <TT>`gcc-lib'</TT>.
This allows system administrators and users to choose which
version of the include file from <CODE>netlib</CODE> they
wish to use on a case-by-case basis.
See the installation documentation for more information.

<LI>

The <CODE>g77</CODE> command now expects the run-time library
to be named <CODE>libg2c.a</CODE> instead of <CODE>libf2c.a</CODE>,
to ensure that a version other than the one built and
installed as part of the same <CODE>g77</CODE> version is picked up.

<LI>

During the configuration and build process,
<CODE>g77</CODE> creates subdirectories it needs only as it
needs them.
Other cleaning up of the configuration and build process
has been performed as well.

<LI>

<CODE>install-info</CODE> now used to update the directory of
Info documentation to contain an entry for <CODE>g77</CODE>
(during installation).

<LI>

Some diagnostics have been changed from warnings to errors,
to prevent inadvertent use of the resulting, probably buggy,
programs.
These mostly include diagnostics about use of unsupported features
in the <CODE>OPEN</CODE>, <CODE>INQUIRE</CODE>, <CODE>READ</CODE>, and
<CODE>WRITE</CODE> statements,
and about truncations of various sorts of constants.

<LI>

Improve compilation of <CODE>FORMAT</CODE> expressions so that
a null byte is appended to the last operand if it
is a constant.
This provides a cleaner run-time diagnostic as provided
by <CODE>libf2c</CODE> for statements like <SAMP>`PRINT '(I1', 42'</SAMP>.

<LI>

Improve documentation and indexing.

<LI>

The upgrade to <CODE>libf2c</CODE> as of 1998-06-18
should fix a variety of problems, including
those involving some uses of the <SAMP>`T'</SAMP> format
specifier, and perhaps some build (porting) problems
as well.
</UL>


<H3>In <CODE>egcs</CODE> 1.0.2:</H3>

<UL>
<LI>

Fix <CODE>g77</CODE> crash triggered by <CODE>CASE</CODE> statement with
an omitted lower or upper bound.

<LI>

Fix <CODE>g77</CODE> crash on statements such as
<SAMP>`PRINT *, (REAL(Z(I)),I=1,2)'</SAMP>, where
<SAMP>`Z'</SAMP> is <CODE>DOUBLE COMPLEX</CODE>.

<LI>

Fix <SAMP>`-fPIC'</SAMP> (such as compiling for ELF targets)
on the Intel x86 architecture target
so invalid assembler code is no longer produced.

<LI>

Fix <SAMP>`-fpedantic'</SAMP> to not reject procedure invocations
such as <SAMP>`I=J()'</SAMP> and <SAMP>`CALL FOO()'</SAMP>.

<LI>

Fix <SAMP>`-fugly-comma'</SAMP> to affect invocations of
only external procedures.
Restore rejection of gratuitous trailing omitted
arguments to intrinsics, as in <SAMP>`I=MAX(3,4,,)'</SAMP>.

<LI>

Fix compiler so it accepts <SAMP>`-fgnu-intrinsics-*'</SAMP> and
<SAMP>`-fbadu77-intrinsics-*'</SAMP> options.
</UL>


<H3>In <CODE>egcs</CODE> 1.0.1:</H3>

<UL>
<LI>

Fix run-time crash involving <CODE>NAMELIST</CODE> on 64-bit
machines such as Alphas.
</UL>


<H3>In <CODE>egcs</CODE> 1.0 (versus <CODE>g77</CODE> 0.5.21):</H3>

<UL>
<LI>

Version 1.0 of <CODE>egcs</CODE>
contains several regressions against
version 0.5.21 of <CODE>g77</CODE>,
due to using the
"vanilla" <CODE>gcc</CODE> back end instead of patching
it to fix a few bugs and improve performance in a
few cases.

See <CODE>gcc/f/BUGS</CODE>,
for information on the known bugs in this version,
including the regressions.

Features that have been dropped from this version
of <CODE>g77</CODE> due to their being implemented
via <CODE>g77</CODE>-specific patches to the <CODE>gcc</CODE>
back end in previous releases include:


<UL>
<LI>

Support for the C-language <CODE>restrict</CODE> keyword.

<LI>

Support for the <SAMP>`-W'</SAMP> option warning about
integer division by zero.

<LI>

The Intel x86-specific option <SAMP>`-malign-double'</SAMP>
applying to stack-allocated data
as well as statically-allocate data.
</UL>

Note that the <TT>`gcc/f/gbe/'</TT> subdirectory has been removed
from this distribution as a result of <CODE>g77</CODE>
being fully integrated with
the <CODE>egcs</CODE> variant of the <CODE>gcc</CODE> back end.

<LI>

Fix code generation for iterative <CODE>DO</CODE> loops that
have one or more references to the iteration variable,
or to aliases of it, in their control expressions.
For example, <SAMP>`DO 10 J=2,J'</SAMP> now is compiled correctly.

<LI>

Fix <CODE>DTime</CODE> intrinsic so as not to truncate
results to integer values (on some systems).

<LI>

Remove support for non-<CODE>egcs</CODE> versions of <CODE>gcc</CODE>.

<LI>

Remove support for the <SAMP>`--driver'</SAMP> option,
as <CODE>g77</CODE> now does all the driving,
just like <CODE>gcc</CODE>.

<LI>

Allow any numeric argument to intrinsics
<CODE>Int2</CODE> and <CODE>Int8</CODE>.

<LI>

Improve diagnostic messages from <CODE>libf2c</CODE>
so it is more likely that the printing of the
active format string is limited to the string,
with no trailing garbage being printed.

(Unlike <CODE>f2c</CODE>, <CODE>g77</CODE> did not append
a null byte to its compiled form of every
format string specified via a <CODE>FORMAT</CODE> statement.
However, <CODE>f2c</CODE> would exhibit the problem
anyway for a statement like <SAMP>`PRINT '(I)garbage', 1'</SAMP>
by printing <SAMP>`(I)garbage'</SAMP> as the format string.)

<LI>

Upgrade to <CODE>libf2c</CODE> as of 1997-09-23.
This fixes a formatted-I/O bug that afflicted
64-bit systems with 32-bit integers
(such as Digital Alpha running GNU/Linux).
</UL>


<H3>In 0.5.21:</H3>

<UL>
<LI>

Fix a code-generation bug introduced by 0.5.20
caused by loop unrolling (by specifying
<SAMP>`-funroll-loops'</SAMP> or similar).
This bug afflicted all code compiled by
version 2.7.2.2.f.2 of <CODE>gcc</CODE> (C, C++,
Fortran, and so on).

<LI>

Fix a code-generation bug manifested when
combining local <CODE>EQUIVALENCE</CODE> with a
<CODE>DATA</CODE> statement that follows
the first executable statement (or is
treated as an executable-context statement
as a result of using the <SAMP>`-fpedantic'</SAMP>
option).

<LI>

Fix a compiler crash that occured when an
integer division by a constant zero is detected.
Instead, when the <SAMP>`-W'</SAMP> option is specified,
the <CODE>gcc</CODE> back end issues a warning about such a case.
This bug afflicted all code compiled by
version 2.7.2.2.f.2 of <CODE>gcc</CODE> (C, C++,
Fortran, and so on).

<LI>

Fix a compiler crash that occurred in some cases
of procedure inlining.
(Such cases became more frequent in 0.5.20.)

<LI>

Fix a compiler crash resulting from using <CODE>DATA</CODE>
or similar to initialize a <CODE>COMPLEX</CODE> variable or
array to zero.

<LI>

Fix compiler crashes involving use of <CODE>AND</CODE>, <CODE>OR</CODE>,
or <CODE>XOR</CODE> intrinsics.

<LI>

Fix compiler bug triggered when using a <CODE>COMMON</CODE>
or <CODE>EQUIVALENCE</CODE> variable
as the target of an <CODE>ASSIGN</CODE>
or assigned-<CODE>GOTO</CODE> statement.

<LI>

Fix compiler crashes due to using the name of a some
non-standard intrinsics (such as <SAMP>`FTELL'</SAMP> or
<SAMP>`FPUTC'</SAMP>) as such and as the name of a procedure
or common block.
Such dual use of a name in a program is allowed by
the standard.

<LI>

Place automatic arrays on the stack, even if
<CODE>SAVE</CODE> or the <SAMP>`-fno-automatic'</SAMP> option
is in effect.
This avoids a compiler crash in some cases.

<LI>

The <SAMP>`-malign-double'</SAMP> option now reliably aligns
<CODE>DOUBLE PRECISION</CODE> optimally on Pentium and
Pentium Pro architectures (586 and 686 in <CODE>gcc</CODE>).

<LI>

New option <SAMP>`-Wno-globals'</SAMP> disables warnings
about "suspicious" use of a name both as a global
name and as the implicit name of an intrinsic, and
warnings about disagreements over the number or natures of
arguments passed to global procedures, or the
natures of the procedures themselves.

The default is to issue such warnings, which are
new as of this version of <CODE>g77</CODE>.

<LI>

New option <SAMP>`-fno-globals'</SAMP> disables diagnostics
about potentially fatal disagreements
analysis problems, such as disagreements over the
number or natures of arguments passed to global
procedures, or the natures of those procedures themselves.

The default is to issue such diagnostics and flag
the compilation as unsuccessful.
With this option, the diagnostics are issued as
warnings, or, if <SAMP>`-Wno-globals'</SAMP> is specified,
are not issued at all.

This option also disables inlining of global procedures,
to avoid compiler crashes resulting from coding errors
that these diagnostics normally would identify.

<LI>

Diagnose cases where a reference to a procedure
disagrees with the type of that procedure, or
where disagreements about the number or nature
of arguments exist.
This avoids a compiler crash.

<LI>

Fix parsing bug whereby <CODE>g77</CODE> rejected a
second initialization specification immediately
following the first's closing <SAMP>`/'</SAMP> without
an intervening comma in a <CODE>DATA</CODE> statement,
and the second specification was an implied-DO list.

<LI>

Improve performance of the <CODE>gcc</CODE> back end so
certain complicated expressions involving <CODE>COMPLEX</CODE>
arithmetic (especially multiplication) don't appear to
take forever to compile.

<LI>

Fix a couple of profiling-related bugs in <CODE>gcc</CODE>
back end.

<LI>

Integrate GNU Ada's (GNAT's) changes to the back end,
which consist almost entirely of bug fixes.
These fixes are circa version 3.10p of GNAT.

<LI>

Include some other <CODE>gcc</CODE> fixes that seem useful in
<CODE>g77</CODE>'s version of <CODE>gcc</CODE>.
(See <TT>`gcc/ChangeLog'</TT> for details--compare it
to that file in the vanilla <CODE>gcc-2.7.2.3.tar.gz</CODE>
distribution.)

<LI>

Fix <CODE>libU77</CODE> routines that accept file and other names
to strip trailing blanks from them, for consistency
with other implementations.
Blanks may be forcibly appended to such names by
appending a single null character (<SAMP>`CHAR(0)'</SAMP>)
to the significant trailing blanks.

<LI>

Fix <CODE>CHMOD</CODE> intrinsic to work with file names
that have embedded blanks, commas, and so on.

<LI>

Fix <CODE>SIGNAL</CODE> intrinsic so it accepts an
optional third <SAMP>`Status'</SAMP> argument.

<LI>

Fix <CODE>IDATE()</CODE> intrinsic subroutine (VXT form)
so it accepts arguments in the correct order.
Documentation fixed accordingly, and for
<CODE>GMTIME()</CODE> and <CODE>LTIME()</CODE> as well.

<LI>

Make many changes to <CODE>libU77</CODE> intrinsics to
support existing code more directly.

Such changes include allowing both subroutine and
function forms of many routines, changing <CODE>MCLOCK()</CODE>
and <CODE>TIME()</CODE> to return <CODE>INTEGER(KIND=1)</CODE> values,
introducing <CODE>MCLOCK8()</CODE> and <CODE>TIME8()</CODE> to
return <CODE>INTEGER(KIND=2)</CODE> values,
and placing functions that are intended to perform
side effects in a new intrinsic group, <CODE>badu77</CODE>.

<LI>

Improve <CODE>libU77</CODE> so it is more portable.

<LI>

Add options <SAMP>`-fbadu77-intrinsics-delete'</SAMP>,
<SAMP>`-fbadu77-intrinsics-hide'</SAMP>, and so on.

<LI>

Fix crashes involving diagnosed or invalid code.

<LI>

<CODE>g77</CODE> and <CODE>gcc</CODE> now do a somewhat better
job detecting and diagnosing arrays that are too
large to handle before these cause diagnostics
during the assembler or linker phase, a compiler
crash, or generation of incorrect code.

<LI>

Make some fixes to alias analysis code.

<LI>

Add support for <CODE>restrict</CODE> keyword in <CODE>gcc</CODE>
front end.

<LI>

Support <CODE>gcc</CODE> version 2.7.2.3
(modified by <CODE>g77</CODE> into version 2.7.2.3.f.1),
and remove
support for prior versions of <CODE>gcc</CODE>.

<LI>

Incorporate GNAT's patches to the <CODE>gcc</CODE> back
end into <CODE>g77</CODE>'s, so GNAT users do not need
to apply GNAT's patches to build both GNAT and <CODE>g77</CODE>
from the same source tree.

<LI>

Modify <CODE>make</CODE> rules and related code so that
generation of Info documentation doesn't require
compilation using <CODE>gcc</CODE>.
Now, any ANSI C compiler should be adequate to
produce the <CODE>g77</CODE> documentation (in particular,
the tables of intrinsics) from scratch.

<LI>

Add <CODE>INT2</CODE> and <CODE>INT8</CODE> intrinsics.

<LI>

Add <CODE>CPU_TIME</CODE> intrinsic.

<LI>

Add <CODE>ALARM</CODE> intrinsic.

<LI>

<CODE>CTIME</CODE> intrinsic now accepts any <CODE>INTEGER</CODE>
argument, not just <CODE>INTEGER(KIND=2)</CODE>.

<LI>

Warn when explicit type declaration disagrees with
the type of an intrinsic invocation.

<LI>

Support <SAMP>`*f771'</SAMP> entry in <CODE>gcc</CODE> <TT>`specs'</TT> file.

<LI>

Fix typo in <CODE>make</CODE> rule <SAMP>`g77-cross'</SAMP>, used only for
cross-compiling.

<LI>

Fix <CODE>libf2c</CODE> build procedure to re-archive library
if previous attempt to archive was interrupted.

<LI>

Change <CODE>gcc</CODE> to unroll loops only during the last
invocation (of as many as two invocations) of loop
optimization.

<LI>

Improve handling of <SAMP>`-fno-f2c'</SAMP> so that code that
attempts to pass an intrinsic as an actual argument,
such as <SAMP>`CALL FOO(ABS)'</SAMP>, is rejected due to the fact
that the run-time-library routine is, effectively,
compiled with <SAMP>`-ff2c'</SAMP> in effect.

<LI>

Fix <CODE>g77</CODE> driver to recognize <SAMP>`-fsyntax-only'</SAMP>
as an option that inhibits linking, just like <SAMP>`-c'</SAMP> or
<SAMP>`-S'</SAMP>, and to recognize and properly handle the
<SAMP>`-nostdlib'</SAMP>, <SAMP>`-M'</SAMP>, <SAMP>`-MM'</SAMP>, <SAMP>`-nodefaultlibs'</SAMP>,
and <SAMP>`-Xlinker'</SAMP> options.

<LI>

Upgrade to <CODE>libf2c</CODE> as of 1997-08-16.

<LI>

Modify <CODE>libf2c</CODE> to consistently and clearly diagnose
recursive I/O (at run time).

<LI>

<CODE>g77</CODE> driver now prints version information (such as produced
by <KBD>g77 -v</KBD>) to <CODE>stderr</CODE> instead of <CODE>stdout</CODE>.

<LI>

The <SAMP>`.r'</SAMP> suffix now designates a Ratfor source file,
to be preprocessed via the <CODE>ratfor</CODE> command, available
separately.

<LI>

Fix some aspects of how <CODE>gcc</CODE> determines what kind of
system is being configured and what kinds are supported.
For example, GNU Linux/Alpha ELF systems now are directly
supported.

<LI>

Improve diagnostics.

<LI>

Improve documentation and indexing.

<LI>

Include all pertinent files for <CODE>libf2c</CODE> that come
from <CODE>netlib.bell-labs.com</CODE>; give any such files
that aren't quite accurate in <CODE>g77</CODE>'s version of
<CODE>libf2c</CODE> the suffix <SAMP>`.netlib'</SAMP>.

<LI>

Reserve <CODE>INTEGER(KIND=0)</CODE> for future use.
</UL>

<H2><A NAME="SEC2" HREF="fortran.html#TOC2">Known Bugs</A></H2>

<P>
This section identifies bugs that <CODE>g77</CODE> <EM>users</EM>
might run into.
This includes bugs that are actually in the <CODE>gcc</CODE>
back end (GBE) or in <CODE>libf2c</CODE>, because those
sets of code are at least somewhat under the control
of (and necessarily intertwined with) <CODE>g77</CODE>, so it
isn't worth separating them out.

</P>
<P>
For information on bugs that might afflict people who
configure, port, build, and install <CODE>g77</CODE>,
see the installation documentation.

</P>

<UL>
<LI>

<CODE>g77</CODE> crashes when compiling
I/O statements using keywords that define <CODE>INTEGER</CODE> values,
such as <SAMP>`IOSTAT=<VAR>j</VAR>'</SAMP>,
where <VAR>j</VAR> is other than default <CODE>INTEGER</CODE>
(such as <CODE>INTEGER*2</CODE>).

Fixed in <CODE>egcs</CODE> 1.2.

<LI>

<CODE>g77</CODE> fails to warn about a reference to a function
when the corresponding <EM>subsequent</EM> function program unit
disagrees with the reference concerning the type of the function.

Fixed in <CODE>egcs</CODE> 1.2.

<LI>

Automatic arrays aren't working on HP-UX systems,
at least in HP-UX version 10.20.
Writing into them apparently causes over-writing
of statically declared data in the main program.
This probably means the arrays themselves are being under-allocated,
or pointers to them being improperly handled,
e.g. not passed to other procedures as they should be.

<LI>

<CODE>g77</CODE> fails to warn about
use of a "live" iterative-DO variable
as an implied-DO variable
in a <SAMP>`WRITE'</SAMP> or <SAMP>`PRINT'</SAMP> statement
(although it does warn about this in a <SAMP>`READ'</SAMP> statement).

<LI>

Something about <CODE>g77</CODE>'s straightforward handling of
label references and definitions sometimes prevents the GBE
from unrolling loops.
Until this is solved, try inserting or removing <CODE>CONTINUE</CODE>
statements as the terminal statement, using the <CODE>END DO</CODE>
form instead, and so on.

<LI>

Some confusion in diagnostics concerning failing <CODE>INCLUDE</CODE>
statements from within <CODE>INCLUDE</CODE>'d or <CODE>#include</CODE>'d files.

<LI>

<CODE>g77</CODE> assumes that <CODE>INTEGER(KIND=1)</CODE> constants range
from <SAMP>`-2**31'</SAMP> to <SAMP>`2**31-1'</SAMP> (the range for
two's-complement 32-bit values),
instead of determining their range from the actual range of the
type for the configuration (and, someday, for the constant).

Further, it generally doesn't implement the handling
of constants very well in that it makes assumptions about the
configuration that it no longer makes regarding variables (types).

Included with this item is the fact that <CODE>g77</CODE> doesn't recognize
that, on IEEE-754/854-compliant systems, <SAMP>`0./0.'</SAMP> should produce a NaN
and no warning instead of the value <SAMP>`0.'</SAMP> and a warning.
This is to be fixed in version 0.6, when <CODE>g77</CODE> will use the
<CODE>gcc</CODE> back end's constant-handling mechanisms to replace its own.

<LI>

<CODE>g77</CODE> uses way too much memory and CPU time to process large aggregate
areas having any initialized elements.

For example, <SAMP>`REAL A(1000000)'</SAMP> followed by <SAMP>`DATA A(1)/1/'</SAMP>
takes up way too much time and space, including
the size of the generated assembler file.
This is to be mitigated somewhat in version 0.6.

Version 0.5.18 improves cases like this--specifically,
cases of <EM>sparse</EM> initialization that leave large, contiguous
areas uninitialized--significantly.
However, even with the improvements, these cases still
require too much memory and CPU time.

(Version 0.5.18 also improves cases where the initial values are
zero to a much greater degree, so if the above example
ends with <SAMP>`DATA A(1)/0/'</SAMP>, the compile-time performance
will be about as good as it will ever get, aside from unrelated
improvements to the compiler.)

Note that <CODE>g77</CODE> does display a warning message to
notify the user before the compiler appears to hang.
See the installation documentation
for information on how to change the point at which
<CODE>g77</CODE> decides to issue this warning.

<LI>

<CODE>g77</CODE> doesn't emit variable and array members of common blocks for use
with a debugger (the <SAMP>`-g'</SAMP> command-line option).
The code is present to do this, but doesn't work with at least
one debug format--perhaps it works with others.
And it turns out there's a similar bug for
local equivalence areas, so that has been disabled as well.

As of Version 0.5.19, a temporary kludge solution is provided whereby
some rudimentary information on a member is written as a string that
is the member's value as a character string.

See the documentation
for information on the <SAMP>`-fdebug-kludge'</SAMP> option.

<LI>

When debugging, after starting up the debugger but before being able
to see the source code for the main program unit, the user must currently
set a breakpoint at <SAMP>`MAIN__'</SAMP> (or <SAMP>`MAIN___'</SAMP> or <SAMP>`MAIN_'</SAMP> if
<SAMP>`MAIN__'</SAMP> doesn't exist)
and run the program until it hits the breakpoint.
At that point, the
main program unit is activated and about to execute its first
executable statement, but that's the state in which the debugger should
start up, as is the case for languages like C.

<LI>

Debugging <CODE>g77</CODE>-compiled code using debuggers other than
<CODE>gdb</CODE> is likely not to work.

Getting <CODE>g77</CODE> and <CODE>gdb</CODE> to work together is a known
problem--getting <CODE>g77</CODE> to work properly with other
debuggers, for which source code often is unavailable to <CODE>g77</CODE>
developers, seems like a much larger, unknown problem,
and is a lower priority than making <CODE>g77</CODE> and <CODE>gdb</CODE>
work together properly.

On the other hand, information about problems other debuggers
have with <CODE>g77</CODE> output might make it easier to properly
fix <CODE>g77</CODE>, and perhaps even improve <CODE>gdb</CODE>, so it
is definitely welcome.
Such information might even lead to all relevant products
working together properly sooner.

<LI>

<CODE>g77</CODE> doesn't work perfectly on 64-bit configurations
such as the Digital Semiconductor ("DEC") Alpha.

This problem is largely resolved as of version 0.5.23.
Version 0.6 should solve most or all remaining problems
(such as cross-compiling involving 64-bit machines).

<LI>

Maintainers of gcc report that the back end definitely has "broken"
support for <CODE>COMPLEX</CODE> types.
Based on their input, it seems many of
the problems affect only the more-general facilities for gcc's
<CODE>__complex__</CODE> type, such as <CODE>__complex__ int</CODE>
(where the real and imaginary parts are integers) that GNU
Fortran does not use.

Version 0.5.20 of <CODE>g77</CODE> works around this
problem by not using the back end's support for <CODE>COMPLEX</CODE>.
The new option <SAMP>`-fno-emulate-complex'</SAMP> avoids the work-around,
reverting to using the same "broken" mechanism as that used
by versions of <CODE>g77</CODE> prior to 0.5.20.

<LI>

<CODE>g77</CODE> sometimes produces invalid assembler code
when using the <SAMP>`-fPIC'</SAMP> option (such as compiling for ELF targets)
on the Intel x86 architecture target.
The symptom is that the assembler complains about invalid opcodes.
This bug is in the gcc back end.

Fixed in <CODE>egcs</CODE> version 1.0.2.

<LI>

<CODE>g77</CODE> currently inserts needless padding for things like
<SAMP>`COMMON A,IPAD'</SAMP> where <SAMP>`A'</SAMP> is <CODE>CHARACTER*1</CODE> and <SAMP>`IPAD'</SAMP>
is <CODE>INTEGER(KIND=1)</CODE> on machines like x86,
because the back end insists that <SAMP>`IPAD'</SAMP>
be aligned to a 4-byte boundary,
but the processor has no such requirement
(though it is usually good for performance).

The <CODE>gcc</CODE> back end needs to provide a wider array
of specifications of alignment requirements and preferences for targets,
and front ends like <CODE>g77</CODE> should take advantage of this
when it becomes available.

<LI>

The x86 target's <SAMP>`-malign-double'</SAMP> option
no longer reliably aligns double-precision variables and arrays
when they are placed in the stack frame.

This can significantly reduce the performance of some applications,
even on a run-to-run basis
(that is, performance measurements can vary fairly widely
depending on whether frequently used variables are properly aligned,
and that can change from one program run to the next,
even from one procedure call to the next).

Versions 0.5.22 and earlier of <CODE>g77</CODE>
included a patch to <CODE>gcc</CODE> that enabled this,
but that patch has been deemed an improper (probably buggy) one
for version 2.8 of <CODE>gcc</CODE> and for <CODE>egcs</CODE>.

Note that version 1.1 of <CODE>egcs</CODE>
aligns double-precision variables and arrays
when they are in static storage
even if <SAMP>`-malign-double'</SAMP> is not specified.

There is ongoing investigation into
how to make <SAMP>`-malign-double'</SAMP> work properly,
also into how to make it unnecessary to get
all double-precision variables and arrays aligned
when such alignment would not violate
the relevant specifications for processor
and inter-procedural interfaces.

For a suite of programs to test double-precision alignment,
see <A HREF="ftp://alpha.gnu.org/gnu/g77/align/"><TT>ftp://alpha.gnu.org/gnu/g77/align/</TT></A>.

<LI>

The <CODE>libf2c</CODE> routines that perform some run-time
arithmetic on <CODE>COMPLEX</CODE> operands
were modified circa version 0.5.20 of <CODE>g77</CODE>
to work properly even in the presence of aliased operands.

While the <CODE>g77</CODE> and <CODE>netlib</CODE> versions of <CODE>libf2c</CODE>
differ on how this is accomplished,
the main differences are that we believe
the <CODE>g77</CODE> version works properly
even in the presence of <EM>partially</EM> aliased operands.

However, these modifications have reduced performance
on targets such as x86,
due to the extra copies of operands involved.
</UL>

<p><a href="../index.html">Return to the egcs home page</a>
<p><i>Last modified:  February 26, 1999</i>

<P><HR><P>
This document was generated on 26 February 1999 using the
<A HREF="http://wwwcn.cern.ch/dci/texi2html/">texi2html</A>
translator version 1.51a.
It was then edited by hand by Craig Burley,
to merge in the known-bugs information,
to fix typos (such as in the date in this paragraph),
and to remove various sorts of cruft.
</P>

</body>
</html>
