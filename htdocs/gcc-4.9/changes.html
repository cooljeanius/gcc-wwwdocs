<html>

<head>
<title>GCC 4.9 Release Series &mdash; Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 4.9 Release Series<br />Changes, New Features, and Fixes</h1>


<h2>Caveats</h2>

  <ul>
    <li><p>Support for a number of older systems and recently
    unmaintained or untested target ports of GCC has been declared
    obsolete in GCC 4.9.  Unless there is activity to revive them, the
    next release of GCC will have their sources permanently
    <strong>removed</strong>.</p>

    <p>The following ports for individual systems on
    particular architectures have been obsoleted:</p>

    <ul>
	  <li>Solaris 9 (*-*-solaris2.9).  Details can be found in the
	  <a href="http://gcc.gnu.org/ml/gcc-patches/2013-05/msg00728.html">
	      announcement</a>.</li>
    </ul>
    </li>
  </ul>

<h2>General Optimizer Improvements</h2>

  <ul>
    <li>AddressSanitizer, a fast memory error detector, is now available on ARM.
    </li>
  </ul>

<h2>New Languages and Language specific improvements</h2>

<h3 id="ada">Ada</h3>

  <ul>
    <li>GNAT switched to Ada 2012 instead of Ada 2005 by default.</li>
  </ul>

<h3 id="c-family">C family</h3>

  <ul>
    <li>Support for colorizing diagnostics emitted by GCC has been added.
    The <code><a
    href="http://gcc.gnu.org/onlinedocs/gcc/Language-Independent-Options.html#index-fdiagnostics_002dcolor-239"
    >-fdiagnostics-color=auto</a></code> will enable it when
    outputting to terminals, <code>-fdiagnostics-color=always</code>
    unconditionally.  The <code>GCC_COLORS</code> environment variable
    can be used to customize the colors or disable coloring.
    If <code>GCC_COLORS</code> variable is present in the environment,
    the default is <code>-fdiagnostics-color=auto</code>, otherwise
    <code>-fdiagnostics-color=never</code>.<br/>
    Sample diagnostics output:<br/>
    <pre>
    $ g++ -fdiagnostics-color=always -S -Wall test.C
    <b>test.C:</b> In function &lsquo;<b>int foo()</b>&rsquo;:
    <b>test.C:1:14:</b> <b style='color:magenta'>warning:</b> no return statement in function returning non-void [-Wreturn-type]
     int foo () { }
                  <b style='color:lime'>^</b>
    <b>test.C:2:46:</b> <b style='color:red'>error:</b> template instantiation depth exceeds maximum of 900 (use -ftemplate-depth= to increase the maximum) instantiating &lsquo;<b>struct X&lt;100&gt;</b>&rsquo;
     template &lt;int N&gt; struct X { static const int value = X&lt;N-1&gt;::value; }; template struct X&lt;1000&gt;;
                                                  <b style='color:lime'>^</b>
    <b>test.C:2:46:</b>   recursively required from &lsquo;<b>const int X&lt;999&gt;::value</b>&rsquo;
    <b>test.C:2:46:</b>   required from &lsquo;<b>const int X&lt;1000&gt;::value</b>&rsquo;
    <b>test.C:2:88:</b>   required from here

    <b>test.C:2:46:</b> <b style='color:red'>error:</b> incomplete type &lsquo;<b>X&lt;100&gt;</b>&rsquo; used in nested name specifier
    </pre></li>
  </ul>           

<!--
<h3>C</h3>
-->


<h3 id="cxx">C++</h3>
<ul>
  <li>
    The G++ implementation of <a href="../projects/cxx1y.html">C++1y</a> return type deduction for normal
    functions has been updated to conform to
    <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3638.html">N3638</a>, 
    the proposal accepted into the working paper.  Most notably, it adds <tt>decltype(auto)</tt> for
    getting <tt>decltype</tt> semantics rather than the template argument deduction semantics of plain <tt>auto</tt>:
<blockquote><pre>
int&amp; f();
         auto  i1 = f(); // int
decltype(auto) i2 = f(); // int&amp;
</pre></blockquote>
  </li>
  <li>
    G++ supports <a href="../projects/cxx1y.html">C++1y</a> lambda capture initializers:
<blockquote><pre>
[x = 42]{ ... };
</pre></blockquote>
Actually, they have been accepted since GCC 4.5, but now the compiler doesn't
warn about them with <tt>-std=c++1y</tt>, and supports parenthesized and
brace-enclosed initializers as well.
  </li>
  <li>
    G++ supports <a href="../projects/cxx1y.html">C++1y</a> variable length
    arrays.  G++ has supported GNU/C99-style VLAs for a long time, but now
    additionally supports initializers and lambda capture by reference.  In
    C++1y mode G++ will complain about VLA uses that are not permitted by
    the draft standard, such as forming a pointer to VLA type or
    applying <tt>sizeof</tt> to a VLA variable.
<blockquote><pre>
void f(int n) {
  int a[n] = { 1, 2, 3 }; // throws std::bad_array_length if n &lt; 3
  [&amp;a]{ for (int i : a) { cout &lt;&lt; i &lt;&lt; endl; } }();
  &amp;a; // error, taking address of VLA
}
</pre></blockquote>
  </li>
</ul>

  <h4>Runtime Library (libstdc++)</h4>

  <ul>
    <li>The non-standard function <code>std::copy_exception</code> has been deprecated
        and will be removed in a future version. <code>std::make_exception_ptr</code>
        should be used instead.
    </li>
  </ul>

<h3 id="fortran">Fortran</h3>
  <ul>
    <li>Compatibility notice:
    <ul>
      <li>Module files: The version of the module files (<code>.mod</code>)
        has been incremented; additionally, module files are now compressed.
        Fortran <code>MODULE</code>s compiled by earlier GCC versions have
        to be recompiled, when they are <code>USE</code>d by files compiled
        with GCC 4.9, because GCC 4.9 is not able to read <code>.mod</code>
        files of earlier GCC versions; attempting to do so gives an error
        message. Note: The ABI of the produced assembler data itself has not
        changed: object files and libraries are fully compatible to older
        versions. (Except for the next items.)</li>
      <li>ABI changes:
      <ul>
        <li>Note that the <a
          href="http://gcc.gnu.org/onlinedocs/gfortran/Argument-passing-conventions.html"
          >argument passing ABI</a> has changed for scalar dummy
  	  arguments of type <code>INTEGER</code>, <code>REAL</code>,
	  <code>COMPLEX</code> and <code>LOGICAL</code>, which have
	  <em>both</em> the <code>VALUE</code> and the <code>OPTIONAL</code>
	  attribute.</li>
        <li>Due to the support of finalization, the virtual table associated
          with polymorphic variables has changed. Therefore, code containing
          <code>CLASS</code> should be recompiled, including all files which
          define derived types involved in the type definition used by
          polymorphic variables. (Note: Due to the incremented module version,
          trying to mix old code with new code will usually give an error
          message.)</li>
      </ul></li>
    </ul></li>
    <li>The deprecated command-line option <code>-fno-whole-file</code>
      has been removed. (<code>-fwhole-file</code> is the default since
      GCC 4.6.) <code>-fwhole-file</code>/<code>-fno-whole-file</code>
      continue to be accepted but do not influence the code generation.</li>
    <li>The compiler no longer unconditionally warns
      about <code>DO</code>loops with zero iterations.  This warning is now
      controlled by the <code>-Wzerotrips</code> option, which is implied by
      <code>-Wall</code>.</li>
    <li>The new <code>NO_ARG_CHECK</code> attribute of the <a
      href="http://gcc.gnu.org/onlinedocs/gfortran/GNU-Fortran-Compiler-Directives.html"
      ><code>!GCC$</code> directive</a> can be used to disable the
      type-kind-rank (TKR) argument check for a dummy argument. The feature
      is similar to ISO/IEC TS 29133:2012's <code>TYPE(*)</code>, except that
      it additionally also disables the rank check. Variables with
      <code>NO_ARG_CHECK</code> have to be dummy arguments and may only be
      used as argument to <code>ISO_C_BINDING</code>'s <code>C_LOC</code>
      and as actual argument to another <code>NO_ARG_CHECK</code> dummy
      argument; also the other constraints of <code>TYPE(*)</code> apply.
      The dummy arguments should be declared as scalar or assumed-size
      variable of type <code>type(*)</code> (recommended) &ndash; or of
      type <code>integer</code>, <code>real</code>, <code>complex</code>
      or <code>logical</code>. With <code>NO_ARG_CHECK</code>, a pointer
      to the data without further type or shape information is passed,
      similar to C's <code>void*</code>. Note that also TS 29113's
      <code>type(*),dimension(..)</code> accepts arguments of any type and
      rank; contrary to <code>NO_ARG_CHECK</code> assumed-rank arguments
      pass an array descriptor which contains the array shape and stride
      of the argument.</li>
    <li><a href="http://gcc.gnu.org/wiki/Fortran2003Status">Fortran 2003</a>:
    <ul>
      <li>Finalization is now supported. Note that finalization is currently
        only done for a subset of the situations in which it should occur.</li>
    </ul></li>
    <li><a href="http://gcc.gnu.org/wiki/Fortran2008Status">Fortran 2008</a>:
    <ul>
      <li>When <code>STOP</code> or <code>ERROR STOP</code> is used to terminate
        the execution and any exception (but inexact) is signaling, a warning is
        printed to <code>ERROR_UNIT</code>, indicating which exceptions are
        signaling. The <code><a
        href="http://gcc.gnu.org/onlinedocs/gfortran/Debugging-Options.html"
        >-ffpe-summary=</a></code> command-line option can be used to fine-tune
        for which exception the warning should be shown.</li>
    </ul></li>
  </ul>

<!--
<h3>Java (GCJ)</h3>
-->

<h2 id="targets">New Targets and Target Specific Improvements</h2>

<h3 id="x86">IA-32/x86-64</h3>
  <ul>
    <li> It is now possible to call x86 intrinsics from select functions in
      a file that are tagged with the corresponding target attribute without
      having to compile the entire file with the <code>-mxxx</code> option.
      This improves the usability of x86 intrinsics and is particularly useful
      when doing <a
      href="http://gcc.gnu.org/onlinedocs/gcc/Function-Multiversioning.html"
      >Function Multiversioning</a>.
    </li>
    <li> GCC now supports the new Intel microarchitecture named Silvermont
      through <code>-march=slm</code>.
    </li>
  </ul>
<h3 id="rx">RX</h3>
  <ul>
    <li> The port now allows to specify the RX100, RX200, and RX600 processors
      with the command line options -mcpu=rx100, -mcpu=rx200 and -mcpu=rx600.
    </li>
  </ul>

<!--
<h2>Documentation improvements</h2>
-->


<!--
<h2>Other significant improvements</h2>

-->

</body>
</html>
