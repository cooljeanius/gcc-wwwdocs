<!DOCTYPE html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>GCC 12 Release Series &mdash; Changes, New Features, and Fixes</title>
<link rel="stylesheet" type="text/css" href="https://gcc.gnu.org/gcc.css" />
</head>

<!-- GCC maintainers, please do not hesitate to contribute/update
     entries concerning those part of GCC you maintain!
-->

<body>
<h1>GCC 12 Release Series<br/>Changes, New Features, and Fixes</h1>

<p>
This page is a "brief" summary of some of the huge number of improvements
in GCC 12.
You may also want to check out our
<a href="porting_to.html">Porting to GCC 12</a> page and the
<a href="../onlinedocs/index.html#current">full GCC documentation</a>.
</p>

<p>Note: GCC 12 has not been released yet, so this document is
a work-in-progress.</p>

<!-- .................................................................. -->
<h2>Caveats</h2>
<ul>
  <li>
    <strong>C:</strong>
    Computed gotos require a pointer type now.
  </li>
  <li>
    <strong>C++:</strong>
    Two non-standard <code>std::pair</code> constructors have been deprecated.
    These allowed the use of an rvalue and a literal <code>0</code> to
    construct a pair containing a move-only type and a pointer.
    The <code>nullptr</code> keyword should be used to initialize the pointer
    member instead of a literal <code>0</code>, as this is portable to other
    C++ implementations.
  </li>
  <li>
    <strong>Fortran:</strong>
    OpenMP code using the <code>omp_lib.h</code> include file can no longer be
    compiled with <code>-std=f95</code> but now requires at least
    <code>-std=f2003</code>. Alternatively, use the <code>omp_lib</code> module,
    which still supports <code>-std=f95</code> and is recommended to be used
    instead in general.
  </li>
  <li>
    OpenMP offloading to Intel MIC has been deprecated and will be removed
    in a future release.
  </li>
  <li>
    The <code>cr16</code> target with the <code>cr16-*-*</code> configuration
    has been obsoleted and will be removed in a future release.
  </li>
  <li>
    The <code>hppa[12]*-*-hpux10*</code> and <code>hppa[12]*-*-hpux11*</code>
    configurations targeting 32-bit PA-RISC with HP-UX have been obsoleted and
    will be removed in a future release.
  <li>
    The support for the <code>m32r-*-linux*</code>, <code>m32rle-*-linux*</code>,
    <code>m68k*-*-openbsd*</code> and <code>vax-*-openbsd*</code> configurations
    has been removed.
  </li>
  <li>
    <strong>STABS:</strong>
    Support for emitting the STABS debugging format is deprecated and will
    be removed in the next release.  All ports now default to emit DWARF
    (version 2 or later) debugging info or are obsoleted.
  </li>
  <li>The optimization level <code>-Ofast</code> now implies
    <code>-fno-semantic-interposition</code>.
  </li>
</ul>


<!-- .................................................................. -->
<h2 id="general">General Improvements</h2>

<ul>
  <li>Vectorization is enabled at <code>-O2</code> which is now equivalent to the
      original <code>-O2 -ftree-vectorize -fvect-cost-model=very-cheap</code>.
      Note that default vectorizer cost model has been changed which used to behave
      as <code>-fvect-cost-model=cheap</code> were specified.
  </li>
</ul>

<!-- .................................................................. -->
<h2 id="languages">New Languages and Language specific improvements</h2>

<ul>
  <li>OpenMP
  <ul>
    <li>OpenMP 5.0 support has been extended: The <code>close</code> map
      modifier and the <code>affinity</code> clause are now supported.
      In addition Fortran gained additionally the following features which were
      available in C and C++ before: <code>declare variant</code> is now
      available, <code>depobj</code>, <code>mutexinoutset</code> and
      <code>iterator</code> can now also be used with the <code>depend</code>
      clause, <code>defaultmap</code> has been updated for OpenMP 5.0, and the
      <code>loop</code> directive and combined directives involving the
      <code>master</code> directive have been added.</li>
    <li>The following OpenMP 5.1 features have been added: support for
      expressing OpenMP directives as C++ 11 attributes, the <code>masked</code>
      and <code>scope</code> construct, the <code>nothing</code> and
      <code>error</code> directives, and using <code>primary</code> with the
      <code>proc_bind</code> clause and <code>OMP_PROC_BIND</code> environment
      variable, the <code>reproducible</code> and <code>unconstrained</code>
      modifiers to the <code>order</code> clause, and, for C/C++ only, the
      <code>align</code> and <code>allocate</code> modifiers to the
      <code>allocate</code> clause and the <code>atomic</code> extensions are
      now available. The <code>OMP_PLACE</code> environment variable supports
      the OpenMP 5.1 features. In addition the <code>OMP_NUM_TEAMS</code> and
      <code>OMP_TEAMS_THREAD_LIMIT</code> environment variables and their
      associated API routines are now supported as well as the memory-allocation
      routines added for Fortran and extended for C/C++ in OpenMP 5.1. In
      Fortran code, strictly structured blocks can be used.</li>
    <li>The <a
      href="https://gcc.gnu.org/onlinedocs/libgomp/OpenMP-Implementation-Status.html"
      >OpenMP Implementation Status</a> can be found in the libgomp manual.</li>
  </ul>
  </li>
  <li>The new warning flag <code>-Wopenacc-parallelism</code> was added for
      OpenACC. It warns about potentially suboptimal choices related to
      OpenACC parallelism.
  </li>
  <li>The offload target code generation for OpenMP and OpenACC can now
      be better adjusted using the new <a
      href="https://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html#index-foffload-options"
      ><code>-foffload-options=</code></a> flag and the pre-existing but now
      documented <a
      href="https://gcc.gnu.org/onlinedocs/gcc/C-Dialect-Options.html#index-foffload"
      ><code>-foffload=</code></a> flag.
  </li>
</ul>

<!-- <h3 id="ada">Ada</h3> -->

<h3 id="c-family">C family</h3>
<ul>
  <li>Support for <code>__builtin_shufflevector</code> compatible with
      the clang language extension was added.</li>
  <li>Support for attribute <code>unavailable</code> was added.</li>
  <li>A new built-in function, <code>__builtin_assoc_barrier</code>, was added.
      It can be used to inhibit re-association of floating-point
      expressions.</li>
  <li>New warnings:
    <ul>
      <li><code>-Wbidi-chars</code> warns about potentially misleading UTF-8
	bidirectional control characters.  The default is
	<code>-Wbidi-chars=unpaired</code>
	(<a href="https://gcc.gnu.org/PR103026">PR103026</a>)</li>
      <li><code>-Warray-compare</code> warns about comparisons between two operands of
	  array type (<a href="https://gcc.gnu.org/PR97573">PR97573</a>)</li>
    </ul>
  </li>
  <li>Enhancements to existing warnings:
    <ul>
      <li><code>-Wattributes</code> has been extended so that it's
	possible to use <code>-Wno-attributes=ns::attr</code> or
	<code>-Wno-attributes=ns::</code> to suppress warnings about unknown scoped
	attributes (in C++11 and C2X).  Similarly,
	<code>#pragma GCC diagnostic ignored_attributes "vendor::attr"</code> can
	be used to achieve the same effect
	(<a href="https://gcc.gnu.org/PR101940">PR101940</a>)</li>
    </ul>
  </li>
</ul>

<h3 id="cxx">C++</h3>
<ul>
  <li>Several C++23 features have been implemented:
    <ul>
      <li><a href="https://wg21.link/p1938">P1938R3</a>, <code>if consteval</code>
	  (<a href="https://gcc.gnu.org/PR100974">PR100974</a>)</li>
      <li><a href="https://wg21.link/p0849">P0849R8</a>, <code>auto(x)</code>:
	  decay-copy in the language
	  (<a href="https://gcc.gnu.org/PR103049">PR103049</a>)</li>
      <li><a href="https://wg21.link/p2242">P2242R3</a>, Non-literal variables (and
	  labels and gotos) in constexpr functions
	  (<a href="https://gcc.gnu.org/PR102612">PR102612</a>)</li>
      <li><a href="https://wg21.link/p2334">P2334R1</a>, Support for preprocessing
	  directives <code>elifdef</code> and <code>elifndef</code>
	  (<a href="https://gcc.gnu.org/PR102616">PR102616</a>)</li>
      <li><a href="https://wg21.link/p2360">P2360R0</a>, Extend <em>init-statement</em>
	  to allow <em>alias-declaration</em>
	  (<a href="https://gcc.gnu.org/PR102617">PR102617</a>)</li>
      <li><a href="https://wg21.link/p2128">P2128R6</a>, Multidimensional subscript
	  operator</li>
      <li><a href="https://wg21.link/cwg2397">DR 2397</a>, <code>auto</code> specifier
	  for pointers and references to arrays
	  (<a href="https://gcc.gnu.org/PR100975">PR100975</a>)</li>
    </ul>
  </li>
  <li>Several C++ Defect Reports have been resolved, e.g.:
    <ul>
      <li><a href="https://wg21.link/cwg960">DR 960</a>, Covariant functions and
	  lvalue/rvalue references</li>
      <li><a href="https://wg21.link/cwg1227">DR 1227</a>, Mixing immediate and
	  non-immediate contexts in deduction failure</li>
      <li><a href="https://wg21.link/cwg1315">DR 1315</a>, Restrictions on non-type
	  template arguments in partial specializations</li>
      <li><a href="https://wg21.link/cwg2082">DR 2082</a>, Referring to parameters
	  in unevaluated operands of default arguments</li>
      <li><a href="https://wg21.link/cwg2351">DR 2351</a>, <code>void{}</code></li>
      <li><a href="https://wg21.link/cwg2374">DR 2374</a>, Overly permissive
	  specification of <code>enum</code> direct-list-initialization</li>
      <li><a href="https://wg21.link/cwg2397">DR 2397</a>, <code>auto</code> specifier
	  for pointers and references to arrays</li>
      <li><a href="https://wg21.link/cwg2446">DR 2446</a>, Questionable type-dependency
	  of <em>concept-ids</em></li>
    </ul>
  </li>
  <li>New command-line option <code>-fimplicit-constexpr</code> can be used to
      make inline functions implicitly constexpr
      (<a href="https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=87c2080b">git</a>)</li>
  <li>Deduction guides can be declared at class scope
      (<a href="https://gcc.gnu.org/PR79501">PR79501</a>)</li>
  <li><code>-Wuninitialized</code> warns about using uninitialized variables in
      member initializer lists (<a href="https://gcc.gnu.org/PR19808">PR19808</a>)
      </li>
  <li><code>-Wint-in-bool-context</code> is now disabled when instantiating
      a template (<a href="https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=3a2b12bc">git</a>)</li>
  <li>Stricter checking of attributes on friend declarations: if a friend
      declaration has an attribute, that declaration must be a definition.
      Moreover, a C++11 attribute cannot appear in the middle of the
      <em>decl-specifier-seq</em>.
      (<a href="https://gcc.gnu.org/PR99032">PR99032</a>)</li>
  <li>New warning options for C++ language mismatches:
      <code>-Wc++11-extensions</code>, <code>-Wc++14-extensions</code>,
      <code>-Wc++17-extensions</code>, <code>-Wc++20-extensions</code>,
      and <code>-Wc++23-extensions</code>.  They are enabled by default
      and can be used to control existing pedwarns about occurences of
      new C++ constructs in code using an old C++ standard dialect.</li>
  <li>New warning <code>-Wmissing-requires</code> warns about missing
      <code>requires</code>
      (<a href="https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=e18e56c7">git</a>)</li>
  <li>The existing <code>std::is_constant_evaluated</code> in <code>if</code>
      warning was extended to warn in more cases
      (<a href="https://gcc.gnu.org/PR100995">PR100995</a>)</li>
  <li><code>-Waddress</code> has been enhanced so that it now warns about, for
      instance, comparing the address of a nonstatic member function to null
      (<a href="https://gcc.gnu.org/PR102103">PR102103</a>)</li>
  <li>Errors about narrowing are no longer hidden if they occur in system
      headers</li>
  <li>Ordered comparison of null pointers is now rejected
      (<a href="https://gcc.gnu.org/PR99701">PR99701</a>)</li>
  <li>Anonymous structs with bases are now rejected
      (<a href="https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=3ead06c1">git</a>)</li>
  <li>The compiler rejects taking the address of an immediate member function
      (<a href="https://gcc.gnu.org/PR102753">PR102753</a>)</li>
  <li>The compiler has support for C++20
      <code>__cpp_lib_is_pointer_interconvertible</code> and
      <code>__cpp_lib_is_layout_compatible</code> to help the C++
      library implement <a href="https://wg21.link/p0466">P0466</a>,
      Layout-compatibility and Pointer-interconvertibility Traits
      (<a href="https://gcc.gnu.org/PR101539">PR101539</a>)</li>
  <li>Memory usage of constraint subsumption has been improved
      (<a href="https://gcc.gnu.org/PR100828">PR100828</a>)</li>
  <li><code>constinit thread_local</code> variables are optimized better
      (<a href="https://gcc.gnu.org/PR101786">PR101786</a>)</li>
  <li>Support for C++17 <code>std::hardware_destructive_interference_size</code>
      was added, along with the <code>-Winterference-size</code> warning
      (<a href="https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=76b75018">git</a>)</li>
  <li>Many bugs in the CTAD handling have been fixed
      (<a href="https://gcc.gnu.org/PR101344">PR101344</a>,
       <a href="https://gcc.gnu.org/PR101883">PR101883</a>,
       <a href="https://gcc.gnu.org/PR89062">PR89062</a>,
       <a href="https://gcc.gnu.org/PR101233">PR101233</a>,
       <a href="https://gcc.gnu.org/PR88252">PR88252</a>,
       <a href="https://gcc.gnu.org/PR86439">PR86439</a>,
       <a href="https://gcc.gnu.org/PR98832">PR98832</a>,
      <a href="https://gcc.gnu.org/PR102933">PR102933</a> ...)</li>
  <li>Several issues with constrained variable templates have been fixed
      (<a href="https://gcc.gnu.org/PR98486">PR98486</a>)</li>
  <li>The compiler performs less instantiating when doing speculative constant
      evaluation
      (<a href="https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=1595fe44">git</a>)</li>
  <li>Various diagnostic improvements; e.g., a more precise caret location for
      pointer-to-member expressions</li>
</ul>

<h4 id="libstdcxx">Runtime Library (libstdc++)</h4>

<ul>
<li>Improved experimental C++20 support, including:
  <ul>
  <li><code>std::vector</code>, <code>std::optional</code>,
      and <code>std::variant</code> can be used in <code>constexpr</code>
      functions.</li>
  <li>Layout-compatibility and pointer-interconvertibility traits.</li>
  </ul>
</li>
<li>Improved experimental C++23 support, including:
  <ul>
  <li>Monadic operations for <code>std::optional</code>.</li>
  <li><code>std::move_only_function</code></li>
  <li><code>std::invoke_r</code></li>
  <li><code>std::basic_string::resize_and_overwrite</code></li>
  </ul>
</li>
</ul>

<!-- <h3 id="d">D</h3> -->

<h3 id="fortran">Fortran</h3>
<ul>
  <li>WG5/N1942, "TS 29113 Further Interoperability of Fortran with C",
    is now fully supported.  In addition to implementing previously
    missing functionality, such as support for character arguments of
    length greater than one in functions marked <code>bind(c)</code>
    and gaps in the handling for assumed-rank arrays, numerous other bugs
    have been fixed, and an extensive set of new conformance test cases
    has been added.
  </li>
  <li>
    GCC 12 now uses <code>OPERATION</code> as the name of the function to
    the <code>CO_REDUCE</code> intrinsic for the pairwise reduction, thus
    conforming to the Fortran 2018 standard.  Previous versions
    used <code>OPERATOR</code>, which conformed to TS 18508.
  </li>
</ul>

<!-- <h3 id="go">Go</h3> -->

<!-- .................................................................. -->
<!-- <h2 id="jit">libgccjit</h2> -->

<!-- .................................................................. -->
<h2 id="targets">New Targets and Target Specific Improvements</h2>

<!-- <h3 id="aarch64">AArch64</h3> -->

<h3 id="amdgcn">AMD Radeon (GCN)</h3>
<ul>
  <li>Debug experience with ROCGDB has been improved.</li>
  <li>Support for the type <code>__int128_t</code>/<code>integer(kind=16)</code>
      was added.</li>
</ul>

<!-- <h3 id="arc">ARC</h3> -->

<!-- <h3 id="arm">ARM</h3> -->

<!-- <h3 id="avr">AVR</h3> -->

<h3 id="bpf">BPF</h3>
<ul>
  <li>Support for CO-RE (compile-once, run-everywhere) has been added
      to the BPF backend.  CO-RE allows to compile portable BPF
      programs that are able to run among different versions of the
      Linux kernel.
  </li>
</ul>

<h3 id="x86">IA-32/x86-64</h3>
<ul>
  <li>New ISA extension support for Intel AVX512-FP16 was added.
      AVX512FP16 intrinsics are available via the <code>-mavx512fp16</code>
      compiler switch.
  </li>
  <li>For both C and C++ the <code>_Float16</code> type is supported on
      x86 systems with SSE2 enabled. Without <code>{-mavx512fp16}</code>,
      all operations will be emulated in software and <code>float</code>
      instructions.
  </li>
</ul>

<!-- <h3 id="mips">MIPS</h3> -->

<!-- <h3 id="mep">MeP</h3> -->

<!-- <h3 id="msp430">MSP430</h3> -->

<!-- <h3 id="nds32">NDS32</h3> -->

<!-- <h3 id="nios2">Nios II</h3> -->

<h3 id="nvptx">NVPTX</h3>
<ul>
  <li>The <code>-mptx</code> flag has been added to specify the PTX ISA version
      for the generated code; permitted values are <code>3.1</code>
      (default, matches previous GCC versions) and <code>6.3</code>.
  </li>
  <li>The new <code>__PTX_SM__</code> predefined macro allows code to check the
      compute model being targeted by the compiler.</li>
</ul>
<!-- <h3 id="hppa">PA-RISC</h3> -->

<h3 id="powerpc">PowerPC / PowerPC64 / RS6000</h3>
<ul>
  <li>
    The internal implementation of Power's target-specific built-in functions
    has been rewritten to be easier and less error-prone to maintain.  Every
    attempt has been made to ensure that the new behavior matches the old
    behavior, but inevitably some bugs can be expected.  Please report any
    problems using <a href="https://gcc.gnu.org/bugzilla">GCC Bugzilla</a>.
  </li>
  <li>
    The built-in functions <code>__builtin_get_texasr</code>,
    <code>__builtin_get_texasru</code>, <code>__builtin_get_tfhar</code>,
    <code>__builtin_get_tfiar</code>, <code>__builtin_set_texasr</code>,
    <code>__builtin_set_texasru</code>, <code>__builtin_set_tfhar</code>, and
    <code>__builtin_set_tfiar</code> now behave as documented in all
    supported configurations.  On prior releases, the arguments and return
    values of these functions were treated as <code>unsigned long long</code>
    instead of as <code>unsigned long</code>, when the options <code>-m32
    -mpowerpc64</code> were in effect.
  </li>
</ul>

<h3 id="pru">PRU</h3>
<ul>
  <li>The <a
      href="https://gcc.gnu.org/onlinedocs/gcc/Named-Address-Spaces.html#PRU-Named-Address-Spaces"
      ><code>__regio_symbol</code></a> variable qualifier has been added.
      It allows easier access in C programs to the <code>__R30</code> and
      <code>__R31</code> CPU I/O registers.
  </li>
</ul>
<!-- <h3 id="s390">S/390, System z, IBM z Systems</h3> -->

<!-- <h3 id="riscv">RISC-V</h3> -->

<!-- <h3 id="rx">RX</h3> -->

<!-- <h3 id="sh">SH</h3> -->

<!-- <h3 id="sparc">SPARC</h3> -->

<!-- <h3 id="Tile">Tile</h3> -->

<!-- .................................................................. -->
<h2 id="os">Operating Systems</h2>

<!-- <h3 id="aix">AIX</h3> -->

<!-- <h3 id="fuchsia">Fuchsia</h3> -->

<!-- <h3 id="dragonfly">DragonFly BSD</h3> -->

<!-- <h3 id="freebsd">FreeBSD</h3> -->

<!-- <h3 id="gnulinux">GNU/Linux</h3> -->

<!-- <h3 id="rtems">RTEMS</h3> -->

<!-- <h3 id="solaris">Solaris</h3> -->

<!-- <h3 id="vxmils">VxWorks MILS</h3> -->

<!-- <h3 id="windows">Windows</h3> -->


<!-- .................................................................. -->
<!-- <h2>Documentation improvements</h2> -->


<!-- .................................................................. -->
<!-- <h2 id="plugins">Improvements for plugin authors</h2> -->

<!-- .................................................................. -->
<h2>Other significant improvements</h2>

<h3 id="uninitialized">Eliminating uninitialized variables</h3>

<ul>
  <li>GCC can now initialize all stack variables implicitly, including
      padding. This is intended to eliminate all classes of uninitialized
      stack variable flaws. Lack of explicit initialization will still
      warn when <code>-Wuninitialized</code> is active. For best
      debugging, use of the new command-line option
      <code>-ftrivial-auto-var-init=pattern</code> can be used to fill
      variables with a repeated <code>0xFE</code> pattern, which tends to
      illuminate many bugs (e.g. pointers receive invalid addresses, sizes
      and indices are very large). For best production results, the new
      command-line option <code>-ftrivial-auto-var-init=zero</code> can be
      used to fill variables with <code>0x00</code>, which tends to provide
      a safer state for bugs (e.g. pointers are <code>NULL</code>, strings
      are <code>NUL</code> filled, and sizes and indices are <code>0</code>).
  </li>
</ul>

<h3 id="debug">Debugging formats</h3>

<ul>
  <li>GCC can now generate debugging information
      in <a href="https://ctfstd.org">CTF</a>, a lightweight debugging
      format that provides information about C types and the
      association between functions and data symbols and types.  This
      format is designed to be embedded in ELF files and to be very
      compact and simple.  A new command-line
      option <code>-gctf</code> enables the generation of CTF.
  </li>
  <li>GCC can now generate debugging information in BTF.  This is a
      debugging format mainly used in BPF programs and the Linux
      kernel.  The compiler can generate BTF for any target, when
      enabled with the command-line option <code>-gbtf</code>
  </li>
</ul>


<!-- .................................................................. -->
<!-- <h2><a name="12.1">GCC 12.1</a></h2> -->

</body>
</html>
