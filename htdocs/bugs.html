<html>

<head>
<title>GCC Bugs</title>
</head>

<body>

<p><a href="#report">Reporting Bugs</a>
 | <a href="#manage">Managing Bugs (GNATS and the test-suite)</a>
 | <a href="#known">Frequently Reported Bugs in GCC 2.95</a>
</p>

<h1><a name="report">Reporting Bugs</a></h1>

<p>The <a href="onlinedocs/">gcc info manual</a>, section Bugs contains
complete instructions on how to report bugs.
The manual can also be read using `<i>M-x <tt>info</tt></i>' in Emacs, or if
the GNU <tt>info</tt> program is installed on your system by `<tt>info --node
"(gcc)Bugs"</tt>'.

<p>Before you report a bug for the <em>C++ compiler</em>, please check
the <a href="#known">list of well-known bugs</a>. If you want to
report a bug with <em>egcs 1.0.x</em> or <em>egcs 1.1.x</em>, we
strongly recommend upgrading to the current release first.</p>

<p>In short, if GCC says <tt>Internal compiler error</tt> (or any
other error that you'd like us to be able to reproduce, for that
matter), please mail a bug report to <a
href="mailto:gcc-bugs@gcc.gnu.org">gcc-bugs@gcc.gnu.org</a> or
<a href="mailto:bug-gcc@gnu.org">bug-gcc@gnu.org</a> including:</p>

<ul>
  <li>The GCC version</li>
  <li>The system type</li>
  <li>All options you passed to the compiler</li>
  <li>Preprocessed output of the source file that caused the compiler
      error, even if the source code can be downloaded from elsewhere</li>
</ul>

<p>Instead of sending a bug report by mail, you can also enter it
directly into <a href="gnats.html">GNATS</a>.</p>

<p>All this can normally be accomplished by mailing the command line, the
output of the command, and the resulting `<tt><i>your-file</i>.i</tt>' for C,
or `<tt><i>your-file</i>.ii</tt>' for C++, corresponding to:</p>

<p><tt>gcc -v --save-temps <i>all-your-options</i> <i>your-file</i>.c</tt></p>

<p>Typically the CPP output (extension <code>.i</code> for C or
<code>.ii</code> for C++) will be large, so please compress the
resulting file with one of the popular compression programs such as
<tt>bzip2</tt>, <tt>gzip</tt>, <tt>zip</tt> or <tt>compress</tt> (in
decreasing order of preference).  Use maximum compression
(<code>-9</code>) if available.  Please include the compressed CPP
output in your bug report, even if the source code is freely available
elsewhere; it makes the job of our volunteer testers much easier.</p>

<p>Since we're supposed to be able to re-create the assembly output
(extension <code>.s</code>), you usually don't have to include it in
the bug report, although you may want to post parts of it to point out
assembly code you consider to be wrong.</p>

<p>Whether to use MIME attachments or <code>uuencode</code> is up to
you.  In any case, make sure the compiler command line, version and
error output are in plain text, so that we don't have to decode the
bug report in order to tell who should take care of it.  A meaningful
subject indicating language and platform also helps.</p>

<p>Please avoid posting an archive (.tar, .shar or .zip); we generally
need just a single file to reproduce the bug (the .i/.ii preprocessed
file), and, by storing it in an archive, you're just making our
volunteers' jobs harder.  Only when your bug report requires multiple
source files to be reproduced should you use an archive.  In any case,
make sure the compiler version, error message, etc, are included in
the body of your bug report as plain text, even if needlessly
duplicated as part of an archive.</p>

<p>The gcc lists have message size limits (100 kbytes) and bug reports
over those limits will currently be bounced.  We're trying to find a
way to allow larger bug reports to be posted, but this is currently
impossible (unless you use MIME partials, which most people are unable
to handle anyway, so you'd better avoid them for now).  So, although
we prefer to have complete bug reports archived, if you cannot reduce
the bug report below the limit, please make it available for ftp or
http and post the URL.  Another alternative is to break the
preprocessed output in multiple files (using <code>split</code>, for
example) and post them in separate messages, but we prefer to have
self-contained bug reports in single messages.</p>

<p>If you fail to supply enough information for a bug report to be
reproduced, someone will probably ask you to post additional
information (or just ignore your bug report, if they're in a bad day,
so try to get it right on the first posting :-).  In this case, please
post the additional information to the bug reporting mailing list, not
just to the person who requested it, unless explicitly told so.  If
possible, please include in this follow-up all the information you had
supplied in the incomplete bug report (including the preprocessor
output), so that the new bug report is self-contained.</p>



<h1><a name="manage">Managing Bugs (GNATS and the test-suite)</a></h1>

<p>This section contains information mostly intended for GCC
contributors.</p>

<p>If you find a bug, but you are not fixing it (yet):</p>
<ol>
<li>Create a (minimal) test-case.
<li>Add the test-case to our test-suite, marking it as XFAIL.
<li>Add a bug report referencing the test-case to GNATS.
</ol>

<p>If you fix a bug for which there is already a GNATS entry:</p>
<ol>
<li>Remove the XFAIL on the test-case.
<li>Close the bug report in GNATS.
</ol>

<p>If you find a bug, and you are fixing it right then:</p>
<ol>
<li>Create a (minimal) test-case.
<li>Add the test-case to our test-suite, marking it as PASS.
<li>Check in your fixes.
</ol>


<h1><a name="known">Frequently Reported Bugs in GCC 2.95</a></h1>

<p>The latest version of this document is always available at <a href="
http://gcc.gnu.org/bugs.html">http://gcc.gnu.org/bugs.html</a>.

<h2>Fortran</h2>
<p> Fortran bugs are documented in the G77 manual rather than explicitly
listed here.  Please see <a href="onlinedocs/g77_bugs.html">"Known
Causes of Trouble with GNU Fortran"</a> in the
<a href="onlinedocs/g77_toc.html">G77 manual.</a>


<h2>C++</h2>

<p>This is the list of bugs in g++ (aka GNU C++) that are reported very often,
but not yet
fixed. While it is certainly better to fix bugs instead of documenting
them, this document might save people the effort of writing a bug
report when the bug is already well-known.
<a href="faq.html#bugreport">How to report bugs</a> tells you how to report a
bug.

<p>There are many reasons why reported bugs don't get fixed. It might
be difficult to fix, or fixing it might break compatibility. Often,
reports get a low priority when there is a simple work-around. In
particular, bugs caused by invalid C++ code have a simple work-around,
<em>fix the code</em>. Now that there is an agreed ISO/ANSI standard
for C++, the compiler has a definitive document to adhere to. Earlier
versions might have accepted source code that is <em>no longer</em>
C++. This means that code which might have `worked' in a previous
version, is now rejected. You should update your code to be C++.

<p>You should try to use the latest stable release of the GNU C++
compiler. This is currently 2.95. Many commonly reported bugs in earlier
releases are fixed in that version.

<h3><a name="access"></a>G++ allows to access private types</h3>
GCC 2.95 incorrectly accepts code like
<pre>
struct X{
 private:
   struct Y{};
};

X::Y z;
</pre>

<p>Since <CODE>Y</CODE> is a private member of <CODE>X</CODE>, the
definition of <CODE>z</CODE> should be rejected, but isn't. This
applies to structs, classes and types in general; for other members of
classes (functions and data), access control is implemented.</p>

<p>In the development branch of GCC, this bug was fixed on Feb 7, 2000.
The fix will appear in the next major release of GCC (after 2.95).</p>

<h3><a name="export"></a>export not implemented</h3>

As of GCC 2.95, the <CODE>export</CODE> keyword is not implemented. 
This feature, when implemented, will permit moving
definitions of templates out of header files; exported
templates can be instantiated without a visible definition.

<h3><a name="using"></a>Using declarations in classes do not work</h3>

The Annotated Reference Manual (ARM) defines an access declaration for
cases like

<pre>
struct X{
 protected:
   int i;
};

class Y: private X{
  public:
    X::i;
};

void f()
{
  Y y;
  y.i=4;
}
</pre>
Even though <CODE>X::i</CODE> is protected, it is redeclared public in
<CODE>Y</CODE>.

<p>Standard C++ extends this notion and aligns it with <CODE>using</CODE>
declarations available in namespaces. In Standard C++, the following
code is also valid:
<pre>
struct X{
 protected:
   int i(bool);
};

class Y: private X{
  public:
    int i(int);
    using X::i;
};

void f()
{
  Y y;
  y.i(true);
}
</pre>

A <CODE>using</CODE> declaration not only redeclares access, it also permits
merging functions from the base class into the derived class, which is
convenient for overloading. In Standard C++, the ARM-style notation is
equivalent to <CODE>using</CODE> declarations.

<p>GCC 2.95 rejects this code. It treats <CODE>using</CODE> declarations in
the same way as ARM-style access declarations.

<h3><a name="parsing"></a>Parse errors for "simple" code</h3> 

Up to and including GCC 2.95, the compiler will give "parse error" for
seemingly simple code, such as

<pre>
struct A{
  A();
  A(int);
  void func();
};

struct B{
  B(A);
  B(A,A);
  void func();
};

void foo(){
  B b(A(),A(1));     //Variable b, initialized with two temporaries
  B(A(2)).func();    //B temporary, initialized with A temporary
}
</pre>
The problem is that GCC starts to parse the declaration of
<CODE>b</CODE> as a function <CODE>b</CODE> returning <CODE>B</CODE>,
taking a function returning <CODE>A</CODE> as an argument. When it
sees the 1, it is too late. The work-around in these cases is to add
additional parentheses around the expressions that are mistaken as
declarations:
<pre>
  (B(A(2))).func();
</pre>
Sometimes, even that is not enough; to show the compiler that this
should be really an expression, a comma operator with a dummy argument
can be used:
<pre>
  B b((0,A()),A(1));
</pre>
<p>
Another example is the parse error for the <CODE>return</CODE>
statement in
<pre>
struct A{};

struct B{
  A a;
  A f1(bool);
};

A B::f1(bool b)
{
  if (b)
    return (A()); 
  return a;
}
</pre>
The problem is that the compiler interprets <CODE>A()</CODE> as a
function (taking no arguments, returning <CODE>A</CODE>), and
<CODE>(A()</CODE>) as a cast - with a missing expression, hence the
parse error. The work-around is to omit the parentheses:
<pre>
  if (b)
    return A(); 
</pre>
This problem occurs in a number of variants; in <CODE>throw</CODE>
statements, people also frequently put the object in parentheses. The
exact error also somewhat varies with the compiler version. The
work-arounds proposed do not change the semantics of the program at
all; they make them perhaps less readable.

<h3><a name="library"></a>C++ Library not compliant</h3>
In Standard C++, the programmer can use a considerable run-time
library, including the STL (Standard Template Library), iostreams
for single-byte and wide characters, localization features, and
others.

<p>Many of the standard library features are not implemented in GCC
2.95. Others, such as iostreams, are supported, but not in a
compliant way (e.g. <CODE>ostream</CODE> is not
<CODE>basic_ostream&lt;char&gt;</CODE>, and not
declared in <CODE>std::</CODE>).

<p>SGI's implementation of the STL is included, but it is in the
global namespace, not in <CODE>std::</CODE>.

<p>Work is underway to complete a <a href="http://sources.redhat.com/libstdc++/">new C++
library</a> which will provide all the functionality in a compliant
way.

<h3><a name="exception"></a>Exception specifiers on function pointers</h3>
<p>Although allowed by the standard, GCC 2.95 will report an
'invalid exception specifications' error if you
declare a function pointer with an exception specification.
<pre>
void (*fptr)() throw();
</pre>

</body>
</html>
