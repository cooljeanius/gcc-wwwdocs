<html>

<head>
<title>GCC 4.5 Release Series &mdash; Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 4.5 Release Series<br />Changes, New Features, and Fixes</h1>

<h2>Caveats</h2>

  <ul>
    <li>Support has been removed for all the 
    <a href="../gcc-4.4/changes.html#obsoleted">configurations obsoleted
    in GCC 4.4</a>.</li>
    <li>Support has been removed for the <code>protoize</code>
    and <code>unprotoize</code> utilities, obsoleted in GCC 4.4.</li>
 </ul>

<h2>General Optimizer Improvements</h2>

  <ul>

    <li>The <code>-save-temps</code> now takes an optional argument.  The
    <code>-save-temps</code> and <code>-save-temps=cwd</code> switches write
    the temporary files in the current working directory based on the original
    source file.  The <code>-save-temps=obj</code> switch will write files into
    the directory specified with the <code>-o</code> option, and the
    intermediate filenames are based on the output file.  This will allow the
    user to get the compiler intermediate files when doing parallel builds
    without two builds of the same filename located in different directories
    from interfering with each other.</li>

    <li>Debugging dumps are now created in the same directory as the
    object file rather than in the current working directory.  This
    allows the user to get debugging dumps when doing parallel builds
    without two builds of the same filename interfering with each other.</li>

    <li>The <a href="http://www.multiprecision.org/">Multiple Precision
    Complex Library</a> (MPC) is now used if found at configure time.
    This allows GCC to evaluate calls to complex built-in math functions
    having constant arguments at compile-time and replace them with their
    mathematically equivalent results. Some complex functions were
    supported before; for those a fall back is used if MPC is not
    available.</li>

    <li>A new link-time optimizer has been added (<code>-flto</code>).
    When this flag is used, GCC generates a bytecode representation of
    each input file and writes it to special ELF sections in each
    object file.  When the object files are linked together, all the
    function bodies are read from these ELF sections and instantiated
    as if they had been part of the same translation unit.  This
    enables interprocedural optimizations to work across different
    files (and even different languages), potentially improving the
    performance of the generated code.</li>

  </ul>

<h2>New Languages and Language specific improvements</h2>

<h3>All languages</h3>
  <ul>
    <li>The <code>-fshow-column</code> option is now on by default.  This 
    means error messages now have a column associated with them.</li>
  </ul>

<h3>Ada</h3>

  <ul>
    <li>Compilation of programs heavily using discriminated record types
    with variant parts has been sped up and generates more compact code.</li>
  </ul>

<h3>C family</h3>

  <ul>
    <li>If a header named in a <code>#include</code> directive is not
    found, the compiler exits immediately.  This avoids a cascade of
    errors arising from declarations expected to be found in that
    header being missing.</li>
    <li>GCC now implements C90- and C99-conforming rules for constant
    expressions.  This may cause warnings or errors for some code
    using expressions that can be folded to a constant but are not
    constant expressions as defined by ISO C.</li>
    <li>A new built-in function <code>__builtin_unreachable()</code>
    has been added that tells the compiler that control will never
    reach that point.  It may be used after <code>asm</code>
    statements that terminate by transferring control elsewhere, and
    in other places that are known to be unreachable.</li>
  </ul>

<h3>C</h3>
  <ul>
    <li>The <code>-Wenum-compare</code> option, which warns when
    comparing values of different enum types, now works for C.  It
    formerly only worked for C++.  This warning is enabled
    by <code>-Wall</code>.  It may be avoided by using a
    type cast.</li>
    <li>The <code>-Wcast-qual</code> option now warns about casts
    which are unsafe in that they permit const-correctness to be
    violated without further warnings.  Specifically, it warns about
    cases where a qualifier is added when all the lower types are
    not <code>const</code>.  For example, it warns about a cast
    from <code>char **</code> to <code>const char **</code>.</li>
    <li>The <code>-Wc++-compat</code> option is significantly
    improved.  It issues new warnings for:
      <ul>
	<li>Using C++ reserved operator names as identifiers.</li>
	<li>Conversions to enum types without explicit casts.</li>
	<li>Using va_arg with an enum type.</li>
	<li>Using different enum types in the two branches
	of <code>?:</code>.</li>
	<li>Using <code>++</code> or <code>--</code> on a variable of
	enum type.</li>
	<li>Using the same name as both a struct, union or enum tag
	and a typedef, unless the typedef refers to the tagged type
	itself.</li>
	<li>Using a struct, union, or enum which is defined within
	another struct or union.</li>
	<li>A struct field defined using a typedef if there is a field
	in the struct, or an enclosing struct, whose name is the
	typedef name.</li>
	<li>Duplicate definitions at file scope.</li>
	<li>Uninitialized const variables.</li>
	<li>A global variable with an anonymous struct, union, or enum
	type.</li>
	<li>Using a string constant to initialize a char array whose
	size is the length of the string.</li>
      </ul></li>
    <li>The new <code>-Wjump-misses-init</code> option warns about
    cases where a <code>goto</code> or <code>switch</code> skips the
    initialization of a variable.  This sort of branch is an error in
    C++ but not in C.  This warning is enabled
    by <code>-Wc++-compat</code>.</li>
  </ul>

<h3>C++</h3>
  <ul>
    <li><a href="cxx0x_status.html">Improved experimental support for the
    upcoming ISO C++ standard, C++0x</a>. Including support for
    lambda-expressions and <code>explicit</code> type conversion
    operators.</li>

    <li>When printing the name of a class template specialization, G++ will
    now omit any template arguments which match the default template
    argument for that parameter.  This behavior (and the pretty-printing of
    function template specializations as template signature and arguments)
    can be disabled with the <code>-fno-pretty-templates</code>
    option.</li>

    <li>Access control is now applied to <code>typedef</code> names used in
    a template, which may cause G++ to reject some ill-formed code that was
    accepted by earlier releases.  The <code>-fno-access-control</code>
    flag can be used as a temporary workaround until the code is
    corrected.</li>

    <li>Compilation time for code that uses templates should now scale
      linearly with the number of instantiations rather than quadratically,
      as template instantiations are now looked up using hash tables.</li>

    <li>Declarations of functions that look like builtin declarations of
      library functions are only considered to be redeclarations if they
      are declared with extern &quot;C&quot;.  This may cause problems with
      code that omits extern &quot;C&quot; on hand-written declarations of
      C library functions such as <code>abort</code>
      or <code>memcpy</code>.  Such code is ill-formed, but was accepted by
      earlier releases.</li>

    <li>Diagnostics that used to complain about passing non-POD types to
      <code>...</code> or jumping past the declaration of a non-POD
      variable now check for triviality rather than PODness, as per
      C++0x.</li>

    <li>Local and anonymous classes are now allowed as template arguments,
      and in declarations of variables and functions with linkage, so long
      as any such declaration that is used is also defined, as per
      C++0x.</li>

    <li>Labels may now have attributes, as has been permitted for a
    while in C.  This is only permitted when the label definition and
    the attribute specifier is followed by a semicolon&mdash;i.e., the
    label applies to an empty statement.  The only useful attribute
    for a label is <code>unused</code>.</li>

  </ul>  
  <h4>Runtime Library (libstdc++)</h4>

  <ul>
    <li>The new <code>-static-libstdc++</code> option
    directs <code>g++</code> to link the C++ library statically, even
    if the default would normally be to link it dynamically.</li>
  </ul>

<h3>Fortran</h3>
  <ul>
    <li>The <code>COMMON</code> default padding has been changed &ndash;
    instead of adding the padding before a variable it is now added
    afterwards, which increases the compatibility with other vendors
    and helps to obtain the correct output in some cases. Cf. also the
    <code>-falign-commons</code> flag (<a href="../gcc-4.4/changes.html">added
    in 4.4</a>).</li>

    <li>The <code>-finit-real=</code> flag now also supports the value
    <code>snan</code> for signalling not-a-number; to be effective,
    one additionally needs to enable trapping (e.g. via
    <code>-ffpe-trap=</code>). Note: Compile-time optimizations can
    turn a signalling NaN into a quiet one.</li>

    <li>The new flag <code>-fcheck=</code> has been added with the
    options <code>bounds</code>, <code>array-temps</code>,
    <code>do</code>, <code>pointer</code>, and <code>recursive</code>. The
    <code>bounds</code> and <code>array-temps</code> options are
    equivalent to <code>-fbounds-check</code> and
    <code>-fcheck-array-temporaries</code>. The <code>do</code>
    option checks for invalid modification of loop iteration variables,
    and the <code>recursive</code> option tests for recursive calls
    to subroutines/functions which are not marked as recursive. With
    <code>pointer</code> pointer association checks in calls are performed;
    however, neither undefined pointers nor pointers in expressions are
    handled. Using <code>-fcheck=all</code> enables all these run-time
    checks.</li>

    <li>The run-time checking <code>-fcheck=bounds</code> now warns
    about invalid string lengths of character dummy arguments. Additionally,
    more compile-time checks have been added.</li>

    <li>GNU Fortran no longer links against <code>libgfortranbegin</code>.
    As before, <code>MAIN__</code> (assembler symbol name) is the actual
    Fortran main program, which is invoked by the <code>main</code> function.
    However, <code>main</code> is now generated and put in the same object
    file as <code>MAIN__</code>. For the time being,
    <code>libgfortranbegin</code> still exists for backward
    compatibility. For details see the new <a
    href="http://gcc.gnu.org/onlinedocs/gfortran/Mixed_002dLanguage-Programming.html">Mixed-Language
    Programming</a> chapter in the manual.</li>

    <li>The I/O library was restructured for performance and cleaner
    code.</li>

    <li>Array assignments and <code>WHERE</code> are now run in parallel when
    OpenMP's <code>WORKSHARE</code> is used.</li>

    <li>The experimental flag <code>-fwhole-file</code> was added. The flag
    allows whole-file checking of procedure arguments and allows for better
    optimizations. It can also be used with <code>-fwhole-program</code>,
    which is now also supported in gfortran.</li>

    <li>More Fortran 2003 and Fortran 2008 mathematical functions can
    now be used as initialization expressions.</li>
    <li>Some extended attributes such as <code>STDCALL</code> are now
    supported via the <a
    href="http://gcc.gnu.org/onlinedocs/gfortran/GNU-Fortran-Compiler-Directives.html">
    <code>GCC$</code> compiler directive</a>.</li>
    <li>For Fortran 77 compatibility: If <code>-fno-sign-zero</code> is
    used, the <code>SIGN</code> intrinsic behaves now as if zero were always
    positive.</li>
    <li>For legacy compatibiliy: On Cygwin and MinGW, the special files
    <code>CONOUT$</code> and <code>CONIN$</code> (and <code>CONERR$</code>
    which maps to <code>CONOUT$</code>) are now supported.</li>

    <li>Fortran 2003 support has been extended:
      <ul>
       <li>Procedure-pointer function results and procedure-pointer
       components (including PASS),</li>
       <li>allocatable scalars,</code>
       <li><code>DEFERRED</code> type-bound procedures,</li>
       <li>the ERRMSG= argument of the ALLOCATE and DEALLOCATE statements,
       and the SOURCE= argument in ALLOCATE have been implemented.</li>
       <li><code>OPERATOR(*)</code> and <code>ASSIGNMENT(=)</code> are now
       allowed as <code>GENERIC</code> type-bound procedure (i.e. as
       type-bound operators).</li>
       <li>Rounding (<code>ROUND=</code>, <code>RZ</code>, ...) for output
       is now supported.</li>
       <li>The <code>INT_FAST{8,16,32,64,128}_T</code> kind type parameters
       of the intrinsic module <code>ISO_C_BINDING</code> are now supported.
       </li>
       <li>Extensible derived types with type-bound procedure or procedure
       pointer with <code>PASS</code> attribute now have to use
       <code>CLASS</code> in line with the Fortran 2003 standard; the
       workaround to use <code>TYPE</code> is no longer supported.</li>
       <li>Experimental, incomplete support for polymorphism, including
       <code>CLASS</code> (as allocatable or dummy), <code>SELECT TYPE</code>
       and dynamic dispatch of type-bound procedure calls. Some features do
       not work yet such as unlimited polymorphism (<code>CODE(*)</code>),
       <code>CLASS IS</code>, <code>EXTENDS_TYPE_OF</code>.</li>
      </ul>
    </li>

    <li>Fortran 2008 support has been extended:
      <ul>
        <li>The <code>OPEN</code> statement now supports the
        <code>NEWUNIT=</code> option, which returns a unique file unit,
        thus preventing inadvertent use of the same unit in different parts
        of the program.</li>
        <li>Support for unlimited format items has been added.</li>
        <li>The <code>INT{8,16,32}</code> and <code>REAL{32,64,128}</code>
        kind type parameters of the intrinsic module
        <code>ISO_FORTRAN_ENV</code> are now supported.</li>
        <li>Using complex arguments with <code>TAN</code>, <code>SINH</code>,
        <code>COSH</code>, <code>TANH</code>, <code>ASIN</code>,
        <code>ACOS</code>, and <code>ATAN</code> is now possible; the
        functions <code>ASINH</code>, <code>ACOSH</code>, and
        <code>ATANH</code> have been added (for real and complex arguments)
        and <code>ATAN(Y,X)</code> is now an alias for <code>ATAN2(Y,X).</code>
       </li>
       <li>The <code>BLOCK</code> construct has been implemented.</li>
      </ul>
    </li>
  </ul>

<h3>Java (GCJ)</h3>

<h2 id="targets">New Targets and Target Specific Improvements</h2>

<h3>AIX</h3>
  <ul>
    <li>Full cross-toolchain support now available with GNU Binutils</li>
  </ul>

<h3>AVR</h3>
  <ul>
    <li>The <code>-mno-tablejump</code> option has been removed because it
    has the same effect as the <code>-fno-jump-tables</code> option.</li>
    <li>Added support for these new AVR devices:
      <ul>
        <li>ATmega8U2</li>
        <li>ATmega16U2</li>
        <li>ATmega32U2</li>
      </ul>
    </li>
  </ul>

<h3>IA-32/x86-64</h3>
  <ul>
    <li>GCC now supports handling floating-point excess precision
    arising from use of the x87 floating-point unit in a way that
    conforms to ISO C99.  This is enabled
    with <code>-fexcess-precision=standard</code> and with standards
    conformance options such as <code>-std=c99</code>, and may be
    disabled using <code>-fexcess-precision=fast</code>.</li>
    <li>Support for the Intel Atom processor is now available through the
        <code>-march=atom</code> and <code>-mtune=atom</code> options.</li>
  </ul>

<h3 id="mep">MeP</h3>

<p>Support has been added for the Toshiba Media embedded Processor (MeP, or
mep-elf) embedded target.</p>

<h3>MIPS</h3>

<h3 id="picochip">picochip</h3>

<h3 id="rs6000">RS/6000 (POWER/PowerPC)</h3>
  <ul>
    <li>GCC now supports the Power ISA 2.06, which includes the VSX
        instructions that add vector 64-bit floating point support, new population
        count instructions, and conversions between floating point and unsigned types.</li>
    <li>Support for the power7 processor is now available through the
        <code>-mcpu=power7</code> and <code>-mtune=power7</code>.</li>
    <li>GCC will now vectorize loops that contain simple math functions like copysign
        when generating code for altivec or VSX targets.</li>
  </ul>

<h2>Documentation improvements</h2>

<h2>Other significant improvements</h2>

<h3>Plugins</h3>
  <ul>
    <li>It is now possible to extend the compiler without having to
    modify its source code.  A new option <code>-fplugin=file.so</code>
    tells GCC to load the shared object <code>file.so</code> and execute
    it as part of the compiler.  The internal documentation describes
    the details on how plugins can interact with the compiler.</li>
  </ul>


</body>
</html>
