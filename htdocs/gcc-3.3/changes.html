<html>

<head>
<title>GCC 3.3 Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 3.3 Changes, New Features, and Fixes</h1>

<h2>Caveats</h2>

  <ul>
    <li>The preprocessor no longer accepts multi-line string literals.
        They were deprecated in 3.0, 3.1, and 3.2.</li>

    <li>Support for all the systems <a
        href="../gcc-3.1/changes.html#obsolete_systems">obsoleted in
        GCC 3.1</a> has been removed from GCC 3.3.  See <a
        href="#obsolete_systems">below</a> for a list of systems which
        are obsoleted in this release.</li>

    <li>Checking for null format arguments has been decoupled from
	the rest of the format checking mechanism.  Programs which
	use the <code>format</code> attribute may regain this
	functionality by using the new <a
	href="#nonnull_attribute"><code>nonnull</code></a> function
	attribute.  Note that all functions for which GCC has a
	built-in <code>format</code> attribute, an appropriate
	built-in <code>nonnull</code> attribute is also applied.</li>

    <li>The DWARF (version 1) debugging format has been deprecated and 
        will be removed in a future version of GCC.  Version 2 of the 
	DWARF debugging format will continue to be supported for the
        forseeable future.</li>
  </ul>


<h2>General Optimizer Improvements</h2>

  <ul>
    <li>A new scheme for accurately describing processor pipelines,
        the <a href="../news/dfa.html">DFA scheduler</a>, has been
        added.</li>
    <li><p>Pavel Nejedly, Charles University Prague, has contributed new file format
        used by the edge coverage profiler (<code>-fprofile-arcs</code>).</p>

	<p>The new format is robust and diagnoses common mistakes where
	profiles from different versions (or compilations) of the program are
	combined resulting in nonsensical profiles and slow code to produced
	with profile feedback.  Additionally this format allows extra data to
	be gathered. Currently, overall statistics are produced helping
	optimizers to identify hot spots of a program globally replacing the
	old intra-procedural scheme and resulting in better code. Note that the
	<code>gcov</code> tool from older GCC versions will not be able to
	parse the profiles generated by GCC 3.3 and vice versa.</p></li>
    <li><p>Jan Hubicka, SuSE Labs, has contributed a new superblock formation
	pass enabled using <code>-ftracer</code>.  This pass simplifies the
	control flow of functions allowing other optimizations to do better
	job.</p>
	<p>He also contributed the function reordering pass
	(<code>-freorder-functions</code>) to optimize function placement
	using profile feedback.</p></li>
  </ul>

  
<h2>New Languages and Language specific improvements</h2>

<h3>C/ObjC/C++</h3>

  <ul>
    <li>The preprocessor now accepts directives within macro
    arguments.  It processes them just as if they had not been within
    macro arguments.</li>

    <li>The separate ISO and traditional preprocessors have been
    completely removed.  The front-end handles either type of
    preprocessed output if necessary.</li>

    <li>In C99 mode preprocessor arithmetic is done in the precision
	of the target's <code>intmax_t</code>, as required by that
	standard.</li>
    
    <li>The preprocessor can now copy comments inside macros to the
	output file when the macro is expanded.  This feature, enabled
	using the <code>-CC</code> option, is intended for use by
	applications which place metadata or directives inside comments,
	such as <code>lint</code>.</li>

    <li>The method of constructing the list of directories to be searched
	for header files has been revised.  If a directory named by a
	<code>-I</code> option is a standard system include directory,
	the option is ignored to ensure that the default search order
	for system directories and the special treatment of system header
	files are not defeated.</li>

    <li>A new function attribute,
        <code><a name="nonnull_attribute">nonnull</a></code>, has been added
	which allows pointer arguments to functions to be specified as
	requiring a non-null value.  The compiler currently uses this
	information to issue a warning when it detects a null value passed
	in such an argument slot.</li>

    <li>A new type attribute,
        <code><a name="may_alias">may_alias</a></code>, has been added.
        Accesses to objects with types with this attribute are not
        subjected to type-based alias analysis, but are instead assumed to
        be able to alias any other type of objects, just like the 
        <code>char</code> type.</li>
  </ul>

<h3>C++</h3>

  <ul>
    <li>Type based alias analysis has been implemented for C++
        aggregate types. </li>
  </ul>

<h3>Java</h3>

  <ul>
    <li>The <code>java.sql</code> and <code>javax.sql</code> packages now 
    implement the JDBC 3.0 (JDK 1.4) API. </li>

    <li>The JDK 1.4 <code>assert</code> facility has been
    implemented.</li>

    <li>The bytecode interpreter is now direct threaded and thus
    faster.</li>
  </ul>

<h3>Fortran</h3>

  <ul>
    <li>Fortran improvements are listed in              
    <a href="http://gcc.gnu.org/onlinedocs/g77/News.html">
    the Fortran documentation</a>.</li>
  </ul>

<h2>New Targets and Target Specific Improvements</h2>

  <ul>
    <li>The HP-PA port now defaults to scheduling for the PA8000 series
        of processors.  Scheduling support for the PA7300 processor has
	been added.</li>
    <li>The SPARC, HP-PA, SH4, and x86 ports have been converted to
        use the DFA processor pipeline description.</li>
    <li>The following NetBSD configurations for the SuperH processor family
	have been added:
	<ul>
	  <li>SH3, big-endian, <code>sh-*-netbsdelf*</code></li>
	  <li>SH3, little-endian, <code>shle-*-netbsdelf*</code></li>
	  <li>SH5, SHmedia, big-endian, 32-bit default,
	      <code>sh5-*-netbsd*</code></li>
	  <li>SH5, SHmedia, little-endian, 32-bit default,
	      <code>sh5le-*-netbsd*</code></li>
	  <li>SH5, SHmedia, big-endian, 64-bit default,
	      <code>sh64-*-netbsd*</code></li>
	  <li>SH5, SHmedia, little-endian, 64-bit default,
	      <code>sh64le-*-netbsd*</code></li>
	</ul></li>
    <li>The following changes have been made to the MIPS port:
	<ul>
	  <li>All configurations now accept the <code>-mabi</code>
	      switch.  Note that you will need appropriate multilibs
	      for this option to work properly.</li>
	  <li>ELF configurations will always pass an ABI flag to
	      the assembler, except when the MIPS EABI is selected.</li>
	  <li><code>-mabi=64</code> no longer selects MIPS IV code.</li>
	  <li>The <code>-mcpu</code> option, which was deprecated
	      in 3.1 and 3.2, has been removed from this release.</li>
	  <li><code>-march</code> now changes the core ISA level.
	      In previous releases, it would change the use of
	      processor-specific extensions, but would leave the core
	      ISA unchanged.  For example, <code>mips64-elf
	      -march=r8000</code> will now generate MIPS IV code.</li>
	  <li>Under most configurations, <code>-mipsN</code> now acts as a
	      synonym for <code>-march</code>.</li>
	  <li>There are some new preprocessor macros to describe the
	      <code>-march</code> and <code>-mtune</code> settings.
	      See the documentation of those options for details.</li>
	</ul></li>
     <li>The necessary support to build the Java runtime libraries has 
	 been added to the S/390 port.  Java is now enabled by default
	 on <code>s390-*-linux*</code> and <code>s390x-*-linux*</code>
	 targets.</li>
  </ul>


<h2><a name="obsolete_systems">Obsolete Systems</a></h2>

  <p>Support for a number of older systems has been declared obsolete in
  GCC 3.3.  Unless there is activity to revive them, the next release of
  GCC will have their sources permanently <strong>removed</strong>.</p>

  <p>All configurations of the following processor architectures have
  been declared obsolete:</p>

  <ul>
    <li>Matsushita MN10200, <code>mn10200-*-*</code></li>
    <li>Motorola 88000, <code>m88k-*-*</code></li>
    <li>IBM ROMP, <code>romp-*-*</code></li>
  </ul>

  <p>Also, some individual systems have been obsoleted:</p>

  <ul>
    <li>MIPS
      <ul>
	<li>SINIX, <code>mips-sni-sysv4</code></li>
      </ul></li>
    <li>National Semiconductor 32000
      <ul>
	<li>OpenBSD, <code>ns32k-*-openbsd*</code></li>
      </ul></li>
    <li>VAX
      <ul>
        <li>VMS, <code>vax-*-vms*</code></li>
      </ul></li>
  </ul>


<h2>Documentation improvements</h2>


<h2>Other significant improvements</h2>

  <ul>
    <li>Almost all front-end dependencies in the compiler have been
    separated out into a set of language hooks.  This should make
    adding a new front end clearer and easier.</li>

    <li>One effect of removing the separate preprocessor is a small
    increase in the robustness of the compiler in general, and the
    maintainability of target descriptions.  Previously
    target-specific built-in macros and others, such as
    <code>__FAST_MATH__</code>, had to be handled with so-called specs
    that were hard to maintain.  Often they would fail to behave
    properly when conflicting options were supplied on the command
    line, and define macros in the user's namespace even when strict
    ISO compliance was requested.  Integrating the preprocessor has
    cleanly solved these issues.</li>
  </ul>

</body>
</html>
