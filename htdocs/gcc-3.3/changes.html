<html>

<head>
<title>GCC 3.3 Release Series &mdash; Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 3.3 Release Series<br />Changes, New Features, and Fixes</h1>

<h2>Caveats</h2>

  <ul>
    <li>The preprocessor no longer accepts multi-line string literals.
        They were deprecated in 3.0, 3.1, and 3.2.</li>

    <li>The preprocessor no longer supports the <code>-A-</code>
	switch when appearing alone.  <code>-A-</code> followed by an
	assertion is still supported.</li>

    <li>Support for all the systems <a
        href="../gcc-3.1/changes.html#obsolete_systems">obsoleted in
        GCC 3.1</a> has been removed from GCC 3.3.  See below for a
        <a href="#obsolete_systems">list of systems which are obsoleted
        in this release</a>.</li>

    <li>Checking for null format arguments has been decoupled from
	the rest of the format checking mechanism.  Programs which
	use the <code>format</code> attribute may regain this
	functionality by using the new <a
	href="#nonnull_attribute"><code>nonnull</code></a> function
	attribute.  Note that all functions for which GCC has a
	built-in <code>format</code> attribute, an appropriate
	built-in <code>nonnull</code> attribute is also applied.</li>

    <li>The DWARF (version 1) debugging format has been deprecated and
        will be removed in a future version of GCC.  Version 2 of the
	DWARF debugging format will continue to be supported for the
        foreseeable future.</li>

    <li>The C and Objective-C compilers no longer accept the "Naming
        Types" extension (<code>typedef foo = bar</code>); it was
        already unavailable in C++.  Code which uses it will need to
        be changed to use the "typeof" extension instead:
        <code>typedef typeof(bar) foo</code>.  (We have removed this
        extension without a period of deprecation because it has
        caused the compiler to crash since version 3.0 and no one
        noticed until very recently.  Thus we conclude it is not in
        widespread use.)</li>

    <li>The <code>-traditional</code> C compiler option has been
        removed.  It was deprecated in 3.1 and 3.2.  (Traditional
        preprocessing remains available.)  The
        <code>&lt;varargs.h&gt;</code> header, used for writing
	variadic functions in traditional C, still exists but will
	produce an error message if used.</li>
  </ul>


<h2>General Optimizer Improvements</h2>

  <ul>
    <li>A new scheme for accurately describing processor pipelines,
        the <a href="../news/dfa.html">DFA scheduler</a>, has been
        added.</li>
    <li><p>Pavel Nejedly, Charles University Prague, has contributed new file format
        used by the edge coverage profiler (<code>-fprofile-arcs</code>).</p>

	<p>The new format is robust and diagnoses common mistakes where
	profiles from different versions (or compilations) of the program are
	combined resulting in nonsensical profiles and slow code to produced
	with profile feedback.  Additionally this format allows extra data to
	be gathered. Currently, overall statistics are produced helping
	optimizers to identify hot spots of a program globally replacing the
	old intra-procedural scheme and resulting in better code. Note that the
	<code>gcov</code> tool from older GCC versions will not be able to
	parse the profiles generated by GCC 3.3 and vice versa.</p></li>
    <li><p>Jan Hubicka, SuSE Labs, has contributed a new superblock formation
	pass enabled using <code>-ftracer</code>.  This pass simplifies the
	control flow of functions allowing other optimizations to do better
	job.</p>
	<p>He also contributed the function reordering pass
	(<code>-freorder-functions</code>) to optimize function placement
	using profile feedback.</p></li>
  </ul>


<h2>New Languages and Language specific improvements</h2>

<h3>C/ObjC/C++</h3>

  <ul>
    <li>The preprocessor now accepts directives within macro
    arguments.  It processes them just as if they had not been within
    macro arguments.</li>

    <li>The separate ISO and traditional preprocessors have been
    completely removed.  The front-end handles either type of
    preprocessed output if necessary.</li>

    <li>In C99 mode preprocessor arithmetic is done in the precision
	of the target's <code>intmax_t</code>, as required by that
	standard.</li>

    <li>The preprocessor can now copy comments inside macros to the
	output file when the macro is expanded.  This feature, enabled
	using the <code>-CC</code> option, is intended for use by
	applications which place metadata or directives inside comments,
	such as <code>lint</code>.</li>

    <li>The method of constructing the list of directories to be searched
	for header files has been revised.  If a directory named by a
	<code>-I</code> option is a standard system include directory,
	the option is ignored to ensure that the default search order
	for system directories and the special treatment of system header
	files are not defeated.</li>

    <li>A few more <a href="c99status.html">ISO C99 features</a> now
        work correctly.</li>

    <li>A new function attribute,
        <code><a name="nonnull_attribute">nonnull</a></code>, has been added
	which allows pointer arguments to functions to be specified as
	requiring a non-null value.  The compiler currently uses this
	information to issue a warning when it detects a null value passed
	in such an argument slot.</li>

    <li>A new type attribute,
        <code><a name="may_alias">may_alias</a></code>, has been added.
        Accesses to objects with types with this attribute are not
        subjected to type-based alias analysis, but are instead assumed to
        be able to alias any other type of objects, just like the
        <code>char</code> type.</li>
  </ul>

<h3>C++</h3>

  <ul>
    <li>Type based alias analysis has been implemented for C++
        aggregate types. </li>
  </ul>

<h3>Objective-C</h3>

  <ul>
    <li>Generate an error if Objective-C objects are passed by value
         in function and method calls.</li>

    <li>When <code>-Wselector</code> is used, check the whole list of
        selectors at the end of compilation, and emit a warning if a
        <code>@selector()</code> is not known.</li>

    <li>Define <code>__NEXT_RUNTIME__</code> when compiling for the
        NeXT runtime.</li>

    <li>No longer need to include <code>objc/objc-class.h</code> to
        compile self calls in class methods (NeXT runtime only).</li>

    <li>New <code>-Wundeclared-selector</code> option.</li>

    <li>Removed selector bloating which was causing object files to be
        10% bigger on average (GNU runtime only).</li>

    <li>Using at run time <code>@protocol()</code> objects has been
        fixed in certain situations (GNU runtime only).</li>

    <li>Type checking has been fixed and improved in many situations
        involving protocols.</li>

  </ul>

<h3>Java</h3>

  <ul>
    <li>The <code>java.sql</code> and <code>javax.sql</code> packages now
    implement the JDBC 3.0 (JDK 1.4) API. </li>

    <li>The JDK 1.4 <code>assert</code> facility has been
    implemented.</li>

    <li>The bytecode interpreter is now direct threaded and thus
    faster.</li>
  </ul>

<h3>Fortran</h3>

  <ul>
    <li>Fortran improvements are listed in
    <a href="http://gcc.gnu.org/onlinedocs/g77/News.html">
    the Fortran documentation</a>.</li>
  </ul>

<h3>Ada</h3>

  <ul>
    <li>Ada tasking now works with glibc 2.3.x threading libraries.</li>
  </ul>

<h2>New Targets and Target Specific Improvements</h2>

  <ul>
    <li>The following changes have been made to the HP-PA port:
	<ul>
	<li>The port now defaults to scheduling for the PA8000 series
        of processors.</li>
	<li>Scheduling support for the PA7300 processor has been added.</li>
	<li>The 32-bit port now supports weak symbols under HP-UX 11.</li>
	<li>The handling of initializers and finalizers has been improved
	under HP-UX 11.  The 64-bit port no longer uses collect2.</li>
	<li>Dwarf2 EH support has been added to the 32-bit linux port.</li>
	<li>ABI fixes to correct the passing of small structures by value.</li>
	</ul></li>
    <li>The SPARC, HP-PA, SH4, and x86/pentium ports have been converted to
        use the DFA processor pipeline description.</li>
    <li>The following NetBSD configurations for the SuperH processor family
	have been added:
	<ul>
	  <li>SH3, big-endian, <code>sh-*-netbsdelf*</code></li>
	  <li>SH3, little-endian, <code>shle-*-netbsdelf*</code></li>
	  <li>SH5, SHmedia, big-endian, 32-bit default,
	      <code>sh5-*-netbsd*</code></li>
	  <li>SH5, SHmedia, little-endian, 32-bit default,
	      <code>sh5le-*-netbsd*</code></li>
	  <li>SH5, SHmedia, big-endian, 64-bit default,
	      <code>sh64-*-netbsd*</code></li>
	  <li>SH5, SHmedia, little-endian, 64-bit default,
	      <code>sh64le-*-netbsd*</code></li>
	</ul></li>
    <li>The following changes have been made to the IA-32/x86-64 port:
    	<ul>
	  <li>SSE2 and 3dNOW! intrinsics are now supported.</li>
	  <li>Support for thread local storage has been added to the IA-32
	      and x86-64 ports.</li>
	  <li>The x86-64 port has been significantly improved.</li>
	</ul></li>
    <li>The following changes have been made to the MIPS port:
	<ul>
	  <li>All configurations now accept the <code>-mabi</code>
	      switch.  Note that you will need appropriate multilibs
	      for this option to work properly.</li>
	  <li>ELF configurations will always pass an ABI flag to
	      the assembler, except when the MIPS EABI is selected.</li>
	  <li><code>-mabi=64</code> no longer selects MIPS IV code.</li>
	  <li>The <code>-mcpu</code> option, which was deprecated
	      in 3.1 and 3.2, has been removed from this release.</li>
	  <li><code>-march</code> now changes the core ISA level.
	      In previous releases, it would change the use of
	      processor-specific extensions, but would leave the core
	      ISA unchanged.  For example, <code>mips64-elf
	      -march=r8000</code> will now generate MIPS IV code.</li>
	  <li>Under most configurations, <code>-mipsN</code> now acts as a
	      synonym for <code>-march</code>.</li>
	  <li>There are some new preprocessor macros to describe the
	      <code>-march</code> and <code>-mtune</code> settings.
	      See the documentation of those options for details.</li>
	  <li>Support for the NEC VR-Series processors has been
              added. This includes the 54xx, 5500, and 41xx series.</li>
          <li>Support for the Sandcraft sr71k processor has been
	      added.</li>
	</ul></li>
     <li>The necessary support to build the Java runtime libraries has
	 been added to the S/390 port.  Java is now enabled by default
	 on <code>s390-*-linux*</code> and <code>s390x-*-linux*</code>
	 targets.</li>
     <li>The following changes have been made to the PowerPC port:
	 <ul>
	   <li>Support for IBM Power4 processor added.</li>
	   <li>Support for Motorola e500 SPE added.</li>
	   <li>Support for AIX 5.2 added.</li>
	   <li>Function and Data sections now supported on AIX.</li>
	   <li>Sibcall optimizations added.</li>
	 </ul></li>
     <li>The support for H8 Tiny is added to the H8/300 port with
         <code>-mn</code>.</li>
  </ul>


<h2><a name="obsolete_systems">Obsolete Systems</a></h2>

  <p>Support for a number of older systems has been declared obsolete in
  GCC 3.3.  Unless there is activity to revive them, the next release of
  GCC will have their sources permanently <strong>removed</strong>.</p>

  <p>All configurations of the following processor architectures have
  been declared obsolete:</p>

  <ul>
    <li>Matsushita MN10200, <code>mn10200-*-*</code></li>
    <li>Motorola 88000, <code>m88k-*-*</code></li>
    <li>IBM ROMP, <code>romp-*-*</code></li>
  </ul>

  <p>Also, some individual systems have been obsoleted:</p>

  <ul>
    <li>Alpha
      <ul>
       <li>Interix, <code>alpha*-*-interix*</code></li>
       <li>Linux libc1, <code>alpha*-*-linux*libc1*</code></li>
       <li>Linux ECOFF, <code>alpha*-*-linux*ecoff*</code></li>
     </ul></li>
    <li>ARM
      <ul>
        <li>Generic a.out, <code>arm*-*-aout*</code></li>
        <li>Conix, <code>arm*-*-conix*</code></li>
        <li>"Old ABI," <code>arm*-*-oabi</code></li>
        <li>StrongARM/COFF, <code>strongarm-*-coff*</code></li>
      </ul></li>
    <li>HPPA (PA-RISC)
      <ul>
        <li>Generic OSF, <code>hppa1.0-*-osf*</code></li>
        <li>Generic BSD, <code>hppa1.0-*-bsd*</code></li>
        <li>HP/UX versions 7, 8, and 9, <code>hppa1.[01]-*-hpux[789]*</code></li>
        <li>HiUX, <code>hppa*-*-hiux*</code></li>
        <li>Mach Lites, <code>hppa*-*-lites*</code></li>
      </ul></li>
    <li>Intel 386 family
      <ul>
        <li>Windows NT 3.x, <code>i?86-*-win32</code></li>
      </ul></li>
    <li>MC68000 family
      <ul>
        <li>HP systems, <code>m68000-hp-bsd*</code>
                    and <code>m68k-hp-bsd*</code></li>
        <li>Sun systems, <code>m68000-sun-sunos*</code>,
	                 <code>m68k-sun-sunos*</code>,
                     and <code>m68k-sun-mach*</code></li>
        <li>AT&amp;T systems, <code>m68000-att-sysv*</code></li>
        <li>Atari systems, <code>m68k-atari-sysv*</code></li>
        <li>Motorola systems, <code>m68k-motorola-sysv*</code></li>
        <li>NCR systems, <code>m68k-ncr-sysv*</code></li>
        <li>Plexus systems, <code>m68k-plexus-sysv*</code></li>
        <li>Commodore systems, <code>m68k-cbm-sysv*</code></li>
        <li>Citicorp TTI, <code>m68k-tti-*</code></li>
        <li>Unos, <code>m68k-crds-unos*</code></li>
        <li>Concurrent RTU, <code>m68k-ccur-rtu*</code></li>
        <li>Linux a.out, <code>m68k-*-linux*aout*</code></li>
        <li>Linux libc1, <code>m68k-*-linux*libc1*</code></li>
        <li>pSOS, <code>m68k-*-psos*</code></li>
      </ul></li>
    <li>MIPS
      <ul>
        <li>Generic ECOFF, <code>mips*-*-ecoff*</code></li>
	<li>SINIX, <code>mips-sni-sysv4</code></li>
	<li>Orion RTEMS, <code>mips64orion-*-rtems*</code></li>
      </ul></li>
    <li>National Semiconductor 32000
      <ul>
	<li>OpenBSD, <code>ns32k-*-openbsd*</code></li>
      </ul></li>
    <li>POWER (aka RS/6000) and PowerPC
      <ul>
        <li>AIX versions 1, 2, and 3, <code>rs6000-ibm-aix[123]*</code></li>
        <li>Bull BOSX, <code>rs6000-bull-bosx</code></li>
        <li>Generic Mach, <code>rs6000-*-mach*</code></li>
        <li>Generic SysV, <code>powerpc*-*-sysv*</code></li>
        <li>Linux libc1, <code>powerpc*-*-linux*libc1*</code></li>
      </ul></li>
    <li>Sun SPARC
      <ul>
        <li>Generic a.out, <code>sparc-*-aout*</code>,
	                   <code>sparclet-*-aout*</code>,
			   <code>sparclite-*-aout*</code>,
		       and <code>sparc86x-*-aout*</code></li>
        <li>NetBSD a.out, <code>sparc-*-netbsd*aout*</code></li>
        <li>Generic BSD, <code>sparc-*-bsd*</code></li>
        <li>ChorusOS, <code>sparc-*-chorusos*</code></li>
        <li>Linux a.out, <code>sparc-*-linux*aout*</code></li>
        <li>Linux libc1, <code>sparc-*-linux*libc1*</code></li>
        <li>LynxOS, <code>sparc-*-lynxos*</code></li>
        <li>Solaris on HAL hardware, <code>sparc-hal-solaris2*</code></li>
        <li>SunOS versions 3 and 4, <code>sparc-*-sunos[34]*</code></li>
      </ul></li>
    <li>NEC V850
      <ul>
        <li>RTEMS, <code>v850-*-rtems*</code></li>
      </ul></li>
    <li>VAX
      <ul>
        <li>VMS, <code>vax-*-vms*</code></li>
      </ul></li>
  </ul>


<h2>Documentation improvements</h2>


<h2>Other significant improvements</h2>

  <ul>
    <li>Almost all front-end dependencies in the compiler have been
    separated out into a set of language hooks.  This should make
    adding a new front end clearer and easier.</li>

    <li>One effect of removing the separate preprocessor is a small
    increase in the robustness of the compiler in general, and the
    maintainability of target descriptions.  Previously
    target-specific built-in macros and others, such as
    <code>__FAST_MATH__</code>, had to be handled with so-called specs
    that were hard to maintain.  Often they would fail to behave
    properly when conflicting options were supplied on the command
    line, and define macros in the user's namespace even when strict
    ISO compliance was requested.  Integrating the preprocessor has
    cleanly solved these issues.</li>

    <li>The Makefile suite now supports redirection of
    <code>make install</code> by means of the variable
    <code>DESTDIR</code>.</li>
  </ul>

</body>
</html>
