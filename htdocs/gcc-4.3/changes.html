<html>

<head>
<title>GCC 4.3 Release Series &mdash; Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 4.3 Release Series<br />Changes, New Features, and Fixes</h1>

<h2>Caveats</h2>

  <ul>
    <li id="mpfrcaveats">GCC requires the <a
    href="http://www.swox.com/gmp/">GMP</a> and <a
    href="http://www.mpfr.org/">MPFR</a> libraries for building all
    the various front-end languages it supports.  See the <a
    href="http://gcc.gnu.org/install/prerequisites.html">prerequisites
    page</a> for version requirements.</li>

  </ul>

<h2>General Optimizer Improvements</h2>

  <ul>
    <li id="mpfropts">The GCC middle-end has been integrated with the
    <a href="http://www.mpfr.org/">MPFR</a> library.  This allows GCC
    to evaluate and replace at compile-time calls to built-in math
    functions having constant arguments with their mathematically
    equivalent results.  In making use of <a
    href="http://www.mpfr.org/">MPFR</a>, GCC can generate correct
    results regardless of the math library implementation or floating
    point precision of the host platform.  This also allows GCC to
    generate identical results regardless of whether one compiles in
    native or cross-compile configurations to a particular target.
    The following built-in functions take advantage of this new
    capability: <code>acos</code>, <code>acosh</code>,
    <code>asin</code>, <code>asinh</code>, <code>atan</code>,
    <code>atan2</code>, <code>atanh</code>, <code>cbrt</code>,
    <code>cos</code>, <code>cosh</code>, <code>erf</code>,
    <code>erfc</code>, <code>exp</code>, <code>exp10</code>,
    <code>exp2</code>, <code>expm1</code>, <code>fdim</code>,
    <code>fma</code>, <code>fmax</code>, <code>fmin</code>,
    <code>hypot</code>, <code>log</code>, <code>log10</code>,
    <code>log1p</code>, <code>log2</code>, <code>pow</code>,
    <code>pow10</code>, <code>sin</code>, <code>sincos</code>,
    <code>sinh</code>, <code>tan</code>, <code>tanh</code> and
    <code>tgamma</code>.  The <code>float</code> and <code>long
    double</code> variants of these functions (e.g. <code>sinf</code>
    and <code>sinl</code>) are also handled.  The <code>sqrt</code>
    and <code>cabs</code> functions with constant arguments were
    already optimized in prior GCC releases.  Now they also use <a
    href="http://www.mpfr.org/">MPFR</a>. </li>

    <li>A new <em>forward propagation</em> pass on RTL was added.  The new pass
      replaces several slower transformations, resulting in compile-time
      improvements as well as better code generation in some cases.</li>

    <li> A new command line switch <code>-frecord-gcc-switches</code> has been
    added to GCC, although it is only enabled for some targets.  The switch
    causes the command line that was used to invoke the compiler to be recorded
    into the object file that is being created.  The exact format of this
    recording is target and binary file format dependent, but it usually takes
    the form of a note section containing ASCII text.  The switch is related to
    the <code>-fverbose-asm</code> switch, but that one only records the
    information in the assembler output file as comments, so the information
    never reaches the object file.
    </li>

    <li>The inliner heuristic is now aware of stack frame consumption.  New
    command line parameters <code>--param large-stack-frame</code>
    and <code>--param large-stack-frame-growth</code>
    can be used to limit stack frame size growth caused by inlining.</li>

    <li>During feedback directed optimizations, the expected block size
    the <code>memcpy</code>, <code>memset</code> and <code>bzero</code>
    functions operate on is discovered and for cases of commonly used small
    sizes, specialized inline code is generated.</li>

    <li><code>__builtin_expect</code> no longer requires its argument to be
    a compile time constant.</li>

  </ul>

  <ul>
    <li>A new internal representation for GIMPLE statements has been
      contributed, resulting in compile-time memory savings.</li>
  </ul>

<h2>New Languages and Language specific improvements</h2>

<h3>C family</h3>

  <ul>
    <li>
    Implicit conversions between generic vector types are now
    only permitted when the two vectors in question have the same number
    of elements and compatible element types.  (Note that the restriction
    involves <em>compatible</em> element types, not
    implicitly-convertible element types: thus, a vector type with element
    type <code>int</code> may not be implicitly converted to a vector
    type with element type <code>unsigned int</code>.)
    This restriction, which is in line with specifications for SIMD
    architectures such as AltiVec, may be relaxed using the
    flag <code>-flax-vector-conversions</code>.
    This flag is intended only as a compatibility measure and should not
    be used for new code.
    </li>
    <li>
      <code>-Warray-bounds</code> has been added and is now enabled by
      default for <code>-Wall</code> . It produces warnings for array
      subscripts that can be determined at compile time to be always 
      out of bounds. <code>-Wno-array-bounds</code> will disable the
      warning.
    </li>
  </ul>

<h3>C++</h3>
  <ul>
    <li>Experimental support for the upcoming ISO C++ standard, C++0x,
  has been added. This support can be enabled with the
  <code>-std=c++0x</code> or <code>-std=gnu++0x</code> compiler
  options. The following C++0x features are enabled by this
  experimental mode: 
  <ul>
    <li><a
  href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1720.html">Static
  assertions</a></li>
    <li><a
  href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1653.htm">C99
  preprocessor</a></li>
  </ul>
  </li>

  <li>The <code>-Wparentheses</code> option now works for C++ as it
  does for C.  It warns if parentheses are omitted when operators with
  confusing precedence are nested.  It also warns about ambiguous else
  statements.  Since <code>-Wparentheses</code> is enabled by
  <code>-Wall</code>, this may cause additional warnings with existing
  C++ code which uses <code>-Wall</code>.  These new warnings may be
  disabled by using <code>-Wall -Wno-parentheses</code>.</li>

  <li>The <code>-Wmissing-declarations</code> now works for C++ as it
  does for C.</li>

  </ul>
  
<h3>Fortran</h3>
  <ul>

    <li>Due to the fact that the <a
    href="http://www.swox.com/gmp/">GMP</a> and <a
    href="http://www.mpfr.org/">MPFR</a> libraries are required for
    all languages, Fortran is no longer special in this regard and is
    available by default.</li>

    <li>The <code>
    <a href="http://gcc.gnu.org/onlinedocs/gfortran/Code-Gen-Options.html#Code-Gen-Options"
    >-fexternal-blas</a></code> option has been added, which
    generates calls to BLAS routines for intrinsic matrix operations such
    as <code>matmul</code> rather than using the built-in algorithms.</li>
    <li>Fortran 2003 support has been extended:
    <ul>
      <li>Intrinsic statements <code>VOLATILE</code> and <code>IMPORT</code></li>
      <li>Intrinsic module <code>ISO_ENV_FORTRAN</code></li>
    </ul></li>
  </ul>

<h3>Java (GCJ)</h3>

  <ul>

     <li> gcj now uses the Eclipse Java compiler for its Java parsing
     needs.  This enables the use of all 1.5 language features, and
     fixes most existing front end bugs. </li>

     <li> libgcj now supports all 1.5 language features which require
     runtime support: foreach, enum, annotations, generics, and
     auto-boxing.  </li>

     <li id="gcjtools"> The old <code>jv-scan</code> tool has been
     removed.  <code>gcjh</code> has been replaced by the new
     <code>gjavah</code>, which has similar functionality but
     different command line options.  <code>grmic</code> and
     <code>grmiregistry</code> have been rewritten.  The new tools
     <code>gjar</code>, <code>gorbd</code>, <code>grmid</code>,
     <code>gserialver</code>, <code>gtnameserv</code> are now
     installed. </li>

  </ul>

<h2>New Targets and Target Specific Improvements</h2>

<h3>IA-32/x86-64</h3>
  <ul>
    <li>Tuning for Intel Core 2 processors is available via
        <code>-mtune=core2</code> and <code>-march=core2</code>.</li>
    <li>Tuning for AMD Geode processors is available via
        <code>-mtune=geode</code> and <code>-march=geode</code>.</li>
    <li>Code generation of block move (<code>memcpy</code>) and block set
	(<code>memset</code>) was rewritten.  GCC can now pick the best
        algorithm (loop, unrolled loop, instruction with <code>rep</code>
        prefix or a library call) based on the size of the block being
        copied and the CPU being optimized for.  A new option
        <code>-minline-stringops-dynamically</code> has been added.  With
        this option string operations of unknown size are expanded such
        that small blocks are copied by in-line code, while for
	large blocks a library call is used.  This results in faster code than
	<code>-minline-all-stringops</code> when the library implementation is
	capable of using cache hierarchy hints.  The heuristic choosing
	the particular algorithm can be overwritten via
	<code>-mstringop-strategy</code>.  Newly also <code>memset</code> of
	values different from 0 is inlined.</li>
    <li>GCC no longer places the <code>cld</code> instruction before string
	operations.  Both i386 and x86-64 ABI documents mandate the direction
	flag to be clear at the entry of a function.  It is now invalid to
	set the flag in <code>asm</code> statement without reseting it
	afterward.</li>
    <li>Support for SSSE3 built-in functions and code generation are
	available via <code>-mssse3</code>.</li>
  </ul>

<h3>ARM</h3>
  <ul>
    <li>Compiler and Library support for Thumb-2 and the ARMv7
        architecture has been added.</li>
  </ul>

<h3>SPU (Synergistic Processor Unit) of the Cell Broadband Engine
    Architecture (BEA)</h3>
  <ul>
    <li>Support has been added for this new architecture.</li>
  </ul>


<h2>Documentation improvements</h2>

<h2>Other significant improvements</h2>

</body>
</html>
