<html>

<head>
<title>Rolling a GCC Release</title>
</head>

<body>
<h1>Rolling a GCC Release</h1>

<h2>Preparations</h2>

<ol start="1">
<li>Before rolling the release, update the release notes web pages and
ensure that they are all listed in <code>contrib/gennews</code>.
If using an overall announcement page for
successive minor releases, as with GCC 3.0, this should note the new
release without removing information about any previous minor releases
in that series, and the <code>features.html</code> page for that
release series should have details added of the changes in each minor
release.</li>

<li>Warn developers to abstain from checking in any code on the
release branch.</li>

<li><a href="translation.html#collect">Check for new message
translations</a> and commit them to the release branch (and to
mainline if it is the most recent release branch).  <a
href="translation.html#regen">Regenerate
<code>gcc.pot</code></a>.</li>
</ol>


<h2>Generation and Upload</h>

<ol start="4">
<li>Roll the release using the
<code>maintainer-scripts/gcc_release</code> script from the same
branch as the release.  You must pass the <code>-f</code> option, to
indicate a final release, the <code>-r</code> option (for example,
<code>-r 3.1</code>), to give the release version, and, if diffs
against a previous release are to be generated, the <code>-p</code>
option, whose argument must name the <code>.tar.gz</code> file for a
previous release, in a directory containing all the
<code>.tar.gz</code> files for that previous release (for example,
<code>-p /some/where/gcc-3.1/gcc-3.1.tar.gz</code>, where there are
also files such as <code>/some/where/gcc-3.1/gcc-core-3.1.tar.gz</code>).</li>

<li>Upload the release to <code>ftp.gnu.org</code>.</li>

<li>Update <code>~ftp/pub/gcc/releases/index.html</code>.</li>
</ol>


<h2>Web Site Updates</h2>

<ol start="7">
<li>Update the <code>releases.html</code> and <code>develop.html</code>
web pages.</li>

<li>Update the version numbers of the current and future releases on
the main web page, and add a proper news item there as well.</li>

<li>Add the release tag to the list in <code>cvs.html</code> (the
branch tag should already be there).</li>

<li>For a new major release, ensure that the build status page is
present.</li>

<li>Generate online documentation for the new release with
<code>update_web_docs</code> and link to it from
<code>onlinedocs/index.html</code> (but don't break URLs to
documentation for previous releases even if you remove the links to
it).  The appropriate command to run (as gccadmin) to generate the
documentation would be <code>scripts/update_web_docs
-rgcc_3_0_2_release -dgcc-3.0.2</code> (with the current version
number inserted).</li>
</ol>


<h2>Announcements</h2>

<ol start="12">
<li>Announce the release to the gcc-announce@gcc.gnu.org and gcc@gcc.gnu.org
mailing lists.
<ul>
<li>Make sure that most mirrors have retrieved the new release already.</li>
<li>In the case of a major release, coordinate announcements with the
FSF.</li>
</ul></li>

<li>Increment the version number in <code>gcc/version.c</code>, and
put back the date stamp and (prerelease) annotation.  Increment the
version number in <code>doc/include/gcc-common.texi</code>.</li>

<li>Notify developers that checkins to the branch are once again
allowed.</li>
</ol>


<h2>Bugzilla Updates</h2>

<ol start="15">
<li>Create a new version in Bugzilla corresponding to the new branch
version.  This can be accomplished by choosing products, choosing gcc,
and editing the versions.  Please do <strong>not</strong> delete old 
versions.</li>

<li>Create a new target milestone in Bugzilla corresponding to the dot
release after the immediate next (for example create a milestone for
3.3.3 after releasing 3.3.1, so we can slip the milestone for PRs that
can't be fixed in time for 3.3.2).  This can be accomplished by
choosing products, choosing gcc, and editing the target milestones.
Please do <strong>not</strong> delete old target milestones.</li>

<li>Change all open bugs targeted at the just released milestone to be targeted
at either the mainline version milestone, or the next point-release milestone.
This can be accomplished by querying for all bugs targeted at the old
milestone, choosing "Change several bugs at once" at the bottom of the
buglist screen, choosing "check all" to select all bugs to change, 
choosing the new target milestone from the drop down, entering a
useful comment, and clicking commit. </li>

<li>Update the email parsing script to handle bugs against the new versions.
The script is in CVS at <code>wwwdocs/bugzilla/contrib/bug_email.pl</code>. 
Search for an existing version (like "3.3"), and update both places
it occurs to handle the new version through copy and paste.</li>
</ol>

</body>
</html>
