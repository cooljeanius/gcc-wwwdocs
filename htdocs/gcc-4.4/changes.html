<html>

<head>
<title>GCC 4.4 Release Series &mdash; Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 4.4 Release Series<br />Changes, New Features, and Fixes</h1>

<h2>Caveats</h2>

  <ul>
    <li><code>__builtin_stdarg_start</code> has been completely
    removed from GCC.  Support for <code>&lt;varargs.h&gt;</code> had
    been deprecated since GCC 4.0.  Use
    <code>__builtin_va_start</code> as a replacement.  </li>

    <li>Some of the errors issued by the C++ front end that could be
    downgraded to warnings in previous releases by using
    <code>-fpermissive</code> are now warnings by default. They can be
    converted into errors by using <code>-pedantic-errors</code>.</li>

    <li>Use of the cpp assertion extension will now emit a warning
    when <code>-Wdeprecated</code> or <code>-pedantic</code> is used.
    This extension has been deprecated for many years, but never
    warned about.</li>

    <li>The MIPS port no longer recognizes the <code>h</code>
    <code>asm</code> constraint.  It was necessary to remove
    this constraint in order to avoid generating unpredictable
    code sequences.

    <p>One of the main uses of the <code>h</code> constraint
    was to extract the high part of a multiplication on
    64-bit targets.  For example:</p>
    <pre>
    asm ("dmultu\t%1,%2" : "=h" (result) : "r" (x), "r" (y));</pre>
    <p>You can now achieve the same effect using 128-bit types:</p>
    <pre>
    typedef unsigned int uint128_t __attribute__((mode(TI)));
    result = ((uint128_t) x * y) >> 64;</pre>
    <p>The second sequence is better in many ways.  For example,
    if <code>x</code> and <code>y</code> are constants, the
    compiler can perform the multiplication at compile time.
    If <code>x</code> and <code>y</code> are not constants,
    the compiler can schedule the runtime multiplication
    better than it can schedule an <code>asm</code> statement.</p>
    </li>

    <li><p>Support for a number of older systems and recently
    unmaintained or untested target ports of GCC has been declared
    obsolete in GCC 4.4.  Unless there is activity to revive them, the
    next release of GCC will have their sources permanently
    <strong>removed</strong>.</p>

    <p>The following ports for individual systems on particular
    architectures have been obsoleted:</p>

    <ul>
      <li>Generic a.out on IA32 and m68k (i[34567]86-*-aout*,
        m68k-*-aout*)</li>
      <li>Generic COFF on ARM, H8300, IA32, m68k and SH (arm-*-coff*,
        armel-*-coff*, h8300-*-*, i[34567]86-*-coff*, m68k-*-coff*,
        sh-*-*).  This does not affect other more specific targets
        using the COFF object format on those architectures, or the
        more specific H8300 and SH targets (h8300-*-rtems*,
        h8300-*-elf*, sh-*-elf*, sh-*-symbianelf*, sh-*-linux*,
        sh-*-netbsdelf*, sh-*-rtems*, sh-wrs-vxworks).</li>
      <li>IRIX on MIPS (mips-sgi-irix[56]*)</li>
      <li>2BSD on PDP-11 (pdp11-*-bsd)</li>
      <li>AIX 4.1 and 4.2 on PowerPC (rs6000-ibm-aix4.[12]*,
        powerpc-ibm-aix4.[12]*)</li>
    </ul>

    </li>

    <li>The <code>protoize</code> and <code>unprotoize</code>
    utilities have been obsoleted and will be removed in GCC 4.5.
    These utilities have not been installed by default since GCC
    3.0.</li>

 </ul>

<h2>General Optimizer Improvements</h2>

  <ul>
    <li>A new command-line switch <code>-ftree-switch-conversion</code> has
      been added.  This new pass turns simple initializations of scalar
      variables in switch statements into initializations from a static array,
      given that all the values are known at compile time and the ratio between
      the new array size and the original switch branches does not exceed 
      the parameter <code>--param switch-conversion-max-branch-ratio</code> 
      (default is eight).  </li>
  </ul>

<h2>New Languages and Language specific improvements</h2>

<h3>C family</h3>

  <ul>
    <li>A new <code>optimize</code> attribute was added to allow programmers to
    change the optimization level and particular optimization options for an
    individual function.  You can also change the optimization options via the
    <code>GCC optimize</code> pragma for functions defined after the pragma.
    The <code>GCC push_options</code> pragma and the
    <code>GCC pop_options</code> pragma allow you temporarily save and restore
    the options used.  The <code>GCC reset_options</code> pragma restores the
    options to what was specified on the command line.
    </li>

  </ul>

<h3>C++</h3>
  <ul>
    <li><a href="cxx0x_status.html">Improved experimental support for the upcoming
    ISO C++ standard, C++0x</a>, including support for inline namespaces, generalized initializer lists, defaulted and deleted functions, and scoped enums.</li>

    <li> Those errors that may be downgraded to warnings to build
    legacy code now mention <code>-fpermissive</code> when
    <code>-fdiagnostics-show-option</code> is enabled.</li>

  </ul>
  
  <h4>Runtime Library (libstdc++)</h4>

<h3>Fortran</h3>
  <ul>
    <li>GNU Fortran now employs libcpp directly instead of using cc1 as an
    external preprocessor. The <a
    href="http://gcc.gnu.org/onlinedocs/gfortran/Preprocessing-Options.html">
    <code>-cpp</code></a> option was added to allow manual invocation of the
    preprocessor without relying on filename extensions.</li>

    <li>The <a
    href="http://gcc.gnu.org/onlinedocs/gfortran/Error-and-Warning-Options.html#Error-and-Warning-Options">
    <code>-Warray-temporaries</code></a> option warns about array temporaries
    generated by the compiler, as an aid to optimization.</li>
  </ul>

<h3>Java (GCJ)</h3>

<h2>New Targets and Target Specific Improvements</h2>

<h3>AVR</h3>
  <ul>
    <li>Added support for these new AVR devices:
      <ul>
        <li>ATtiny13A</li>
        <li>ATtiny167</li>
        <li>ATmega32C1</li>
        <li>ATmega32M1</li>
        <li>ATmega32U4</li>
      </ul>
    </li>
    <li>Removed support for the AVR device ATmega32HVB.</li>
  </ul>

<h3>IA-32/x86-64</h3>
  <ul>
    <li>Support for Intel AES built-in functions and code generation is
	available via <code>-maes</code>.</li>
    <li>Support for Intel PCLMUL built-in function and code generation is
	available via <code>-mpclmul</code>.</li>
    <li>Support for Intel AVX built-in functions and code generation is
	available via <code>-mavx</code>.</li>
    <li>Automatically align the stack for local variables with alignment
	requirement. </li>
    <li>GCC can now utilize the SVML library for vectorizing calls to
	a set of C99 functions if <code>-mveclibabi=svml</code> is specified
	and you link to an SVML ABI compatible library.</li>
    <li>A new <code>target</code> attribute was added to allow programmers to change the target options like <code>-msse2</code> or <code>-march=k8</code> for an individual function.  You can also change the target options via the <code>GCC target</code> pragma for functions defined after the pragma.</li>

  </ul>

<h3>MIPS</h3>
  <ul>
    <li><p>MIPS Technologies have extended the original MIPS SVR4 ABI
        to include support for procedure linkage tables (PLTs)
        and copy relocations.  These extensions allow GNU/Linux
        executables to use a significantly more efficient code
        model than the one defined by the original ABI.</p>

        <p>GCC support for this code model is available via a
        new command-line option, <code>-mplt</code>.  There is also
        a new configure-time option, <code>--with-mips-plt</code>,
        to make <code>-mplt</code> the default.</p>

        <p>The new code model requires support from the assembler,
        the linker, and the runtime C library.  This support is available
        in binutils 2.19 and GLIBC 2.9.</p></li>
    <li>GCC can now generate MIPS16 code for 32-bit GNU/Linux executables
        and 32-bit GNU/Linux shared libraries.  This feature requires
        GNU binutils 2.19 or above.</li>
    <li>Support for RMI's XLR processor is now available through the
        <code>-march=xlr</code> and <code>-mtune=xlr</code> options.</li>
    <li>64-bit targets can now perform 128-bit multiplications inline,
        instead of relying on a <code>libgcc</code> function.</li>
    <li>Native GNU/Linux toolchains now support <code>-march=native</code>
        and <code>-mtune=native</code>, which select the host processor.</li>
    <li>GCC can now work around the side effects of speculative execution
        on R10K processors.  Please see the documentation of the
        <code>-mr10k-cache-barrier</code> option for details.</li>
  </ul>

<h3 id="picochip">picochip</h3>

  <p>Picochip is a 16-bit processor.  A typical picoChip contains over 250
  small cores, each with small amounts of memory. There are three processor
  variants (STAN, MEM and CTRL) with different instruction sets and memory
  configurations and they can be chosen using the <code>-mae</code> option.
  </p>

  <p>This port is intended to be a "C" only port.</p>


<h2>Documentation improvements</h2>

<h2>Other significant improvements</h2>

</body>
</html>
