<?php // -*-php-*- ?>
<!-- $Id: actionbar.tmpl,v 1.2 2005/01/25 07:20:56 rurban Exp $ -->
<?php
  if (!$page->get('locked') || $user->isAdmin() and $revision)
      $EditB = Button("edit",
                      $revision->isCurrent() ? _("Edit") : _("Edit Old Revision"));
  else
      $EditB = Button("viewsource", _("View Source"));
$Sep = HTML::raw('<li>');
$dbh = $request->getDbh();
?>
<div id="p-cactions" class="portlet">
    <h5>Views</h5>
    <ul>
    <? if ( $user->isSignedIn() ) { ?>
     <?= $EditB ?>
     <?php if ($user->isAdmin() or mayAccessPage('change',$page->getName())) { ?>
      <?=$Sep?><?= Button($page->get('locked') ? 'unlock' : 'lock') ?>
      <?php if (ENABLE_PAGEPERM) { ?>
        <?=$Sep?><?= Button('chown') ?>
        <?=$Sep?><?= Button('setacl') ?>
     <?php }} ?>
     <?php if ($user->isAdmin() or mayAccessPage('remove',$page->getName())) { ?>
      <?=$Sep?><?= Button('remove') ?>
     <?php } ?>
    <?php } ?>
    <?=$Sep?><?= Button(array('action'=>$dbh->isWikiPage('Talk:'.$page->getName()) ? 'browse' : 'create', 
                              'template'=>'TemplateTalk'),
                        _("Discussion"),'Talk:'.$page->getName()) ?>
    <?=$Sep?><?= Button(array('action'=>'PageInfo'),
                        _("Info"),$page->getName()) ?>
<?php if (((defined('DEBUG') and DEBUG and $request->getArg('action') == 'browse')) || $user->isAdmin()) { ?> 
      <!-- Buttons really only for debugging -->
      <?=$Sep?><?= Button(_("PageHistory")) ?>
      <?=$Sep?><?= Button("diff") ?> 
      <?=$Sep?><?= Button(_("PageDump")) ?>
<?php
     $PurgeCache = Button(array('nocache' => 'purge'),
                     _("PurgeHtmlCache"), $page->getName());
     $PurgeCache->addTooltip(_("Purge HTML cache for this page. Regenerate from WikiMarkup when next accessed."));
?>
    <?=$Sep?><?= $PurgeCache ?>
    <!-- End debugging buttons -->
    <?php } ?>
  </div>
