<html>
<head>
<title>How to build GCJ/LIBGCJ from snapshots or cvs</title>
</head>
<body bgcolor="white" text="black" link="#0000EE" VLINK="#551A8B" ALINK="red">

<body bgcolor="#FFFFFF">

<table border="0" cellpadding="4" width="95%">
        <tr bgcolor="#b0d0ff"> 
          <th align="center"> 
            <h2>Howto build and run libgcj/gcj snapshots or cvs</a>
          </th>
        </tr>


<tr bgcolor="cccccc">
<td>
<pre>
General gcj download information can be found <A HREF="download.html">here</A>.

1a. Get a GCC snapshots from:

  <a href="http://gcc.gnu.org/snapshots.html">ftp://ftp.freesoftware.com/pub/sourceware/gcc/snapshots/</a>

They are made about once a week. 

1b. Or get GCC from cvs, see

  <a href="http://gcc.gnu.org/cvs.html">http://gcc.gnu.org/cvs.html</a>

Where ever you get GCC from, you also get Libgcj. There is no need for
you get Libgc from an other cvs or snapshot repository.
</pre>

</td>
</tr>

<tr bgcolor="dddddd">
<td>
<pre>
2. Make a compile directory

  $ mkdir compile
</pre>
</td>
</tr>

<tr bgcolor="cccccc">
<td>
<pre>
3. Move the snapshot into the compile dir, e.g.

  $ cd compile
  $ mv ../egcs-20001211.tar.gz .
  $ gunzip *.gz
  $ tar xfv *.tar
  $ ln -s egcs-20001211 egcs
</pre>
</td>
</tr>

<tr bgcolor="dddddd">
<td>
<pre>
4. Tell the build system you want to build libgcj

  Have a look at the toplevel configure.in (egcs/configure.in) and
  make sure that the variable `noconfigdirs' isn't assigned to
  something (like target-libjava or ${libgcj}.)
<br>
  Also, check for platform-specific assignments of `noconfigdirs' with
  ${libgcj}; if ${libgcj} is listed for your platform, remove it before
  configuring.
</pre></td></tr>

<tr bgcolor="cccccc">
<td>
<pre>
5. Compile and install egcs/gcj/libgcj

  $ cd egcs
  $ mkdir objdir
  $ cd objdir
  $ ../configure --enable-threads=posix --prefix=/home/joerg/gcc \
    --enable-shared --enable-languages=c++,java --disable-new-gxx-abi \
    --with-as=/opt/gnu/bin/as --with-ld=/opt/gnu/bin/ld
  $ make bootstrap
  $ make
  $ make install

The "--disable-new-gxx-abi" is still required to build libgcj, until
Java gets compatible with the new C++ ABI.

The Boehm GC is the collector picked up by default.

If you compile under Linux you could omit the last two options. Under
Solaris you'll need them. If you omit '--prefix' the compiled source
will be installed under /usr/local. For more information about
installing egcs and/or configuration options see:

  <a href="http://gcc.gnu.org/install/index.html">http://gcc.gnu.org/install/index.html</a>

If you have a broken gas/bin-utils (such as Debian potato) then you
want to edit the auto-host.h file and remove the definition of
HAVE_GAS_HIDDEN after configuring, but before typeing make.  See
<a href=faq.html#5_7>the FAQ</a> for more information.
</pre>
</td>
</tr>

<tr bgcolor="dddddd">
<td>
<pre>
6. Adjust your environment

Reflect your choice of --prefix value to your environment. It depends
on which shell you're running. For csh compatible shells, edit a file
env.csh:

setenv PATH /home/joerg/gcc/bin:$PATH
setenv LD_LIBRARY_PATH /home/joerg/gcc/lib

  $ source env.csh
</pre>
</td>
</tr>

<tr bgcolor="cccccc">
<td>
<pre>
7. Edit a file HelloWorld.java

  public class HelloWorld {
    public static void main(String [] args) {
      System.out.println("Hello");
    }
  }
</pre>
</td>
</tr>

<tr bgcolor="dddddd">
<td>
<pre>
8. Compile and run HelloWorld

 $ gcj --main=HelloWorld -o HelloWorld HelloWorld.java
 $ ./HelloWorld
</pre>
</td>
</tr>

</table>


</body>
</html>

