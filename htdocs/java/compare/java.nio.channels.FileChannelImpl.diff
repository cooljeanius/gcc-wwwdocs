--- /home/tromey/gnu/Nightly/classpath/classpath/java/nio/channels/FileChannelImpl.java	2003-07-13 23:56:27.000000000 -0600
+++ java/nio/channels/FileChannelImpl.java	2003-08-03 02:17:56.000000000 -0600
@@ -47,7 +47,7 @@
 import java.nio.ByteBuffer;
 import java.nio.MappedByteBuffer;
 import java.nio.MappedByteBufferImpl;
-import gnu.classpath.RawData;
+import gnu.gcj.RawData;
 
 /**
  * This file is not user visible !
@@ -146,6 +146,7 @@
     long oldPosition;
 
     oldPosition = implPosition ();
+    position (position);
     result = implRead (dst);
     implPosition (oldPosition);
     
@@ -208,6 +209,7 @@
     long oldPosition;
 
     oldPosition = implPosition ();
+    position (position);
     result = implWrite (src);
     implPosition (oldPosition);
     
@@ -298,6 +300,7 @@
     // XXX: count needs to be casted from long to int. Dataloss ?
     ByteBuffer buffer = ByteBuffer.allocate ((int) count);
     read (buffer, position);
+    buffer.flip();
     return target.write (buffer);
   }
 
@@ -317,6 +320,7 @@
     // XXX: count needs to be casted from long to int. Dataloss ?
     ByteBuffer buffer = ByteBuffer.allocate ((int) count);
     src.read (buffer);
+    buffer.flip();
     return write (buffer, position);
   }
 
