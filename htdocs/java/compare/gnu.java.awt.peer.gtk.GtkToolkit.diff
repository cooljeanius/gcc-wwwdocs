--- /home/tromey/gnu/Nightly/classpath/classpath/gnu/java/awt/peer/gtk/GtkToolkit.java	2004-01-26 02:24:04.000000000 -0700
+++ gnu/java/awt/peer/gtk/GtkToolkit.java	2004-01-11 02:18:04.000000000 -0700
@@ -53,6 +53,9 @@
 import java.util.Map;
 import java.util.MissingResourceException;
 import java.util.Properties;
+import gnu.java.awt.EmbeddedWindow;
+import gnu.java.awt.EmbeddedWindowSupport;
+import gnu.java.awt.peer.EmbeddedWindowPeer;
 import gnu.java.awt.peer.ClasspathFontPeer;
 import gnu.classpath.Configuration;
 import gnu.java.awt.peer.gtk.GdkPixbufDecoder;
@@ -73,6 +76,7 @@
  */
 
 public class GtkToolkit extends gnu.java.awt.ClasspathToolkit
+  implements EmbeddedWindowSupport
 {
   GtkMainThread main;
   Hashtable containers = new Hashtable();
@@ -111,15 +115,7 @@
   public int checkImage (Image image, int width, int height, 
 			 ImageObserver observer) 
   {
-    int status = ((GtkImage) image).checkImage ();
-
-    if (observer != null)
-      observer.imageUpdate (image, status,
-                            -1, -1,
-                            image.getWidth (observer),
-                            image.getHeight (observer));
-
-    return status;
+    return ((GtkImage) image).checkImage ();
   }
 
   public Image createImage (String filename)
@@ -170,18 +166,12 @@
 
   public Image getImage (String filename) 
   {
-    GdkPixbufDecoder d = new GdkPixbufDecoder (filename);
-    GtkImage image = new GtkImage (d, null);
-    d.startProduction (image);
-    return image;
+    return new GtkImage (new GdkPixbufDecoder (filename), null);
   }
 
   public Image getImage (URL url) 
   {
-    GdkPixbufDecoder d = new GdkPixbufDecoder (url);
-    GtkImage image = new GtkImage (d, null);
-    d.startProduction (image);
-    return image;
+    return new GtkImage (new GdkPixbufDecoder (url), null);
   }
 
   public PrintJob getPrintJob (Frame frame, String jobtitle, Properties props) 
@@ -353,6 +343,11 @@
     return new GtkWindowPeer (w);
   }
 
+  public EmbeddedWindowPeer createEmbeddedWindow (EmbeddedWindow w)
+  {
+    return new GtkEmbeddedWindowPeer (w);
+  }
+
   /** 
    * @deprecated part of the older "logical font" system in earlier AWT
    * implementations. Our newer Font class uses getClasspathFontPeer.
