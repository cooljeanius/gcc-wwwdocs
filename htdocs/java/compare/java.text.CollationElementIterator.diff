--- /home/tromey/gnu/Nightly/classpath/classpath/java/text/CollationElementIterator.java	2003-10-16 02:19:33.000000000 -0600
+++ java/text/CollationElementIterator.java	2003-10-16 02:17:56.000000000 -0600
@@ -65,17 +65,21 @@
   /**
    * This is the RuleBasedCollator this object was created from.
    */
-  private RuleBasedCollator collator;
+  RuleBasedCollator collator;
 
   /**
    * This is the String that is being iterated over.
    */
-  private String text;
+  String text;
 
   /**
    * This is the index into the String where we are currently scanning.
    */
-  private int index;
+  int index;
+
+  // A piece of lookahead.
+  boolean lookahead_set;
+  int lookahead;
 
   /**
    * This method initializes a new instance of <code>CollationElementIterator</code>
@@ -103,9 +107,7 @@
     if (index == text.length())
       return NULLORDER;
 
-    String s = text.charAt (index) + "";
-    index++;
-    return collator.getCollationElementValue (s);
+    return collator.ceiNext (this);
   }
 
   /**
@@ -170,29 +172,9 @@
   public void setText (String text)
   {
     this.text = text;
-    index = 0;
-  }
-
-  /**
-   * This method sets the <code>String</code> that it is iterating over
-   * to the <code>String</code> represented by the specified
-   * <code>CharacterIterator</code>.
-   *
-   * @param ci The <code>CharacterIterator</code> containing the new <code>String</code> to iterate over.
-   */
-  public void setText (CharacterIterator ci)
-  {
-    // For now assume we read from the beginning of the string.
-    char c = ci.first();
-    StringBuffer sb = new StringBuffer ("");
-
-    while (c != CharacterIterator.DONE)
-      {
-        sb.append (c);
-        c = ci.next();
-      }
-
-    setText (sb.toString());
+    this.index = 0;
+    this.lookahead_set = false;
+    this.lookahead = 0;
   }
 
   /**
@@ -208,59 +190,5 @@
     return index;
   }
 
-  /**
-   * This method sets the iteration index position into the current
-   * <code>String</code> to the specified value.  This value must not
-   * be negative and must not be greater than the last index position
-   * in the <code>String</code>.
-   *
-   * @param offset The new iteration index position.
-   *
-   * @exception IllegalArgumentException If the new offset is not valid.
-   */
-  public void setOffset (int offset)
-  {
-    if (offset < 0)
-      throw new IllegalArgumentException ("Negative offset: " + offset);
-
-    if ((text.length () > 0) && (offset > 0))
-      throw new IllegalArgumentException ("Offset too large: " + offset);
-    else if (offset > (text.length () - 1))
-      throw new IllegalArgumentException ("Offset too large: " + offset);
-
-    index = offset;
-  }    
-
-  /**
-   * This method returns the maximum length of any expansion sequence that
-   * ends with the specified collation order value.  (Whatever that means).
-   *
-   * @param value The collation order value
-   *
-   * @param The maximum length of an expansion sequence.
-   */
-  public int getMaxExpansion (int value)
-  {
-    //************ Implement me!!!!!!!!!
-    return 5;
-  }
-
-  /**
-   * This method returns the collation ordering value of the previous character
-   * in the string.  This method will return <code>NULLORDER</code> if the
-   * beginning of the string was reached.
-   *
-   * @return The collation ordering value.
-   */
-  public int previous()
-  {
-    --index;
-    if (index < 0)
-      return NULLORDER;
-
-    String s = text.charAt (index) + "";
-    return collator.getCollationElementValue (s);
-  }
-
 } // class CollationElementIterator
 
