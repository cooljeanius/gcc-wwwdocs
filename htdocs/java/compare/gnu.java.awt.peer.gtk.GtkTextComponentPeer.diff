--- /home/tromey/gnu/Nightly/classpath/classpath/gnu/java/awt/peer/gtk/GtkTextComponentPeer.java	2003-07-10 02:18:54.000000000 -0600
+++ gnu/java/awt/peer/gtk/GtkTextComponentPeer.java	2003-07-14 02:18:13.000000000 -0600
@@ -57,32 +57,14 @@
   }
   
   public native int getCaretPosition ();
-  public void setCaretPosition (int pos)
-  {
-    set ("text_position", pos);
-  }
+  public native void setCaretPosition (int pos);
   public native int getSelectionStart ();
   public native int getSelectionEnd ();
   public native String getText ();
   public native void select (int start, int end);
-
-  public void setEditable (boolean state)
-  {
-    set ("editable", state);
-  }
-
+  public native void setEditable (boolean state);
   public native void setText (String text);
-
-  public void getArgs (Component component, GtkArgList args)
-  {
-    super.getArgs (component, args);
-
-    TextComponent tc = (TextComponent) component;
-
-    args.add ("text_position", tc.getCaretPosition ());
-    args.add ("editable", tc.isEditable ());
-  }
-
+  
   public int getIndexAtPoint(int x, int y)
   {
     return 0;  // FIXME
@@ -97,4 +79,21 @@
   {
     return filter;  // FIXME
   }
+
+  protected void postTextEvent ()
+  {
+    q.postEvent (new TextEvent (awtComponent, TextEvent.TEXT_VALUE_CHANGED));
+  }
+
+  public void handleEvent (AWTEvent e)
+  {
+    if (e.getID () == KeyEvent.KEY_TYPED
+        && ((TextComponent)e.getSource()).isEditable())
+      {
+        KeyEvent ke = (KeyEvent)e;
+
+        if (!ke.isConsumed())
+          postTextEvent ();
+      }
+  }
 }
