<html>
<head>
<title>The GCJ FAQ</title>
</head>
<!--#include virtual="/include/header-subpages.html"-->
<body bgcolor="#FFFFFF">
<table border=0>
  <tr>
    <td valign="top"> 
      <table border=0>
        <tr>
          <td> <img src="gcj.jpg" alt="gcj logo" width=136 height=98> </td>
        </tr>
        <tr> 
          <td> <br>
            <table border=0>
              <tr>
                <td width="10"></td>
                <td> <a href="index.html">Home</a><br>
                  <a href="faq.html">FAQ</a><br>
                  <a href="mail.html">Mailing Lists</a><br>
                  <a href="docs.html">Documentation</a><br>
                  <a href="download.html">Download</a><br>
                  <a href="contrib.html">Contributing</a><br>
                  <a href="http://sourceware.cygnus.com/cgi-bin/gnatsweb.pl?user=guest&password=guest&database=java&cmd=login">Bugs</a><br>
                  <a href="thanks.html">Thanks</a><br>
                  <!-- <a href="support.html">Support</a><br> --> <br>
                  <br>
                  <br>
                  <a href="http://egcs.cygnus.com">GCC</a><br>
                  <a href="http://sourceware.cygnus.com/mauve">The Mauve Project</a><br>
                  <a href="http://sourceware.cygnus.com">Sourceware</a><br>
                  <a href="http://www.gnu.org">The GNU Project</a><br>
                  <a href="http://www.cygnus.com">Cygnus Solutions</a><br>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </td>
    <td width=2 bgcolor="black"> i </td>
    <td width=6> </td>
    <td> <br>
      <br>
      <h1>The GCJ FAQ</h1>
      <p>The latest version of this document is always available at <a href="faq.html">http://sourceware.cygnus.com/java/faq.html</a>.</p>
      <ol>
        <li><a href="#1_0">General Questions</a> 
          <ol>
            <li><a href="#1_1">What license is used for libgcj?</a> 
            <li><a href="#1_2">How can I report a bug in libgcj?</a> 
            <li><a href="#1_3">How can I contribute to libgcj?</a> 
            <li><a href="#1_4">Why isn't libgcj part of GCC?</a> 
            <li><a href="#1_5">Will gcj and libgcj work on my machine?</a> 
            <li><a href="#1_6">How can I debug my Java program?</a> 
          </ol>
        <li><a href="#2_0">Java Feature Support</a> 
          <ol>
            <li><a href="#2_1">What Java API's are supported? How complete is 
              the support? </a></li>
            <li><a href="#2_2">Does GCJ support using straight C native methods 
              ala JNI? CNI looks kind of hard to use.</a></li>
            <li><a href="#3_3">Why does GCJ use CNI? </a></li>
            <li><a href="#2_3">What is the state of AWT support?</a></li>
            <li><a href="#2_4">How about support for Swing ?</a></li>
            <li><a href="#2_5">What support is there for RMI ?</a></li>
            <li><a href="#2_6">Can I use any code from other OpenSource projects 
              to supplement libgcj's current features ?</a></li>
            <li><a href="#2_7">What features of the Java language are/arn't supported</a></li>
          </ol>
        <li><a href="#2_0">Build Issues</a> 
          <ol>
            <li><a href="#3_2">Linker bug on Solaris</a> 
          </ol>
        <li><a href="#4_0">Gcj Compile/Link Questions</a> 
          <ol>
            <li><a href="#4_1">Why do I get <tt>undefined reference to `main'</tt> 
              errors?</a> 
            <li><a href="#4_2">4.2 Can GCJ only handle source code? </a> 
            <li><a href="#4_3">&quot;gcj -C" Doesnt seem to work like javac/jikes. 
              Whats going on? </a> 
            <li><a href="#4_4">Where does GCJ look for files? </a> 
            <li><a href="#4_4">How does gcj resolve wether to compile .class or 
              .java files? </a> 
            <li><a href="#4_5">How do I increase the runtime's initial and maximum 
              heap sizes? </a> 
          </ol>
        <li><a href="#5_0">Runtime Questions</a> 
          <ol>
            <li><a href="#5_1">My program is dumping core! What's going on?</a> 
            <li><a href="#5_2">When I run the debugger I get a SEGV in the GC! 
              What's going on?</a> 
            <li><a href="#5_3">Can I profile Garbage Collection? </a> 
            <li><a href="#5_4">How do I increase the runtime's initial and maximum 
              heap sizes?</a> 
            <li><a href="#5_5">How can I profile my application?</a> 
          </ol>
        <li><a href="#6_0">Programing Issues</a> 
          <ol>
            <li><a href="#6_1">Are there any examples of how to use CNI?</a></li>
          </ol>
        </li>
      </ol>
      <table border="0" cellpadding="4" width="95%">
        <tr bgcolor="#b0d0ff"> 
          <th align="left"> 
            <h2><a name="1_0">General Questions</a></h2>
          </th>
        </tr>
      </table>
      <br>
      <dl> 
        <dt> 
          <h3><a name="1_1">1.1 What license is used for libgcj?</a></h3>
        </dt>
        <p> 
        <dd>libgcj is distributed under the Library GPL.</dd>
        <p></p>
        <dt> 
          <hr>
          <h3><a name="1_2">1.2 How can I report a bug in libgcj?</a></h3>
        </dt>
        <p> 
        <dd>libgcj has a corresponding <a
      href="http://sourceware.cygnus.com/cgi-bin/gnatsweb.pl?user=guest&password=guest&database=java&cmd=login">Gnats 
          bug database</a> which you can browse. You can also submit new bug reports 
          from the Gnats page.</dd>
        <p></p>
        <dt> 
          <hr>
          <h3><a name="1_3">1.3 How can I contribute to libgcj?</a></h3>
        </dt>
        <p> 
        <dd>You can send simple bug fixes in as patches. Please follow the <a href="http://egcs.cygnus.com/contribute.html">GCC 
          guidelines for submitting patches</a>. For more complex changes, you 
          must sign copyright over to Cygnus. See the <a href="contrib.html">contribution</a> 
          page for details.</dd>
        <p></p>
        <dt> 
          <hr>
          <h3><a name="1_4">1.4 Why isn't libgcj part of GCC?</a></h3>
        </dt>
        <p> 
        <dd>Various minor reasons. It's likely that libgcj will end up in GCC 
          at some point in the future.</dd>
        <p></p>
        <dt> 
          <hr>
          <h3><a name="1_5">1.5 Will gcj and libgcj work on my machine?</a></h3>
        </dt>
        <p> 
        <dd>So far gcj and libgcj have only really been tried on Sparc Solaris 
          and x86 Linux. They might work on other systems, but we don't know. 
          Generally speaking, porting to a new system should not be hard. This 
          would be a good way to volunteer.</dd>
        <p></p>
        <dt> 
          <hr>
          <h3><a name="1_6">1.6 How can I debug my Java program?</a></h3>
        </dt>
        <p> 
        <dd><a href="ftp://ftp.gnu.org/pub/gnu/gdb/gdb-4.18.tar.gz">gdb 4.18</a> 
          includes support for debugging gcj-compiled Java programs. For linux, 
          you will need to use a recent development snapshot (link) of gdb, because 
          the standard 4.18 does not have support for linux threads.</dd>
        <dt>&nbsp; </dt>
      </dl>
      <table border="0" cellpadding="4" width="95%">
        <tr bgcolor="#B0D0FF"> 
          <th align="left"> 
            <h2>&nbsp;</h2>
            <h2><a name="2_0">Java Feature Support</a></h2>
          </th>
        </tr>
      </table>
      <dl> 
        <dd>&nbsp; </dd>
      </dl>
      <h3><a name="2_1">2.1 What Java API's are supported?</a> How complete is 
        the support?</h3>
      <dl> 
        <dd> <a href="mailto:mdw@cs.berkeley.edu">Matt Welsh</a> writes:</dd>
        <dl> 
          <dd>Just look in the 'libjava' directory of libgcj and see what classes 
            are there. Most GUI stuff isn't there yet, that's true, but many of 
            the other classes are easy to add if they don't yet exist. </dd>
          <dt>&nbsp;</dt>
          <dd>I think it's important to stress that there is a big difference 
            between Java and the many libraries which Java supports. Unfortunately, 
            Sun's promise of &quot;write once, run everywhere&quot; assumes much 
            more than a JVM: you also need the full set of JDK libraries. Considering 
            that new Java APIs come out every week, it's going to be impossible 
            to track everything. </dd>
          <dt>&nbsp;</dt>
          <dd>To make things worse, you can't simply run Sun's JDK classes on 
            any old JVM -- they assume that a bunch of native methods are also 
            defined. Since this native method requirement isn't defined by the 
            JDK specs, you're effectively constrained to using Sun's JVMs if you 
            want to use Sun's JDK libraries. Oh yes -- you could also reimplement 
            all of those native methods yourself, and make sure they behave exactly 
            as Sun's do. Note that they're undocumented! </dd>
        </dl>
        <dl> 
          <dt>&nbsp;</dt>
          <dd>&nbsp;</dd>
        </dl>
        <dt>&nbsp;</dt>
        <dd>To date Reflection is not supported, although all the required metadata 
          is included in Class.h.</dd>
        <dl> 
          <dd> 
            <dl> 
              <dt>&nbsp; </dt>
            </dl>
          </dd>
        </dl>
        <dl> 
          <dt> 
            <dl> 
              <dd></dd>
            </dl>
          </dt>
        </dl>
        <hr>
        <h3><a name="2_2">2.2 </a>Does GCJ support using straight C native methods 
          ala JNI? CNI looks kind of hard to use.</h3>
        <blockquote> 
          <p>Currently gcj does not support JNI, but this may change in the future. 
          </p>
          <p><a href="mailto:per@bothner.com">Per Bothner</a> explains the future 
            of these native interfaces:</p>
        </blockquote>
        <dl> 
          <blockquote> 
            <blockquote> 
              <p>(1) It is a goal that Gcj should support JNI as well as CNI. 
                Doing so is not in principle difficult, especially dealing with 
                JNI-using libraries that are known at link-time (since you can 
                just generate CNI wrapper functions that call the corresponding 
                JNI methods). However, there is still a for bit of tedious work 
                needed for JNI. </p>
              <p>(2) We do prefer CNI, as it is more efficient, easier to write, 
                and (at least potentially) easier to debug. </p>
              <p>(3) You could in principle write C++ code that implements both 
                a CNI and JNI interface, using the magic of pre-processing. The 
                question is whether we can do it in a way such that it would not 
                be simpler and cleaner to just maintain two copies of the code. 
                We don't know yet. </p>
            </blockquote>
          </blockquote>
          <dt> 
            <dl> 
              <dd></dd>
            </dl>
          </dt>
        </dl>
        <hr>
        <h3><a name="2_2">2.3 </a>Why does GCJ use CNI? </h3>
        <blockquote> 
          <p><a href="mailto:per@bothner.com">Per Bothner</a> explains </p>
          <blockquote> 
            <p>We use CNI because we think it is a better solution, especially 
              for a Java implementation that is based on the idea that Java is 
              just another programming language that can be implemented using 
              standard compilation techniques. Given that, and the idea that languages 
              implemented using Gcc should be compatible where it makes sense, 
              it follows that the Java calling convention should be as similar 
              as practical to that used for other languages, especially C++, since 
              we can think of Java as a subset of C++. CNI is just a set of helper 
              functions and conventions built on the idea that C++ and Java have 
              the *same* calling convention and object layout; they are binary 
              compatible. (This is a simplification, but close enough.)</p>
          </blockquote>
        </blockquote>
        <hr>
      </dl>
      <h3><a name="4_4">2.4 What is the state of AWT support</a>?</h3>
      <dl> 
        <dd> No support is currently in place for AWT. Prior Art which could be 
          used for this all require JNI. Possible starting points follow: 
          <dl> </dl>
          <p>QtAWT</p>
          <blockquote> 
            <p>QtAWT ( )provides a Qt based implementation of the peer classes 
              used by the AWT components. This consists of a set of Java classes 
              that implement the interfaces specified in java.awt.peer, and a 
              few others such as java.awt.Toolkit. The classes are implemented 
              in a mixture of Java code and native code, with the native methods 
              being called via the JNI. Because it sticks to standard APIs such 
              as the JNI QtAWT should be portable enough to work on any 1.1 JVM. 
              Once the class and library paths have been set up correctly, the 
              QtAWT can be used instead of the native peers provided with your 
              JVM by setting the awt.toolkit property to point to the QtToolkit 
              implementation. </p>
          </blockquote>
        </dd>
        <dl> 
          <dt>&nbsp;</dt>
          <dd><a href="http://developer.kde.org/language-bindings/java/qtawt/developer.html">http://developer.kde.org/language-bindings/java/qtawt/developer.html</a></dd>
          <dt>&nbsp;</dt>
          <dt>GTK AWT</dt>
          <dd>Some Mozilla / Blackdown project mambers are having a go at this 
            (free login required):</dd>
          <dd><a href="http://developer.java.sun.com/developer/restricted/java2cs/contribs/">http://developer.java.sun.com/developer/restricted/java2cs/contribs/</a></dd>
          <dt>&nbsp;</dt>
          <dd>The Classpath project is doing AWT with GTK peers, and they're looking 
            for someone who wants to make Classpath work with Kaffe ... <a href="http://www.gnu.org/software/classpath/">http://www.gnu.org/software/classpath/</a></dd>
          <dt>&nbsp;</dt>
        </dl>
        <dl> 
          <dt><a href="http://www.kaffe.org/">Kaffe</a> AWT</dt>
          <dd>Kaffe has a JNI based AWT implementation using lightweight peers. 
            Work is currently in progress to implement using GTK.</dd>
        </dl>
      </dl>
      <hr>
      <h3><a name="2_5">2.5 How about support for Swing</a>?</h3>
      <dl> 
        <dl> 
          <dt>Considering that AWT support isnt here yet there is no chance of 
            getting Swing running. Once we have AWT support the Swing 1.1.1 may 
            be useable and even redistributable, but JFC will be another issue, 
            as <a href="mailto:moroz@metahood.ru">Oleg Moroz</a> summarises: 
            <blockquote> 
              <p>1) Swing 1.1.1 for JDK 1.1.x with license that allows to redistribute 
                it as part of the value-added applet or application. This needs 
                some research, however I feel that the term "value-added application" 
                might inlcude e.g. gcj-based development system; if it is not 
                by itself, a simple Swing-based application might be added to 
                the distribution). This version depends on AWT 1.1 only (well, 
                1.1.x, x >=7) and it seems that the Sun's version could be used 
                for most purposes people would like to use it. </p>
            </blockquote>
          </dt>
          <blockquote> 
            <p>2) Swing (JFC) that is part of Java2. This is AFAIK not available 
              as separate product and is covered by more restrictive (in this 
              case at least) JDK license; it is also dependent on AWT 1.2 features. 
              We'd want to develop a replacement only when we move to the 1.2 
              codebase and then we'll also need to develop AWT 1.2 replacement 
              w/o regard to Swing.</p>
            <p>&nbsp;</p>
          </blockquote>
        </dl>
        <dl> 
          <dt><a href="mailto:per@bothner.com">Per Bothner</a> expands:</dt>
          <dd>&nbsp;</dd>
          <dd>One possibility worth considering is developing Swing components 
            in conjunction with AWT. We can implement JTextArea and TextArea at 
            the same time. We could also implement both on top of (say) some Gtk 
            widget; we don't necessarily *have* to go the "peerless" route. Instead, 
            we can base the "plugable look-and-feel" on the "themebility" of (say) 
            Gtk. </dd>
          <dt>&nbsp;</dt>
          <dd>A bigger potential issue is Swing's separation between &quot;model&quot; 
            (e.g. Document) and &quot;view&quot; (e.g. JTextPane). It may be difficult 
            to make use of the functionality of an existing toolkit such as Gtk 
            unless we can use Gtk widgets with separate &quot;model&quot; objects.</dd>
        </dl>
        <hr>
      </dl>
      <h3><a name="2_6">2.6 </a>What support is there for RMI?</h3>
      <dl> 
        <dd> There is no RMI support at the moment. <a href="mailto:mdw@cs.berkeley.edu">Matt 
          Welsh</a> elaborates:</dd>
        <dt> 
          <dl> 
            <dd>I was working on this, but it's on the back-burner right now. 
              So, if anyone would like to help out I would appreciate it. I have 
              a free implementation of RMI (&quot;NinjaRMI&quot;) that is quite 
              similar to Sun's RMI. You can download it from <a href="http://www.cs.berkeley.edu/%7Emdw/proj/ninja">http://www.cs.berkeley.edu/~mdw/proj/ninja</a></dd>
          </dl>
        </dt>
        <dd><a href="http://www.cs.berkeley.edu/%7Emdw/proj/ninja"></a></dd>
      </dl>
      <blockquote> 
        <blockquote> 
          <p>Note that this is NOT Java RMI per se; it is just very similar in 
            functionality and design. You might want to steal some classes out 
            of it to get RMI support in libgcj. However, it does require some 
            classes in java.* and sun.* which are not part of libgcj.</p>
        </blockquote>
        <p>It may be possible to use the JavaParty's <a href="http://wwwipd.ira.uka.de/%7Ehauma/EfficientRMI/">RMI 
          implementation</a>, but the lisencing is much more restrictive than 
          that of NinjaRMI. Details below:</p>
        <blockquote> 
          <p>The much faster drop-in RMI and the appropriate efficient serialization 
            is designed and implemented completely in Java without any native 
            code. Moreover, the re-designed RMI supports non-TCP/IP communication 
            networks, even with heterogeneous transport protocols. As a by-product, 
            there is a benchmark collection for RMI. </p>
        </blockquote>
      </blockquote>
      <p></p>
      <dl> 
        <dt>&nbsp; </dt>
        <hr>
      </dl>
      <dl> 
        <dt> 
          <h3><a name="2_7">2.7 Can I contribute code from other Free Software 
            projects to supplement libgcj's current features?</a></h3>
        </dt>
        <dd> <font color="#FF6600">Can someone point me to some difinitive words 
          on this issue</font> </dd>
      </dl>
      <blockquote> 
        <blockquote>&nbsp;</blockquote>
      </blockquote>
      <dl> 
        <hr>
      </dl>
      <dl> 
        <dt> 
          <h3><a name="2_8">2.8 What features of the Java language are/arn't supported.</a></h3>
        </dt>
        <dd>At the moment GCJ supports all Java language constructs as per the 
          <a href="http://java.sun.com/docs/books/jls/">Java language Specification 
          v1.0</a>. The JDK1.1 added support for Inner Classes, which arent yet 
          supported when compiling from source code, but can be used when compiling 
          from bytecode. see <i>4.2 Can GCJ only handle source code?</i> </dd>
      </dl>
      <dl> 
        <p></p>
      </dl>
      <table border="0" cellpadding="4" width="95%">
        <tr bgcolor="#b0d0ff"> 
          <th align="left"> 
            <h2><a name="3_0">Build Issues</a></h2>
          </th>
        </tr>
      </table>
      <dl> 
        <dt> 
          <h3><a name="3_1">3.1 Linker bug on Solaris</a></h3>
        </dt>
        <p> 
        <dd>There is a known problem with the <a href="http://egcs.cygnus.com/ml/gcc-bugs/1999-10/msg00159.html"> 
          native Solaris linker</a> when using gcc/gcj. A good indication you've 
          run into this problem is if you get an error that looks like the following 
          when building libgcj: 
          <pre>
ld: warning: option -o appears more than once, first setting taken
ld: fatal: file libfoo.so: cannot open file: No such file or directory
ld: fatal: File processing errors. No output written to .libs/libfoo.so
collect2: ld returned 1 exit status
	</pre>
          A known workaround for this and other reported link problems on the 
          various releases of Solaris is to build gcc/gcj with the <a href="ftp://sourceware.cygnus.com/pub/binutils/snapshots"> 
          latest GNU binutils</a> instead of the native Solaris <tt>ld</tt>. The 
          most straightforward way to do this is to build and install binutils, 
          and then reference it in the configure for gcc via <tt>--with-ld=/path_to_binutils_install/bin/ld</tt> 
          (<tt>--with-as</tt> may also be similarly specified but is not believed 
          to be required). 
          <p> Please note, gcc/gcj must be built using GNU ld prior to doing a 
            clean build of libgcj! 
        </dd>
        <p></p>
      </dl>
      <table border="0" cellpadding="4" width="95%">
        <tr bgcolor="#b0d0ff"> 
          <th align="left"> 
            <h2><a name="4_0">Gcj Compile/Link Questions</a></h2>
          </th>
        </tr>
      </table>
      <dl> 
        <dt>&nbsp; </dt>
        <dt> 
          <h3><a name="4_1">4.1 Why do I get <tt>undefined reference to `main'</tt> 
            errors?</a></h3>
        </dt>
      </dl>
      <p> 
      <dl> 
        <dd>When using <tt>gcj</tt> to link a Java program, you must use the <tt>--main=</tt> 
          option to indicate the class that has the desired <tt>main</tt> method. 
          This is because every Java class can have a <tt>main</tt> method, thus 
          you have to tell gcj which one to use.</dd>
        <dt>&nbsp;</dt>
        <hr>
      </dl>
      <dl> 
        <dt>&nbsp; </dt>
        <dt> 
          <h3><a name="4_2">4.2 Can GCJ only handle source code?</a></h3>
        </dt>
      </dl>
      <p> 
      <dl> 
        <dd>The GCJ compiler will compile both java source and bytecode .class 
          files. For the moment support for compiling bytecodes will support more 
          applications than compiling from source, as the source code compiler 
          lacks support for inner classes, which are used heavily in programs 
          written for the JDK 1.1 (AWT in particular). 
          <p>In many cases the native code produced by compiling from source is 
            better optimised than that compiled from .class files. Per Bothner 
            explains:</p>
        </dd>
        <dt> 
          <dl> 
            <dd>The reason is that when you compile to bytecode you lose a lot 
              of information about program structure etc. That information helps 
              in generating better code. We can in theory recover the information 
              we need by analysing the structure of the bytecodes, but it is sometimes 
              difficult - or sometimes it just that no-one has gotten around to 
              it. 
              <p>Specific examples include loop structure (gcc generates better 
                code with explicit loops rather than with the equivalent spaghetti 
                code), array initializers, and the JDK 1.1 `CLASS.class' syntax, 
                all of which are represented using more low-level constructs in 
                bytecode.</p>
            </dd>
            <dt>&nbsp;</dt>
          </dl>
        </dt>
        <hr>
        <dt>&nbsp;</dt>
        <dt><font color="#FF3300"></font></dt>
        <dt> 
          <h3><a name="4_4">4.3 &quot;gcj -C"</a> Doesnt seem to work like javac/jikes. 
            Whats going on?</h3>
        </dt>
        <blockquote> 
          <p>The behavior of "gcj -C" is not at all like javac or jikes, which 
            will compile (not just scan) all .java's which are out of date with 
            regard to their .class's.</p>
        </blockquote>
      </dl>
      <hr>
      <dl> 
        <dt>&nbsp; </dt>
      </dl>
      <dl> 
        <dt> 
          <h3><a name="4_4">4.4 Where does GCJ look for files?</a></h3>
        </dt>
        <blockquote> 
          <p>GCJ looks for classes to compile based on the CLASSPATH environment 
            variable. An important limitation presently is that gcj doesn't handle 
            compressed jar files in your classpath </p>
        </blockquote>
      </dl>
      <hr>
      <dl> 
        <dt>&nbsp; </dt>
      </dl>
      <dl> 
        <dt> 
          <h3><a name="4_5">4.5 How does gcj resolve wether to compile .class 
            or .java files?</a></h3>
        </dt>
        <blockquote> 
          <p>GCJ seems to favor .class files in the CLASSPATH, if any, otherwise 
            it will use the source (.java), also in the CLASSPATH. It also checks 
            to see if the class is newer than the .java file. If it can't find 
            either it throws an error.</p>
        </blockquote>
      </dl>
      <dl> 
        <dt>&nbsp; </dt>
      </dl>
      <dl> 
        <p></p>
      </dl>
      <table border="0" cellpadding="4" width="95%">
        <tr bgcolor="#B0D0FF"> 
          <th align="left"> 
            <h2><a name="5_0">Runtime Questions</a></h2>
          </th>
        </tr>
      </table>
      <dl> 
        <dt> 
          <h3><a name="5_1">5.1 My program is dumping core! What's going on?</a></h3>
        </dt>
        <p> 
        <dd>I could be any number of things. One common mistake is having your 
          <tt>CLASSPATH</tt> environment variable pointing at a third party's 
          java.lang and friends. Either unset <tt>CLASSPATH</tt>, or make sure 
          it does not refer to core libraries other than those found in libgcj.zip.</dd>
        <dd></dd>
      </dl>
      <p></p>
      <dl> 
        <dt> 
          <hr>
          <h3><a name="5_2">5.2 When I run the debugger I get a SEGV in the GC! 
            What's going on?</a></h3>
        </dt>
      </dl>
      <p> 
      <dl> 
        <dd>This is "normal"; the Garbage Collector (GC) uses it to determine 
          stack boundaries. It is ordinarily caught and handled by the GC -- you 
          can see this in the debugger by using <tt>cont</tt> to continue to the 
          "real" segv. 
          <p>This shouln't happen anymore, as we dont define MPROTECT_VDB in the 
            GC, at least for Linux/386.</p>
        </dd>
        <dt>&nbsp;</dt>
      </dl>
      <p></p>
      <dl> 
        <dt> 
          <hr>
          <h3><a name="5_3">5.3 I have just compiled and benchmarked my Java application 
            and it seems to be running slower than than XXX JIT JVM. Is there 
            anything I can do to make it go faster?</a></h3>
        </dt>
      </dl>
      <p> 
      <dl> 
        <dd>A few things: 
          <ul>
            <li>If your programs allocate many small, short lived objects, the 
              heap could be filling and triggering GC too regularly. Try increasing 
              the initial and maximum heap sizes as per <i>5.3 How do I increase 
              the runtime's initial and maximum heap size?</i></li>
            <li>RE - array accesses. We have sub-optimal runtime checking code, 
              and the compiler is still not so smart about automatically removing 
              array checks. If you're code is ready, and it doesn't rely on them, 
              try compiling with --no-bounds-check. </li>
            <li>Try static linking. The interaction with boehm-gc seems to incur 
              extra overhead when shared libraries are used. On one program that 
              makes heavy use of the allocator I achieved over 30% runtime performance 
              gain with static linking. This issue may disappear soon with a new 
              version of the GC.</li>
            <li>If your Java application doesn't need threads, try building libgcj 
              using --enable-threads=none. Portions of the libgcj runtime are 
              still more efficient when single-threaded.</li>
          </ul>
        </dd>
      </dl>
      <p></p>
      <p> 
      <dl> 
        <dd>&nbsp;</dd>
      </dl>
      <dl> 
        <hr>
        <dt>&nbsp;</dt>
        <dt> 
          <h3><a name="5_3">5.3 Can I profile Garbage Collection?</a></h3>
        </dt>
        <dd>It is possible to turn on verbose GC output by supressing the -DSILENT 
          flag during build. One way to do this is to comment out the line with 
          #define SILENT 1 from boehm-gc/configure before configuring libgcj. 
        </dd>
        <dt>&nbsp;</dt>
        <dd>The GC will print collection statistics to stdout. (Rebuilding boehm-gc 
          alone without this flag doesn't seem to work.)</dd>
        <dt>&nbsp;</dt>
        <hr>
        <dt>&nbsp;</dt>
        <dt> 
          <h3><a name="5_3">5.4 How do I increase the runtime's initial and maximum 
            heap sizes?</a></h3>
        </dt>
        <dd>Some programs that allocate many small, short-lived objects can cause 
          the default-sized heap to fill quickly and GC often. With the 2.95.1 
          release there is no means to adjust the heap at runtime. Recent snapshots 
          provide the -ms and -mx arguments to gij to specify the initial and 
          maximum heap sizes, respectively.</dd>
      </dl>
      <hr>
      <dl> 
        <dt> 
          <h3><a name="5_3">5.5 How can I profile my application?</a></h3>
        </dt>
        <dd>Support for this is currently lagging. Only single threaded Java code 
          may be used by the profiler (gprof). POSIX threads seem to be incompatible 
          with the gmon stuff.</dd>
        <dt>&nbsp;</dt>
      </dl>
      <p> 
      <table width="100%" border="0">
        <tr bgcolor="#B0D0FF" align="left"> 
          <th> 
            <h2><a name="6_0"></a>Programing Issues </h2>
          </th>
        </tr>
      </table>
      <h3><a name="6_1"></a>6.1 Are there any examples of how to use CNI?</h3>
      <blockquote> 
        <p><a href="mailto:tromey@cygnus.com">Tom Tromey</a> has created a couple 
          of simple ezamples <a href="cni-1.txt">here</a> and <a href="cni-2.txt">here</a>. 
        </p>
        <p>Another CNI example may be found here (thanks to Glenn Chambers!): 
          <a href="http://sourceware.cygnus.com/ml/java-discuss/1999-q3/msg00534.html">http://sourceware.cygnus.com/ml/java-discuss/1999-q3/msg00534.html</a> 
        </p>
        <p>The primary source of documentation for CNI is at <a href="http://sourceware.cygnus.com/java/papers/cni/t1.html">http://sourceware.cygnus.com/java/papers/cni/t1.html</a></p>
      </blockquote>
    </td>
  </tr>
</table>
<hr>
<address> <a href="about.html">The GCJ team</a> <br>
<small> $Id: faq.html,v 1.7 1999/12/20 01:05:31 brads Exp $ </small></address>
<h2 align=center>&nbsp;</h2>

    <!--#include virtual="/include/footer-subpages.html"-->
