<html>

<head>
<title>libgcj-2.95 Platform Test Strategy</title>
</head>

<body>

<h1 align="center">libgcj-2.95 Platform Test Strategy</h1>

<h2> Platform Coverage </h2>
<p>One of the critical steps in making releases is platform testing.  
Since there is no prior release of libgcj to perform regressions against,
we want to compare results against a known building platform, i686-pc-linux-gnu.</p>

<p>We would like to get the widest coverage possible, so please check the
following chart for platforms that have already been covered if you have
a choice of platforms to build upon.</p>

<p>Please send build/test results (in the format described below) to
<a href="mailto:java@gcc.gnu.org">java@gcc.gnu.org</a>.
<br />You may also address questions to 
<a href="mailto:java@gcc.gnu.org">java-discuss</a>
or to indicate that you would like to help in another way with some phase of the
libgcj-2.95 release cycle.</p>

<h2>How to run the tests</h2>

<p>  First, you must have built and installed
<a href="libgcj.html">libgcj</a> using the
<b>libgcj-2_95-branch</b> branch of the source.</p>
<p>This can be done by including the <tt>'-rlibgcj-2_95-branch'</tt>
flag on the <tt>'cvs co'</tt> command line or downloading the
<a href="ftp://sources.redhat.com/pub/java/snapshots/">snapshot</a>
and then following the
<a href="libgcj.html">
build instructions on the libgcj page</a>.
(For those developers downloading via snapshots, please note that
the snapshoting process has been temporarily changed to use the
<tt>libgcj-2_95-branch</tt> rather than the main trunk.
Please be aware of this if you are looking for patches that get applied
to the main source tree but not to the branch).</p>

<p>  Next, go to the <tt>libjava/testsuite</tt> directory of your build
tree and run <tt>'make check'</tt> after doing the following:</p>
<ul>
  <li>In order to more fully exercise libgcj, it is highly recommended to
  include the 
  <a href="http://sources.redhat.com/mauve/">Mauve testsuite</a>
  in the test run.
  <br />The Mauve tests are available for
  <a href="http://sources.redhat.com/mauve/download.html">download</a>
  via both anonymous cvs and snapshots.</li>
  <li>The env variable MAUVEDIR must be set to the top of the Mauve source tree.</li>
  <li>The testsuites rely on the dejagnu package.  You can download the
  <a href="ftp://gcc.gnu.org/pub/gcc/infrastructure/dejagnu-19990614.tar.gz">current dejagnu snapshot</a>
  from gcc.  Please note that some earlier versions of dejagnu are missing a
  patch that's in recent snapshots.  Please make sure you have tried
  running the testsuites with the current snapshot of dejagnu before reporting
  any testsuite platform problems.  There is a short entry in the
  <a href="http://gcc.gnu.org/faq.html#dejagnu">gcc FAQ</a>
  if you would like more information about this issue.</li> 
</ul>

<h2>Testing notes</h2>
<ul>
  <li>By default, tests that first compile to bytecode use an installed
  <tt>javac</tt> program.  Set the environment variable <tt>JAVAC</tt>
  to <tt>'gcj -C'</tt> to use the installed gcj for this purpose.</li> 
  <li> It is highly recommended that you not override the default libgcj
  configuration option for building with dynamic libraries.  This is to avoid
  having to explicitly specify some libgcj object modules on the link line
  to get certain java/net Mauve tests to execute.</li> 
  <li>An gcc patch affecting <tt>gcj</tt> was made on 24-June-99.
  Developers using cvs to access the gcc source should update an rebuild
  to get that fix.  The next
  <a href="ftp://gcc.gnu.org/pub/gcc/snapshots/index.html">gcc snapshot</a>
  with this patch will not be available until 30-June-99.  At that point
  developers without cvs access should download that patch.  In the
  meantime, the problem can be avoided in test runs with the following
  <tt>RUNTESTFLAGS</tt> options:
  <pre>
   make RUNTESTFLAGS='GCJ_UNDER_TEST="gcj -L/x2/java/build/i686-pc-linux-gnu/libjava"' \
   JAVAC='gcj -C -I/x2/java/build/i686-pc-linux-gnu/libjava/libgcj.zip' \
   GCJ_UNDER_TEST='gcj -L/x2/java/install/lib' check
  </pre>
  i.e. GCJ_UNDER_TEST needs a -L pointing to the libjava build directory and
  JAVAC needs a -I pointing to the zip file.</li> 
</ul>

<h2>Current Platform Testing Status</h2>
<p>This is the current results for the platforms reported to us.  Please use
this format when reporting your results.
</p>
<table border="2"
cellpadding="2">
<tr>
<th>
Platform
</th>
<th>
Configuration
</th>
<th>
Build Status
</th>
<th>
Test Results
</th>
</tr>
<tr>
<td>
i686-pc-linux-gnu
</td>
<td>
--enable-threads=posix
</td>
<td>
OK
</td>
<td>
# of expected passes		1876
<br />
# of unexpected failures	32
<br />
# of expected failures		6
</td>
</tr>
<tr>
<td>
alphapca56-unknown-linux-gnu
</td>
<td>
--enable-threads=posix
<br />--enable-fast-character
<br />--enable-java-gc=boehm
</td>
<td>
OK
</td>
<td>
# of expected passes		187
<br />
# of unexpected failures	19
<br />
# of expected failures		18
</td>
</tr>
<tr>
<td>
sparc-sun-solaris2.6
</td>
<td>
</td>
<td>
OK
</td>
<td>
# of expected passes		60
<br />
# of unexpected failures	68
<br />
# of expected failures		96
</td>
</tr>
<tr>
<td>
sparc-sun-solaris2.7
</td>
<td>
--enable-java-gc=no
</td>
<td>
OK
</td>
<td>
# of expected passes		196
<br />
# of unexpected failures	22
<br />
# of expected failures		8
</td>
</tr>
</table>

<p>A list of deviations from the 
<a href="libgcj-sum.txt">posted baseline list of test results</a>
should follow any entry you submit.
A context diff is fine if it is clear what tests are failing;
we'd rather not have to deal with a complete output listing unless
it is necessary to comprehend the deviations.</p>
<p>Note that if you are not using POSIX threads, some tests will not complete  
successfully, so differences should be expected.</p>
 
<p>Please send build/test results to
<a href="mailto:java@gcc.gnu.org">java@gcc.gnu.org</a>
in this format.</p>

<h2>Submitting Patches</h2>
<p><tt>libgcj-2.95</tt> should be considered frozen except for low-risk
porting changes that increase coverage to new target platforms
(i.e. those changes that would not affect other platforms).
High priority changes will be determined and considered on a case
by case basis.  All other changes will only go into the main trunk
and not the libgcj-2_95-branch.</p>

<p>The mailing list, 
<a href="mailto:java-patches@gcc.gnu.org">java-patches@gcc.gnu.org</a>
has been created for patch submissions.
We plan to use this list just as gcc uses the gcc-patches list: all
patches will be sent to the list.
If you have a patch you want considered, please send it there along
with an explanation and a ChangeLog entry.</p>

<p>Developers with checkin-after-approval access should also send patches
to this list, and then check them in after approval is given.
Developers with direct checkin access should also send patches to this
list; this can happen concurrently with the checkin.</p>

<p>Some discussion will probably take place on this list (just as with
gcc-patches).  The 
<a href="/java/">web page has subscription info</a>,
as well as a
<a href="http://gcc.gnu.org/ml/java-patches/">
link to the archives</a>.</p>

<p>The
<a href="mailto:java-patches@gcc.gnu.org">java-patches</a>
mailing list is for patches to the libgcj code
(libjava, boehm-gc, zlib, etc) code only.
In particular, compiler patches still have to go through gcc, so
please don't send them to java-patches.</p>

</body>
</html>
