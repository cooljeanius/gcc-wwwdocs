<html>

<head>
<title>GCC 6 Release Series &mdash; Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 6 Release Series<br />Changes, New Features, and Fixes</h1>

<!-- .................................................................. -->
<h2>Caveats</h2>
  <ul>
    <li>The default mode for C++ is now <code>-std=gnu++14</code> instead of
        <code>-std=gnu++98</code>.</li>
  </ul>

<!-- .................................................................. -->
<h2 id="general">General Optimizer Improvements</h2>
  <ul>
    <li>UndefinedBehaviorSanitizer gained a new sanitization option,
	<code>-fsanitize=bounds-strict</code>, which enables strict checking
	of array bounds.  In particular, it enables
	<code>-fsanitize=bounds</code> as well as instrumentation of
	flexible array member-like arrays.</li>
  </ul>

<!-- .................................................................. -->
<h2 id="languages">New Languages and Language specific improvements</h2>

<!-- <h3 id="ada">Ada</h3> -->

<h3 id="c-family">C family</h3>
  <ul>
    <li>The C and C++ compilers now support attributes on enumerators.  For instance,
	it is now possible to mark enumerators as deprecated:
<blockquote><pre>
enum {
  newval,
  oldval __attribute__ ((deprecated ("too old")))
};
</pre></blockquote></li>
<li>Initial support for precise diagnostic locations within strings:
<blockquote><pre>
<b>format-strings.c:3:14:</b> <b style='color:magenta'>warning:</b> field width specifier <b>'*'</b> expects a matching <b>'int'</b> argument [-Wformat=]
   printf("%*d");
            <b style='color:lime'>^</b>
</pre></blockquote></li>

    <li>New command-line options have been added for the C and C++ compilers:
      <ul>
        <li><code>-Wshift-negative-value</code> warns about left shifting a
          negative value.</li>
        <li><code>-Wshift-overflow</code> warns about left shift overflows.
          This warning is enabled by default.
          <code>-Wshift-overflow=2</code> also warns about left-shifting 1 into
          the sign bit.</li>
        <li><code>-Wtautological-compare</code> warns if a self-comparison
          always evaluates to true or false.  This warning is enabled by
          <code>-Wall</code>.</li>
        <li><code>-Wnull-dereference</code> warns if the compiler detects paths
          that trigger erroneous or undefined behavior due to dereferencing a
          null pointer. This option is only active when
          <code>-fdelete-null-pointer-checks</code> is active, which is enabled
          by optimizations in most targets. The precision of the warnings
          depends on the optimization options used.</li>
      </ul>
    </li>
  </ul>

<h3 id="c">C</h3>
  <ul>
    <li>It is possible to disable warnings when an initialized field of
	a structure or a union with side effects is being overridden when
	using designated initializers via a new warning option
	<code>-Woverride-init-side-effects</code>.</li>
  </ul>

<h3 id="cxx">C++</h3>
  <ul>
    <li>The default mode has been changed to <code>-std=gnu++14</code>.</li>
    <li>C++ Concepts are now supported when compiling with
        <code>-std=gnu++1z</code> or <code>-std=c++1z</code>.</li>
  </ul>

<h4 id="libstdcxx">Runtime Library (libstdc++)</h4>
  <ul>
    <li> Experimental support for C++17, including the following
      new features:
      <ul>
        <li><code>std::uncaught_exceptions</code> function (this is also
            available for <tt>-std=gnu++NN</tt> modes); </li>
        <li>new member functions <code>try_emplace</code> and
            <code>insert_or_assign</code> for unique_key maps;</li>
        <li>non-member functions <code>std::size</code>,
            <code>std::empty</code>, and <code>std::data</code> for
            accessing containers and arrays;</li>
        <li><code>std::shared_mutex</code>;</li>
        <li><code>std::void_t</code> and <code>std::bool_constant</code>
            utilities. </li>
      </ul>
    </li>
    <li>An experimental implementation of the File System TS.</li>
    <li>Experimental support for most features of the second version of the
        Library Fundamentals TS.</li>
  </ul>


<h3 id="fortran">Fortran</h3>
  <ul>
    <li>The <code>MATMUL</code> intrinsic is now inlined for straightforward
      cases if front-end optimization is active.  The maximum size for
      inlining can be set to <code>n</code> with the
      <code>-finline-matmul-limit=n</code> option and turned off
      with <code>-finline-matmul-llimit=0</code>.</li>
    <li>The <code>-Wconversion-extra</code> option will warn about
      <code>REAL</code> constants which have excess precision for
      their kind.</li>
    <li>The <code>-Winteger-division</code> option has been added, which
      warns about divisions of integer constants which are truncated.
      This option is included in <code>-Wall</code> by default.</li>
  </ul>

<!-- <h3 id="go">Go</h3> -->

<!-- <h3 id="java">Java (GCJ)</h3> -->


<!-- .................................................................. -->
<!-- <h2 id="jit">libgccjit</h2> -->


<!-- .................................................................. -->
<h2 id="targets">New Targets and Target Specific Improvements</h2>

<h3 id="aarch64">AArch64</h3>
   <ul>
     <li>
       The new command line options <code>-march=native</code>,
       <code>-mcpu=native</code> and <code>-mtune=native</code> are now
       available on native AArch64 GNU/Linux systems.  Specifying
       these options will cause GCC to auto-detect the host CPU and
       rewrite these options to the optimal setting for that system.
       If GCC is unable to detect the host CPU these options have no effect.
     </li>
     <li>
       <code>-fpic</code> is now supported by the AArch64 target when generating
       code for the small code model (<code>-mcmodel=small</code>).  The size of
       the global offset table (GOT) is limited to 28KiB under the LP64 SysV ABI
       , and 15KiB under the ILP32 SysV ABI.
     </li>
     <li>
       The AArch64 port now supports target attributes and pragmas.  Please
       refer to the <a href="https://gcc.gnu.org/onlinedocs/gcc/AArch64-Function-Attributes.html#AArch64-Function-Attributes">
       documentation</a> for details of available attributes and
       pragmas as well as usage instructions.
     </li>
     <li>
       Link-time optimization across translation units with different
       target-specific options is now supported.
     </li>
   </ul>
<!-- <h3 id="arm">ARM</h3> -->

<!-- <h3 id="avr">AVR</h3> -->

<h3 id="x86">IA-32/x86-64</h3>
   <ul>
     <li>
       Support for new AMD instructions <code>monitorx</code> and
       <code>mwaitx</code> has been added. This includes new intrinsic
       and built-in support. It is enabled through option <code>-mmwaitx</code>.
       The instructions <code>monitorx</code> and <code>mwaitx</code>
       implement the same functionality as the old <code>monitor</code>
       and <code>mwait</code> instructions. In addition <code>mwaitx</code>
       adds a configurable timer. The timer value is received as third
       argument and stored in register <code>%ebx</code>.
     </li>
   </ul>
<!-- <h3 id="mips">MIPS</h3> -->

<h3 id="msp430">MSP430</h3>
  <ul>
    <li><p>The MSP430 compiler now has the ability to automatically distribute code
      and data between low memory (addresses below 64K) and high memory.  This only
      applies to parts that actually have both memory regions and only if the
      linker script for the part has been specifically set up to support this
      feature.</p>

      <p>A new attribute of <code>either</code> can be applied to both functions
      and data, and this tells the compiler to place the object into low memory
      if there is room and into high memory otherwise.  Two other new attributes
      - <code>lower</code> and <code>upper</code> - can be used to explicitly
      state that an object should be placed in the specified memory region.  If
      there is not enough left in that region the compilation will fail.</p>

      <p>Two new command-line options - <code>-mcode-region=[lower|upper|either]</code>
      and <code>-mdata-region=[lower|upper|either]</code> - can be used to tell
      the compiler what to do with objects that do not have one of these new
      attributes.</p></li>
  </ul>

<!-- <h3 id="nds32">NDS32</h3> -->

<h3 id="powerpc">PowerPC / PowerPC64 / RS6000</h3>
  <ul>
    <li><p>A new configuration option -<code>--with-advance-toolchain=at</code>
    was added for PowerPC 64-bit GNU/Linux systems to use the header files, library
    files, and the dynamic linker from a specific Advance Toolchain release
    instead of the default versions that are provided by the GNU/Linux
    distribution.  In general, this option is intended for the developers of
    GCC, and it is not intended for general use.</p></li>
  </ul>

<!-- <h3 id="rx">RX</h3> -->

<!-- <h3 id="sh">SH</h3> -->


<!-- .................................................................. -->
<h2 id="os">Operating Systems</h2>

<!-- <h3 id="dragonfly">DragonFly BSD</h3> -->

<!-- <h3 id="freebsd">FreeBSD</h3> -->

<h3 id="rtems">RTEMS</h3>
  <ul>
    <li>The RTEMS thread model implementation changed.  For the mutexes
    self-contained objects defined in Newlib &lt;sys/lock.h&gt; are used
    instead of Classic API semaphores.  The keys for thread specific data and
    the once function are directly defined via &lt;pthread.h&gt;.
    Self-contained condition variables are provided via Newlib
    &lt;sys/lock.h&gt;.  The RTEMS thread model supports now the C++11
    threads.</li>

    <li>The OpenMP support uses now self-contained objects provided by Newlib
    &lt;sys/lock.h&gt; and offers a significantly better performance compared
    to the POSIX configuration of <code>libgomp</code>.  It is possible to
    configure thread pools for each scheduler instance via the environment
    variable <code>GOMP_RTEMS_THREAD_POOLS</code>.</li>
  </ul>

<!-- <h3 id="vxmils">VxWorks MILS</h3> -->


<!-- .................................................................. -->
<!-- <h2>Documentation improvements</h2> -->


<!-- .................................................................. -->
<h2>Other significant improvements</h2>

  <ul>
    <li>The <code>--enable-default-pie</code> configure option enables
	generation of PIE by default.</li>
  </ul>

</body>
</html>
