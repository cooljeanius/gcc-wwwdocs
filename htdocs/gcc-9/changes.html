<!DOCTYPE html>
<html lang="en">
<head>
<title>GCC 9 Release Series &mdash; Changes, New Features, and Fixes</title>
<link rel="stylesheet" type="text/css" href="https://gcc.gnu.org/gcc.css" />
</head>

<!-- GCC maintainers, please do not hesitate to contribute/update
     entries concerning those part of GCC you maintain!
-->

<body>
<h1>GCC 9 Release Series<br/>Changes, New Features, and Fixes</h1>

<p>
This page is a "brief" summary of some of the huge number of improvements
in GCC 9.
<!--
You may also want to check out our
<a href="porting_to.html">Porting to GCC 8</a> page and the
<a href="../onlinedocs/index.html#current">full GCC documentation</a>.
-->
</p>

<p>Note: GCC 9 has not been released yet, so this document is
a work-in-progress.</p>

<!-- .................................................................. -->
<h2>Caveats</h2>
<ul>
  <li>
    On Arm targets (<code>arm*-*-*</code>),
    <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=88469">a bug</a>
    in the implementation of the procedure call standard (AAPCS)
    in the GCC 6, 7 and 8 releases has been fixed: a structure
    containing a bit-field based on a 64-bit integral type and where
    no other element in a structure required 64-bit alignment could be
    passed incorrectly to functions.  This is an ABI change.  If the
    option <code>-Wpsabi</code> is enabled (on by default) the
    compiler will emit a diagnostic note for code that might be
    affected.
  </li>
  <li><p>Support for a number of older systems and recently
      unmaintained or untested target ports of GCC has been declared
      obsolete in GCC 9.  Unless there is activity to revive them, the
      next release of GCC will have their sources permanently
      <strong>removed</strong>.</p>

    <p>The following ports for individual systems on
      particular architectures have been obsoleted:</p>

    <ul>
      <li>Solaris 10 (<code>*-*-solaris2.10</code>).  Details can be found
      in the <a href="https://gcc.gnu.org/ml/gcc/2018-10/msg00139.html">
      announcement</a>.</li>
    </ul>
  </li>
</ul>


<!-- .................................................................. -->
<h2 id="general">General Improvements</h2>
<ul>
  <li>
    A new option, <a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#index-flive-patching"><code>-flive-patching=[inline-only-static|inline-clone]</code></a>, has been
    introduced to provide a safe compilation for live-patching. At the same
    time, provides multiple-level control on the enabled IPA optimizations.
    See the user guide for more details about the option.
  </li>
  <li>
      A new option, <code>--completion</code>, has been added to provide more fine
      option completion in a shell.  It is intended to be used by Bash-completion.
  </li>
  <li>
      The alignment-related options <a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#index-falign-functions"><code>-falign-functions</code></a>,
      <a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#index-falign-labels"><code>-falign-labels</code></a>,
      <a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#index-falign-loops"><code>-falign-loops</code></a>,
      and <a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#index-falign-jumps"><code>-falign-jumps</code></a> received support for a secondary
      alignment (e.g. <code>-falign-loops=n:m:n2:m2</code>).
  </li>
  <li>
      A new built-in function, <a href="https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html#index-_005f_005fbuiltin_005fexpect_005fwith_005fprobability"><code>__builtin_expect_with_probability</code></a>,
      has been added.
  </li>
  <li>
      Switch expansion has been improved by using a different strategy
      (jump table, bit test, decision tree) for a subset of switch cases.
  </li>
  <li>
      A linear function expression defined as a switch statement
      can be transformed by <a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#index-ftree-switch-conversion"><code>-ftree-switch-conversion</code></a>.  For example:
    <blockquote><pre class="blackbg">
int
foo (int how)
{
  switch (how) {
    case 2: how = 205; break;
    case 3: how = 305; break;
    case 4: how = 405; break;
    case 5: how = 505; break;
    case 6: how = 605; break;
  }
  return how;
}
</pre></blockquote>
      can be transformed into <code>100 * how + 5</code> (for values defined
      in the switch statement).
  </li>
  <li>
      The gcov tool received a new option <a href="https://gcc.gnu.org/onlinedocs/gcc/Invoking-Gcov.html#Invoking-Gcov"><code>--use-hotness-colors</code></a>
      (<code>-q</code>) that can provide perf-like coloring of hot functions.
  </li>
  <li>
      The gcov tool has changed its intermediate format to a new JSON format.
  </li>
  <li>
      New pair of profiling options (<a href="https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html#index-fprofile-filter-files"><code>-fprofile-filter-files</code></a>
      and <a href="https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html#index-fprofile-exclude-files"><code>-fprofile-exclude-files</code></a>) has been added.
      The options help to filter which source files are instrumented.
  </li>
  <li>
      AddressSanitizer generates more compact red-zones for automatic variables.
      That helps to reduce memory footprint of a sanitized binary.
  </li>
</ul>

<!-- .................................................................. -->
<h2 id="languages">New Languages and Language specific improvements</h2>

<!-- <h3 id="ada">Ada</h3> -->

<!-- <h3 id="brig">BRIG (HSAIL)</h3> -->

<h3 id="c-family">C family</h3>
<ul>
  <li>Version 5.0 of the <a href="https://www.openmp.org/specifications/"
        >OpenMP specification</a> is now partially supported in the C and C++
      compilers.  For details which features of OpenMP 5.0 are and which are
      not supported in the GCC 9 release see
      <a href="https://gcc.gnu.org/ml/gcc-patches/2018-11/msg00628.html">this mail</a>.
  </li>

  <li>New extensions:
  <ul>
    <li><a href="https://gcc.gnu.org/onlinedocs/gcc/Vector-Extensions.html#index-_005f_005fbuiltin_005fconvertvector"><code>__builtin_convertvector</code></a> built-in for vector conversions
      has been added. </li>
  </ul></li>

  <li>New warnings:
  <ul>
      <li><a href="https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Waddress-of-packed-member"><code>-Waddress-of-packed-member</code></a>, enabled by default,
      warns about an unaligned pointer value from the address of a packed
      member of a struct or union.
      </li>
  </ul></li>
</ul>

<h3 id="c">C</h3>
<ul>
  <li>New warnings:
  <ul>
    <li><a href="https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#index-Wabsolute-value"><code>-Wabsolute-value</code></a>
      warns for calls to standard functions that compute the absolute
      value of an argument when a more appropriate standard function
      is available.  For example, calling <code>abs(3.14)</code>
      triggers the warning because the appropriate function to call to
      compute the absolute value of a double argument
      is <code>fabs</code>.  The option also triggers warnings when
      the argument in a call to such a function has an unsigned type.
      This warning can be suppressed with an explicit type cast and it
      is also enabled by <code>-Wextra</code>.
    </li>
  </ul></li>
</ul>

<h3 id="cxx">C++</h3>
<ul>
  <li>New warnings:
  <ul>
    <li><a href="https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html#index-Wdeprecated-copy"><code>-Wdeprecated-copy</code></a>, implied by <code>-Wextra</code>, warns
      about the C++11 deprecation of implicitly declared copy constructor and
      assignment operator if one of them is user-provided.
      <code>-Wdeprecated-copy-dtor</code> also warns if the destructor is
      user-provided, as specified in C++11.
    </li>
    <li><a href="https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html#index-Winit-list-lifetime"><code>-Winit-list-lifetime</code></a>, on by default, warns about uses
      of <code>std::initializer_list</code> that are likely to result in a
      dangling pointer, such as returning or assigning from a temporary
      list. </li>
    <li><a href="https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html#index-Wredundant-move"><code>-Wredundant-move</code></a>, implied by <code>-Wextra</code>, warns about redundant calls to
    <code>std::move</code>.</li>
    <li><a href="https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html#index-Wpessimizing-move"><code>-Wpessimizing-move</code></a>, implied by <code>-Wall</code>, warns when a call to
    <code>std::move</code> prevents copy elision.</li>
    <li><a href="https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html#index-Wclass-conversion"><code>-Wclass-conversion</code></a>, on by default, warns when a conversion function will never be
    called due to the type it converts to.</li>
  </ul></li>

  <li>
    The C++ front end has experimental support for some of the upcoming C++2a
    draft features with the <code>-std=c++2a</code>
    or <code>-std=gnu++2a</code> flags, including range-based for statements
    with initializer, default constructible and assignable stateless lambdas,
    lambdas in unevaluated contexts, language support for empty data members,
    allowing pack expansion in lambda init-capture, likely and unlikely
    attributes, class types in non-type template parameters, allowing virtual
    function calls in constant expressions, explicit(bool),
    <code>std::is_constant_evaluated</code>, nested inline namespaces, etc.
    For a full list of new features,
    see <a href="../projects/cxx-status.html#cxx2a">the C++
    status page</a>.
  </li>
</ul>

<h4 id="libstdcxx">Runtime Library (libstdc++)</h4>
<ul>
  <li>Improved experimental support for C++17,
      including <code>&lt;memory_resource&gt;</code>.
  </li>
  <li>Improved experimental support for C++2a,
      including:
      <ul>
      <li>Type traits <code>std::remove_cvref</code>,
        <code>std::unwrap_reference</code>, <code>std::unwrap_decay_ref</code>,
        <code>std::is_nothrow_convertible</code>, and
        <code>std::type_identity</code>.</li>
      <li>Headers <code>&lt;bit&gt;</code> and
        <code>&lt;version&gt;</code>.</li>
      <li>Uniform container erasure (<code>std::erase_if</code>).</li>
      <li><code>contains</code> member of maps and sets.</li>
      <li>String prefix and suffix checking (<code>starts_with</code>,
        <code>ends_with</code>).</li>
      <li>Functions <code>std::midpoint</code> and <code>lerp</code> for
        interpolation.</li>
      <li>Uses-allocator construction utilities.</li>
      <li><code>std::pmr::polymorphic_allocator&lt;std::byte&gt;</code>.</li>
      <li>Library support for <code>char8_t</code> type.</li>
      <li>Destroying <code>delete</code>.</li>
      <li><code>std::is_constant_evaluated()</code> function.</li>
      </ul>
  </li>
  <li>Support for opening file streams with wide character paths on Windows</li>
  <li>Incomplete support for the C++17 Filesystem library and the Filesystem
      TS on Windows.</li>
  <li>Incomplete, experimental support for the Networking TS.</li>
</ul>

<h3 id="d">D</h3>
<ul>
  <li>Support for the D programming language has been added to GCC,
    implementing version 2.076 of the language and run-time library.
  </li>
</ul>

<h3 id="fortran">Fortran</h3>
<ul>
  <li>Asynchronous I/O is now fully supported. The program needs to
    be linked against the pthreads library to use it, otherwise the
    I/O is done synchronously.  For systems which do not support
    POSIX condition variables, such as AIX, all I/O is still
    done synchronously.
  </li>
  <li>The <code>BACK</code> argument for <code>MINLOC</code> and
    <code>MAXLOC</code> has been implemented.
  </li>
  <li>The <code>FINDLOC</code> intrinsic function has been
    implemented.
  </li>
  <li>The <code>IS_CONTIGUOUS</code> intrinsic function has been
    implemented.
  </li>
  <li>
    Direct access to the real and imaginary parts of a complex
    variable via <code>c&percnt;re</code>
    and <code>c&percnt;im</code> has been implemented.
  </li>
  <li>
    Type parameter inquiry via <code>str&percnt;len</code>
    and <code>a&percnt;kind</code> has been implemented.
  </li>
  <li>
    C descriptors and the <code>ISO_Fortran_binding.h</code>
    source file have been implemented.
  </li>
  <li>The <code>MAX</code> and <code>MIN</code> intrinsics are no
  longer guaranteed to return any particular value in case one of the
  arguments is a <code>NaN</code>.  Note that this conforms to the
  Fortran standard and to what other Fortran compilers do.  If there
  is a need to handle that case in some specific way, one needs to
  explicitly check for <code>NaN</code>'s before
  calling <code>MAX</code> or <code>MIN</code>, e.g. by using
  the <code>IEEE_IS_NAN</code> function from the intrinsic
  module <code>IEEE_ARITHMETIC</code>.
  </li>
  <li>
      A new command line option <a href="https://gcc.gnu.org/onlinedocs/gfortran/Fortran-Dialect-Options.html#index-fdec-include"><code>-fdec-include</code></a>, set also
    by <a href="https://gcc.gnu.org/onlinedocs/gfortran/Fortran-Dialect-Options.html#index-fdec"><code>-fdec</code></a> option, has been added for an extension
    for compatibility with legacy code.  With this option,
    <code>INCLUDE</code> directive is parsed also as a statement,
    which allows the directive to be written on multiple source lines
    with line continuations.
  </li>
  <li>
      A new <a href="https://gcc.gnu.org/onlinedocs/gfortran/BUILTIN-directive.html#BUILTIN-directive"><code>BUILTIN</code></a> directive, has been added.
    The purpose of the directive is to provide an API between the GCC compiler and
    the GNU C Library which would define vector implementations of math routines.
  </li>
</ul>

<!-- <h3 id="go">Go</h3> -->

<!-- .................................................................. -->
<!-- <h2 id="jit">libgccjit</h2> -->

<!-- .................................................................. -->
<h2 id="targets">New Targets and Target Specific Improvements</h2>

<h3 id="arm-targets">AArch64 &amp; Arm</h3>

<ul>
  <li>
    Support has been added for the following processors
    (GCC identifiers in parentheses):
    <ul>
	<li>Arm Cortex-A76 (<code>cortex-a76</code>).</li>
	<li>Arm Cortex-A55/Cortex-A76 DynamIQ big.LITTLE (<code>cortex-a76.cortex-a55</code>).</li>
	<li>Arm Neoverse N1 (<code>neoverse-n1</code>).</li>
    </ul>
    The GCC identifiers can be used
    as arguments to the <code>-mcpu</code> or <code>-mtune</code> options,
    for example: <code>-mcpu=cortex-a76</code> or
    <code>-mtune=cortex-a76.cortex-a55</code> or as arguments to the equivalent target
    attributes and pragmas.
  </li>
  <li>
    <p>The Armv8.3-A complex number instructions are now supported via intrinsics
    when the option <code>-march=armv8.3-a</code> or equivalent is specified.
    For the half-precision floating-point variants of these instructions use the
    architecture extension flag <code>+fp16</code>, e.g.
    <code>-march=armv8.3-a+fp16</code>.
    </p>
    <p>The intrinsics are defined by the ACLE specification.</p>
  </li>
</ul>

<h5 id="aarch64">AArch64 specific</h5>
<ul>
  <li>
    Support has been added for the Arm Neoverse E1 processor
    (<code>-mcpu=neoverse-e1</code>).
  </li>

  <li>
    The AArch64 port now has support for stack clash protection using the
    <a href="https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html#index-fstack-protector"><code>-fstack-clash-protection</code></a> option.  The probing interval/guard
    size can be set by using <code>--param stack-clash-protection-guard-size=12|16</code>.
    The value of this parameter must be in bytes represented as a power of two.
    The two supported values for this parameter are 12 (for a 4KiB size, 2^12)
    and 16 (for a 64KiB size, 2^16).

    The default value is 16 (64Kb) and can be changed at configure
    time using the flag <code>--with-stack-clash-protection-guard-size=12|16</code>.
  </li>
</ul>

<h5 id="arm">Arm specific</h5>
<ul>
  <li>
    Support for the deprecated Armv2 and Armv3 architectures and their
    variants has been removed.  Their corresponding <code>-march</code>
    values and the <code>-mcpu</code> options that used these architectures
    have been removed.
  </li>
  <li>
     Support for the Armv5 and Armv5E architectures
     (which have no known implementations) has been removed.
     Note that Armv5T, Armv5TE and Armv5TEJ architectures remain supported.
  </li>
  <li>
     Corrected FPU configurations for Cortex-R7 and Cortex-R8 when using their
     respective <code>-mcpu</code> options.
  </li>
</ul>

<h3 id="amdgcn">AMD GCN</h3>
<ul>
  <li>
    A new back end targeting AMD GCN GPUs has been contributed to GCC.  The
    implementation is currently limited to compiling single-threaded,
    stand-alone programs.  Future versions will add support for offloading
    multi-threaded kernels via OpenMP and OpenACC.  The following devices are
    supported (GCC identifiers in parentheses):
    <ul>
      <li>Fiji (<code>fiji</code>).</li>
      <li>Vega 10 (<code>gfx900</code>).</li>
    </ul>
  </li>
</ul>

<h3 id="arc">ARC</h3>
<ul>
  <li>LRA is now on by default for the ARC target.  This can be
  controlled by <code>-mlra</code>.</li>
  <li>Add support for frame code-density and branch-and-index
  instructions.</li>
</ul>

<!-- <h3 id="avr">AVR</h3> -->

<h3 id="csky">C-SKY</h3>
<ul>
  <li>
    A new back end targeting C-SKY V2 processors has been contributed to GCC.
  </li>
</ul>

<!-- <h3 id="hsa">Heterogeneous Systems Architecture</h3> -->

<h3 id="x86">IA-32/x86-64</h3>
<ul>
  <li>Support of Intel MPX (Memory Protection Extensions) has been removed.</li>
</ul>


<!-- <h3 id="mips">MIPS</h3> -->

<!-- <h3 id="mep">MeP</h3> -->

<!-- <h3 id="msp430">MSP430</h3> -->

<!-- <h3 id="nds32">NDS32</h3> -->

<!-- <h3 id="nios2">Nios II</h3> -->

<!-- <h3 id="nvptx">NVPTX</h3> -->

<!-- <h3 id="hppa">PA-RISC</h3> -->

<!-- <h3 id="powerpc">PowerPC / PowerPC64 / RS6000</h3> -->

<!-- <h3 id="s390">S/390, System z, IBM z Systems</h3> -->

<!-- <h3 id="riscv">RISC-V</h3> -->

<!-- <h3 id="rx">RX</h3> -->

<!-- <h3 id="sh">SH</h3> -->

<!-- <h3 id="sparc">SPARC</h3> -->

<!-- <h3 id="Tile">Tile</h3> -->

<!-- .................................................................. -->
<h2 id="os">Operating Systems</h2>

<!-- <h3 id="aix">AIX</h3> -->

<!-- <h3 id="fuchsia">Fuchsia</h3> -->

<!-- <h3 id="dragonfly">DragonFly BSD</h3> -->

<!-- <h3 id="freebsd">FreeBSD</h3> -->

<!-- <h3 id="gnulinux">GNU/Linux</h3> -->

<!-- <h3 id="rtems">RTEMS</h3> -->

<!-- <h3 id="solaris">Solaris</h3> -->

<!-- <h3 id="vxmils">VxWorks MILS</h3> -->

<h3 id="windows">Windows</h3>

<ul>
  <li>A C++ Microsoft ABI bitfield layout
  bug, <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=87137">PR87137</a>
  has been fixed.  A non-field declaration could cause the current
  bitfield allocation unit to be completed, incorrectly placing a
  following bitfield into a new allocation unit.  The Microsoft ABI is
  selected for:
  <ul>
    <li>Mingw targets
    <li>PowerPC, IA-32 or x86-64 targets
      when the <code>-mms-bitfields</code> option is specified,
      or <code>__attribute__((ms_struct))</code> is used
    <li>SuperH targets when the <code>-mhitachi</code> option is
      specified, or <code>__attribute__((renesas))</code> is used
  </ul>
</ul>

<!-- .................................................................. -->
<!-- <h2>Documentation improvements</h2> -->


<!-- .................................................................. -->
<!-- <h2 id="plugins">Improvements for plugin authors</h2> -->

<!-- .................................................................. -->
<!-- <h2>Other significant improvements</h2> -->


<!-- .................................................................. -->
<!-- <h2 id="9.1">GCC 9.1</h2> -->

</body>
</html>
