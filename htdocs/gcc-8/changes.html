<html>

<head>
<title>GCC 8 Release Series &mdash; Changes, New Features, and Fixes</title>
</head>

<!-- GCC maintainers, please do not hesitate to update/contribute entries
     concerning those part of GCC you maintain!  2002-03-23, Gerald.
-->

<body>
<h1>GCC 8 Release Series<br />Changes, New Features, and Fixes</h1>

<p>
This page is a "brief" summary of some of the huge number of improvements
in GCC 8.
You may also want to check out our
<a href="porting_to.html">Porting to GCC 8</a> page and the
<a href="../onlinedocs/index.html#current">full GCC documentation</a>.
</p>

<!-- .................................................................. -->
<h2>Disclaimer: GCC 8 has not been released yet, so this document is
a work-in-progress.</h2>


<!-- .................................................................. -->
<h2>Caveats</h2>
<ul>
  <li>Support for the obsolete SDB/coff debug info format has been
      <strong>removed</strong>.  The option <code>-gcoff</code> no longer
      does anything.</li>
  <li>The Cilk+ extensions to the C and C++ languages were removed from
      GCC.</li>
</ul>


<!-- .................................................................. -->
<h2 id="general">General Improvements</h2>
<ul>
  <li>The ipa-pure-const pass is extended to propagate malloc attribute, and the
  corresponding warning option <code>Wsuggest-attribute=malloc</code> emits a
  diagnostic for a function, which can be annotated with malloc attribute.</li>
</ul>


<!-- .................................................................. -->
<h2 id="languages">New Languages and Language specific improvements</h2>

<h3 id="ada">Ada</h3>
<ul>
  <li></li>
</ul>

<h3 id="brig">BRIG (HSAIL)</h3>

<p>In this release cycle, the focus for the BRIGFE was on stabilization and
  performance improvements. Also a couple of completely new features were
  added.</p>

<ul>
  <li>Improved support for function and module scope group
    segment variables. PRM specs define function and module scope group
    segment variables as an experimental feature. However, PRM test
    suite uses them. Now group segment is handled by separate book
    keeping of module scope and function (kernel) offsets. Each function
    has a "frame" in the group segment offset to which is given as an
    argument, similar to traditional call stack frame handling.</li>
  <li>Reduce the number of type conversions due to
    the untyped HSAIL regs. Instead of always representing the HSAIL's
    untyped registers as unsigned int, the gccbrig now pre-analyzes
    the BRIG code and builds the register variables as a type used
    the most when storing or reading data to/from each register.
    This reduces the number of total casts which cannot be always
    optimized away.</li>
  <li>Support for BRIG_KIND_NONE directives.</li>
  <li>Made -O3 the default optimization level for BRIGFE.</li>
  <li>Fixed illegal addresses generated from address expressions
    which refer only to offset 0.</li>
  <li>Fixed a bug with reg+offset addressing on 32b segments.
    In 'large' mode, the offset is treated as 32bits unless it's
    in global, readonly or kernarg address space.</li>
  <li>Fixed a crash caused sometimes by calls with more
    than 4 args.</li>
  <li>Fixed a misexecution issue with kernels that have
    both unexpanded ID functions and calls to subfunctions.</li>
  <li>Treat HSAIL barrier builtins as setjmp/longjump style
    functions to avoid illegal optimizations.</li>
  <li>Ensure per WI copies of private variables are aligned correctly.</li>
  <li>libhsail-rt: Assume the host runtime allocates the work group
    memory.</li>
</ul>


<h3 id="c-family">C family</h3>
<ul>
    <li>New command-line options have been added for the C and C++ compilers:
      <ul>
	<li><code>-Wmultistatement-macros</code> warns about unsafe macros
	expanding to multiple statements used as a body of a clause such
	as <code>if</code>, <code>else</code>, <code>while</code>,
	<code>switch</code>, or <code>for</code>.</li>
      </ul>
    </li>
    <li><code>-fno-strict-overflow</code> is now mapped to
     <code>-fwrapv</code> and signed integer overflow is now undefined by
     default at all optimization levels.  Using
     <code>-fsanitize=signed-integer-overflow</code> is now the preferred
     way to audit code, <code>-Wstrict-overflow</code> is deprecated.</li>
</ul>

<h3 id="cxx">C++</h3>
<ul>
  <li></li>
</ul>

<h3 id="fortran">Fortran</h3>
<ul>
  <li>
    The main version of libfortran has been changed to 5.
  </li>
  <li>
    Parameterized derived types, a major feature of Fortran 2003, have been
    implemented.
  </li>
  <li>
    The maximum rank for arrays has been increased to 15, conforming to the
    Fortran 2008 standard.
  </li>
  <li>
    Transformational intrinsics are now fully supported in initialization
    expressions.
  </li>
  <li>
    New flag <code>-fc-prototypes</code> to write C prototypes for
    <code>BIND(C)</code> procedures and variables.
  </li>
  <li>
    If <code>-fmax-stack-var-size</code> is honored if given together with
    <code>-Ofast</code>, <code>-fstack-arrays</code> is no longer set in that
    case.
  </li>
  <li>
    New options <code>-fdefault-real-16</code> and <code>-fdefault-real-10</code>
    to control the default kind of <code>REAL</code> variables.
  </li>
  <li>
    A warning is now issued if an array subscript inside a DO loop could lead
    to an out-of-bounds-access. The new option <code>-Wdo-subscript</code>,
    enabled by <code>-Wextra</code>, warns about this even if the compiler can
    not prove that the code will be executed.
  </li>
  <li>
    The Fortran front end now attempts to interchange loops if it is deemed
    profitable. So far, this is restricted to <code>FORALL</code> and <code>DO
    CONCURRENT</code> statements with multiple indices. This behavior be
    controlled with the new flag <code>-ffrontend-loop-interchange</code>,
    which is enabled with optimization by default.
    The <code>-Wfrontend-loop-interchange</code> option warns about such
    occurrences.
  </li>
  <li>
    When an actual argument contains too few elements for a dummy argument,
    an error is now issued. The <code>-std=legacy</code> option can be
    used to still compile such code.
  </li>
  <li>
    The <code>RECL=</code> argument to <code>OPEN</code>
    and <code>INQUIRE</code> statements now allows 64-bit
    integers, making records larger than 2GiB possible.
  </li>
  <li>
    The <code>GFORTRAN_DEFAULT_RECL</code> environment variable no
    longer has any effect. The record length for preconnected units is
    now larger than any practical limit, same as for sequential access
    units opened without an explicit <code>RECL=</code> specifier.
  </li>
  <li>
    Character variables longer than <code>HUGE(0)</code> elements are
    now possible on 64-bit targets.  Note that this changes the
    procedure call ABI for all procedures with character arguments on
    64-bit targets, as the type of the hidden character length
    argument has changed. The hidden character length argument is now
    of type <code>INTEGER(C_SIZE_T)</code>.
  </li>
</ul>

<h3 id="go">Go</h3>
<ul>
  <li></li>
</ul>


<!-- .................................................................. -->
<h2 id="jit">libgccjit</h2>


<!-- .................................................................. -->
<h2 id="targets">New Targets and Target Specific Improvements</h2>

<h3 id="aarch64">AArch64</h3>
<ul>
  <li>
    The Armv8.4-A architecture is now supported.  It can be used by
    specifying the <code>-march=armv8.4-a</code> option.
  </li>
  <li>
    The Dot Product instructions are now supported as an optional extension to the
    Armv8.2-A architecture and newer and are mandatory on Armv8.4-A.  The extension can be used by
    specifying the <code>+dotprod</code> architecture extension.  E.g. <code>-march=armv8.2-a+dotprod</code>.
  </li>
  <li>
    The Armv8-A <code>+crypto</code> extension has now been split into two extensions for finer grained control:
    <ul>
       <li><code>+aes</code> which contains the Armv8-A AES crytographic instructions.</li>
       <li><code>+sha2</code> which contains the Armv8-A SHA2 and SHA1 cryptographic instructions.</li>
    </ul>
    Using <code>+crypto</code> will now enable these two extensions.
  </li>
  <li>
    New Armv8.4-A FP16 Floating Point Multiplication Variant instructions have been added.  These instructions are
    mandatory in Armv8.4-A but available as an optional extension to Armv8.2-A and Armv8.3-A.  The new extension
    can be used by specifying the <code>+fp16fml</code> architectural extension on Armv8.2-A and Armv8.3-A. On Armv8.4-A
    the instructions can be enabled by specifying <code>+fp16</code>.
  </li>
  <li>
    New cryptographic instructions have been added as optional extensions to Armv8.2-A and newer.  These instructions can
    be enabled with:
    <ul>
      <li><code>+sha3</code> New SHA3 and SHA2 instructions from Armv8.4-A.  This implies <code>+sha2</code>.</li>
      <li><code>+sm4</code> New SM3 and SM4 instructions from Armv8.4-A.</li>
    </ul>
 </li>
  <li>
       Support has been added for the following processors
       (GCC identifiers in parentheses):
       <ul>
         <li>Arm Cortex-A75 (<code>cortex-a75</code>).</li>
	 <li>Arm Cortex-A55 (<code>cortex-a55</code>).</li>
	 <li>Arm Cortex-A55/Cortex-A75 DynamIQ big.LITTLE (<code>cortex-a75.cortex-a55</code>).</li>
       </ul>
       The GCC identifiers can be used
       as arguments to the <code>-mcpu</code> or <code>-mtune</code> options,
       for example: <code>-mcpu=cortex-a75</code> or
       <code>-mtune=cortex-a75</code> or as arguments to the equivalent target
       attributes and pragmas.
  </li>
</ul>

<h3 id="arm">ARM</h3>
<ul>
  <li>
    The <code>-mfpu</code> option now takes a new option setting of
    <code>-mfpu=auto</code>.  When set to this the floating-point and SIMD
    settings are derived from the settings of the <code>-mcpu</code>
    or <code>-march</code> options.  The internal CPU configurations have been
    updated with information about the permitted floating-point configurations
    supported.  See the user guide for further information about the extended
    option syntax for controlling architectural extensions via the
    <code>-march</code> option.  <code>-mfpu=auto</code> is now the default
    setting unless the compiler has been configured with an explicit
    <code>--with-fpu</code> option.
  </li>
  <li>
    The <code>-mstructure-size-boundary</code> option has been deprecated and will be
    removed in a future release.
  </li>
  <li>
    The default link behavior for Armv6 and Armv7-R targets has been
    changed to produce BE8 format when generating big-endian images.  A new
    flag <code>-mbe32</code> can be used to force the linker to produce
    legacy BE32 format images.  There is no change of behavior for
    Armv6-M and other Armv7 or later targets: these already defaulted
    to BE8 format.  This change brings GCC into alignment with other
    compilers for the ARM architecture.
  </li>
  <li>
    The Armv8-R architecture is now supported.  It can be used by specifying the
    <code>-march=armv8-r</code> option.
  </li>
  <li>
    The Armv8.3-A architecture is now supported.  It can be used by
    specifying the <code>-march=armv8.3-a</code> option.
  </li>
  <li>
    The Armv8.4-A architecture is now supported.  It can be used by
    specifying the <code>-march=armv8.4-a</code> option.
  </li>
  <li>
     The Dot Product instructions are now supported as an optional extension to the
     Armv8.2-A architecture and newer and are mandatory on Armv8.4-A.  The extension can be used by
     specifying the <code>+dotprod</code> architecture extension.  E.g. <code>-march=armv8.2-a+dotprod</code>.
  </li>

  <li>
    Support for setting extensions and architectures using the GCC target pragma and attribute has been added.
    It can be used by specifying <code>#pragma GCC target ("arch=...")</code>, <code>#pragma GCC target ("+extension")</code>,
    <code>__attribute__((target("arch=...")))</code> or <code>__attribute__((target("+extension")))</code>.
  </li>
  <li>
    New Armv8.4-A FP16 Floating Point Multiplication Variant instructions have been added.  These instructions are
    mandatory in Armv8.4-A but available as an optional extension to Armv8.2-A and Armv8.3-A.  The new extension
    can be used by specifying the <code>+fp16fml</code> architectural extension on Armv8.2-A and Armv8.3-A. On Armv8.4-A
    the instructions can be enabled by specifying <code>+fp16</code>.
  </li>
  <li>
       Support has been added for the following processors
       (GCC identifiers in parentheses):
       <ul>
	 <li>Arm Cortex-A75 (<code>cortex-a75</code>).</li>
	 <li>Arm Cortex-A55 (<code>cortex-a55</code>).</li>
	 <li>Arm Cortex-A55/Cortex-A75 DynamIQ big.LITTLE (<code>cortex-a75.cortex-a55</code>).</li>
	 <li>Arm Cortex-R52 for Armv8-R (<code>cortex-r52</code>).</li>
       </ul>
       The GCC identifiers can be used
       as arguments to the <code>-mcpu</code> or <code>-mtune</code> options,
       for example: <code>-mcpu=cortex-a75</code> or
       <code>-mtune=cortex-r52</code> or as arguments to the equivalent target
       attributes and pragmas.
  </li>
</ul>

<h3 id="avr">AVR</h3>
<ul>
  <li>
    The AVR port now supports the following XMEGA-like devices:
    <blockquote>
      ATtiny212, ATtiny214, ATtiny412, ATtiny414, ATtiny416, ATtiny417,
      ATtiny814, ATtiny816, ATtiny817, ATtiny1614, ATtiny1616, ATtiny1617,
      ATtiny3214, ATtiny3216, ATtiny3217
    </blockquote>
    The new devices are listed under 
    <a href="https://gcc.gnu.org/onlinedocs/gcc/AVR-Options.html"><code>-mmcu=avrxmega3</code></a>.
    <ul>
      <li>These devices see flash memory in the RAM address space, so that
	features like <code>PROGMEM</code> and <code>__flash</code>
	are not needed any more (as opposed to other AVR families for which
	read-only data will be located in RAM except special, non-standard
	features are used to locate and access such data). This requires
	that the compiler is used with Binutils&nbsp;2.29 or newer so that
	<a href="https://sourceware.org/PR21472">read-only data will be
	  located in flash memory</a>.</li>
      <li>A new command-line option <code>-mshort-calls</code> is supported.
	This option is used internally for multilib selection of the
	<code>avrxmega3</code> variants. It is
	<em>not an optimization option</em>. Do not set it by hand.</li>
    </ul>
  </li>
  <li>
    The compiler now generates
    <a href="https://gcc.gnu.org/PR20296"> efficient interrupt service routine
      (ISR) prologues and epilogues</a>.  This is achieved by using the new
    <a href="https://sourceware.org/binutils/docs-2.29/as/AVR-Pseudo-Instructions.html">
      AVR pseudo instruction</a> <code>__gcc_isr</code> which is supported
    and resolved by the GNU assembler.
    <ul>
      <li>As the <code>__gcc_isr</code> pseudo-instruction will be resolved by
	the assembler, inline assembly is transparent to the process.
	This means that when inline assembly uses an instruction like
	<code>INC</code> that clobbers the condition code,
	then the assembler will detect this and generate an appropriate
	ISR prologue / epilogue chunk to save / restore SREG as needed.</li>
      <li>A new command-line option <code>-mno-gas-isr-prologues</code>
	disables the generation of the <code>__gcc_isr</code> pseudo
	instruction. Any non-naked ISR will save and restore <code>SREG</code>,
	<code>tmp_reg</code> and <code>zero_reg</code>, no matter
	whether the respective register is clobbered or used.</li>
      <li>The feature is turned on per default for all optimization levels
	except for <code>-O0</code> and <code>-Og</code>. It is explicitly
	enabled by means of option <code>-mgas-isr-prologues</code>.</li>
      <li>Support has been added for a new
	<a href="https://gcc.gnu.org/onlinedocs/gcc/AVR-Function-Attributes.html">
	  AVR function attribute</a> <code>no_gccisr</code>. It can be used
	to disable <code>__gcc_isr</code> pseudo instruction generation
	for individual ISRs.</li>
      <li>This optimization is only available if GCC is configured with GNU
	Binutils&nbsp;2.29 or newer; or at least with a version of Binutils
	that implements feature
	<a href="https://sourceware.org/PR21683">PR21683</a>.</li>
    </ul>
  </li>
  <li>
    The compiler no more saves / restores registers in <code>main</code>;
    the effect is the same as if attribute <code>OS_task</code> was
    specified for <code>main</code>.  This optimization can be switched
    off by the new command-line option <code>-mno-main-is-OS_task</code>.
  </li>
</ul>

<!-- <h3 id="hsa">Heterogeneous Systems Architecture</h3> -->

<h3 id="x86">IA-32/x86-64</h3>
<ul>
  <li>
    The x86 port now supports the <code>naked</code> function attribute.</li>
  <li>GCC now supports the Intel CPU named Cannonlake through
    <code>-march=cannonlake</code>. The switch enables the AVX512VBMI,
    AVX512IFMA and SHA ISA extensions.</li>
  <li>GCC now supports the Intel CPU named and Icelake through
    <code>-march=icelake</code>. The switch enables the AVX512VNNI, GFNI, VAES,
    AVX512VBMI2, VPCLMULQDQ, AVX512BITALG, RDPID and AVX512VPOPCNTDQ ISA
    extensions.</li>
</ul>

<!-- <h3 id="mips">MIPS</h3> -->

<!-- <h3 id="mep">MeP</h3> -->

<!-- <h3 id="msp430">MSP430</h3> -->

<!-- <h3 id="nds32">NDS32</h3> -->
<h3 id="nds32">NDS32</h3>
<ul>
  <li>
    New command-line options <code>-mext-perf</code>, <code>-mext-perf2</code>, and
    <code>-mext-string</code> have been added for performance extension instructions.
  </li>
</ul>

<h3 id="nios2">Nios II</h3>
<ul>
  <li>
    The Nios II back end has been improved to generate better-optimized
    code.  Changes include switching to LRA, more accurate cost models,
    and more compact code for addressing static variables.
  </li>
  <li>
    New command-line options <code>-mgprel-sec=</code> and
    <code>-mr0rel-sec=</code> have been added.
  </li>
  <li>
    The stack-smashing protection options are now enabled on Nios II.
  </li>
</ul>

<!-- <h3 id="nvptx">NVPTX</h3> -->

<h3 id="hppa">PA-RISC</h3>
<ul>
  <li>
    The default call ABI on 32-bit linux has been changed from callee
    copies to caller copies.  This affects objects larger than eight
    bytes passed by value.  The goal is to improve compatibility with
    x86 and resolve issues with OpenMP.
  </li>
  <li>
    Other PA-RISC targets are unchanged.
  </li>
</ul>

<h3 id="powerpc">PowerPC / PowerPC64 / RS6000</h3>
<ul>
  <li>
    The PowerPC SPE support is split off to a separate <code>powerpcspe</code>
    port.  See the separate entry for that new port.
  </li>
  <li>
    The Paired Single support (as used on some PPC750 CPUs,
    <code>-mpaired</code>, <code>powerpc*-*-linux*paired*</code>)
    is deprecated and will be removed in a future release.
  </li>
  <li>
    The Xilinx floating point support (<code>-mxilinx-fpu</code>,
    <code>powerpc-xilinx-eabi*</code>)
    is deprecated and will be removed in a future release.
  </li>
  <li>
    Support for using big-endian AltiVec intrinsics on a little-endian target
    (<code>-maltivec=be</code>) is deprecated and will be removed in a
    future release.
  </li>
</ul>

<h3 id="powerpcspe">PowerPC SPE</h3>

<!-- <h3 id="s390">S/390, System z, IBM z Systems</h3> -->

<!-- <h3 id="riscv">RISC-V</h3> -->

<!-- <h3 id="rx">RX</h3> -->

<!-- <h3 id="sh">SH</h3> -->

<!-- <h3 id="sparc">SPARC</h3> -->


<!-- .................................................................. -->
<h2 id="os">Operating Systems</h2>

<!-- <h3 id="aix">AIX</h3> -->

<!-- <h3 id="fuchsia">Fuchsia</h3> -->

<!-- <h3 id="dragonfly">DragonFly BSD</h3> -->

<!-- <h3 id="freebsd">FreeBSD</h3> -->

<!-- <h3 id="gnulinux">GNU/Linux</h3> -->

<!-- <h3 id="rtems">RTEMS</h3> -->

<!-- <h3 id="solaris">Solaris</h3> -->

<!-- <h3 id="vxmils">VxWorks MILS</h3> -->

<h3 id="windows">Windows</h3>
   <ul>
     <li>GCC on Microsoft Windows can now be configured via
       <code>--enable-mingw-wildcard</code> or
       <code>--disable-mingw-wildcard</code> to force a specific behavior for
       GCC itself with regards to supporting the wildcard character.  Prior
       versions of GCC would follow the configuration of the MinGW runtime.
       This behavior can still be obtained by not using the above options or by
       using <code>--enable-mingw-wildcard=platform</code>.</li>
   </ul>


<!-- .................................................................. -->
<!-- <h2>Documentation improvements</h2> -->


<!-- .................................................................. -->
<h2>Other significant improvements</h2>
<ul>
  <li></li>
</ul>


<!-- .................................................................. -->
<!-- <h2><a name="8.2">GCC 8.2</a></h2>

<p>This is the <a href="https://gcc.gnu.org/bugzilla/buglist.cgi?bug_status=RESOLVED&amp;resolution=FIXED&amp;target_milestone=8.2">list
of problem reports (PRs)</a> from GCC's bug tracking system that are
known to be fixed in the 8.2 release. This list might not be
complete (that is, it is possible that some PRs that have been fixed
are not listed here).</p>
-->

</body>
</html>
